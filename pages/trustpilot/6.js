(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9769],{19769:function(e,t,r){"use strict";r.d(t,{P:function(){return ie}});var i=r(85893),s=r(67294),o=r(1411),a=r(62611),n=r(19233),l=r(40325),c=r(41799),d=r(90824),u=r(69348),m=r(80415),v=r(74937),w=r(48081),h=r(33613),p=r(83522),_=r(27761),x=r(16793);var b=e=>{let{reviewId:t,reviewText:r,highlightingEnabled:a}=e;const{fetch:n}=(0,v.i)(),{isLoggedIn:l}=(0,o.xO)(),b=(0,h.T)(),g=s.useContext(d.AppContext),[f,y]=s.useState(!1),[j,C]=s.useState(!1),[I,N]=s.useState(!1),[P,R]=s.useState({}),k=(0,w.H_)(b.id);return(0,i.jsx)(p.Z,{businessUnitId:b.id,businessUnitIdentifyingName:b.identifyingName,businessLinkUrl:k,reviewId:t,reviewText:r,highlightingEnabled:a,loading:j,disabled:I,isModalOpen:f,disabledReasonsReasons:P,hideViolationOptions:[_.i.Fabricated],onOpenHandler:async()=>{if(C(!0),!l)return void(0,w.rf)();g.track("Button Clicked",{name:"Start Product Review Report Flow"});const e=await(async(e,t)=>await(await e("/api/businessunitprofile/product-reviews/".concat(t,"/compliance-data"))).json())(n,t);if(!e.canNotify)return N(!0),C(!1);R(e.disabledReasonsReasons),y(!0),C(!1)},onCloseHandler:e=>{g.track("Modal Closed",(0,c.Z)({name:"Product Review Report Flow"},e)),y(!1)},onSubmit:async e=>{let r;switch(e.violation){case _.i.AdvertisingOrPromotional:r=e.advertisingOrPromotionalReason;break;case _.i.HarmfulOrIllegal:r=e.harmfulOrIllegalReason;break;case _.i.SensitiveInformation:default:r=_.i.SensitiveInformation}let i=!0;try{const s=(0,u.E)(r),o=await(async(e,t,r,i,s)=>{const o=await e("/api/businessunitprofile/product-reviews/".concat(t,"/compliance-data"),{method:"POST",body:JSON.stringify({reason:r,contentSelections:i,comment:s})});if(!o.ok)throw new x.o(o);return await o.json()})(n,t,s.reason,e.reviewTextSelections,s.comment);if(i=o.success,!i)throw new Error("Failed to post review report!")}finally{g.track("Notification Submission Attempted",{success:i,reason:(0,m.ns)(e),subreason:(0,m.Fe)(e)})}}})},g=r(48),f=r(57793),y=r(11163),j=r(65424),C=r(92596),I=r(11944),N=r.n(I);var P=r(92711),R=r.n(P);const k=e=>{let{reviewId:t}=e;const[r]=(0,g.T)(),{deleteProductReview:o,loading:a,success:n}=(e=>{const{fetch:t}=(0,v.i)(),[r]=(0,g.T)(),{0:i,1:o}=(0,s.useState)(!1),{0:a,1:n}=(0,s.useState)(!1),{0:l,1:c}=(0,s.useState)(!1),u=(0,s.useContext)(d.AppContext);return{deleteProductReview:(0,s.useCallback)((async()=>{if(confirm(r["product-review-card/delete-review/confirmation"])){o(!0);try{const r=await t("/api/businessunitprofile/product-reviews/".concat(e),{method:"DELETE"}),i=await r.json();n(i.success),u.track("Product Review Deleted",{reviewId:e})}catch(i){c(!0)}finally{o(!1)}}}),[r,t,e,u]),loading:i,error:l,success:a}})(t),{reload:l}=(0,y.useRouter)();return(0,s.useEffect)((()=>n&&l()),[n,l]),(0,i.jsxs)(j.Sn,{name:"delete-review-button",onClick:o,trackingProps:{name:"delete-review-button",action:"Delete Product review"},"aria-label":r["product-review-card/actions/delete-review/label"],isBusy:a,kind:"secondary",size:"small",className:R().actionButtons,children:[(0,i.jsx)(C.J,{content:N(),color:"currentColor",width:14,height:14}),(0,i.jsx)("span",{children:(0,i.jsx)(f.x,{id:"product-review-card/actions/delete-review/label"})})]})};var S=r(67358),B=r.n(S);const L=e=>{let{reviewId:t}=e;const[r]=(0,g.T)(),{getProductUrl:o,loading:a,editUrl:n}=(e=>{const{fetch:t}=(0,v.i)(),{0:r,1:i}=(0,s.useState)(!1),{0:o,1:a}=(0,s.useState)(""),{0:n,1:l}=(0,s.useState)(!1);return{getProductUrl:(0,s.useCallback)((async()=>{i(!0);try{const r=await t("/api/businessunitprofile/product-reviews/".concat(e,"/edit-url")),s=await r.json();a(s.editUrl)}catch(r){l(!0)}finally{i(!1)}}),[e,t]),loading:r,error:n,editUrl:o}})(t);return(0,s.useEffect)((()=>{n&&(window.location.href=n)}),[n]),(0,i.jsxs)(j.Sn,{onClick:o,title:r["product-review-card/actions/edit-review/label"],name:"edit-review",isBusy:a,className:R().actionButtons,trackingProps:{name:"edit-product-review",action:"Edit product review"},children:[(0,i.jsx)(C.J,{content:B(),color:"currentColor",width:14,height:14}),(0,i.jsx)("span",{children:(0,i.jsx)(f.x,{id:"product-review-card/actions/edit-review/label"})})]})};var T=r(33168),A=r.n(T);const O=e=>{let{reviewId:t,reviewText:r,consumerId:s}=e;const{isLoaded:a,isLoggedIn:n,consumer:l}=(0,o.xO)(),c=a&&n&&(null===l||void 0===l?void 0:l.id)===s;return(0,i.jsxs)("div",{className:A().cardFooter,children:[(0,i.jsx)("div",{children:c&&(0,i.jsxs)(i.Fragment,{children:[" ",(0,i.jsx)(L,{reviewId:t})," ",(0,i.jsx)(k,{reviewId:t})]})}),!c&&(0,i.jsx)(b,{reviewId:t,reviewText:r,highlightingEnabled:!0})]})};var Z=r(9538),D=r(82327),E=r(84779);const F=e=>{let{consumer:t}=e;return(0,i.jsxs)("div",{className:A().consumerInformation,children:[(0,i.jsx)(E.s,{id:t.id,displayName:t.displayName,imageUrl:t.imageUrl,isVerified:t.isVerified}),(0,i.jsxs)(Z.g,{href:"/users/".concat(t.id),className:A().rightSide,trackingProps:{name:"consumer-info",target:"Consumer profile"},rel:"nofollow",children:[(0,i.jsx)(D.Z,{variant:"bodysmall",color:"gray-7",weight:"medium",children:t.displayName}),(0,i.jsx)(D.Z,{variant:"bodysmall",color:"gray-6",children:t.countryCode.toUpperCase()})]})]})};var U=r(80074),H=r(56847),V=r.n(H);const J=e=>{let{source:t,isCreatedByCurrentConsumer:r}=e;const{id:s,displayName:o}=(0,h.T)(),a=((e,t,r,s)=>{const o=t?"private-view":"public-view";let a="";switch(e.toLowerCase()){case"consumer":a="reported-by-consumer";break;case"businessuser":a="46d6a890000064000500e0c3"===r?"tp-cpp/reported-by-trustpilot":"reported-by-business";break;default:a="reported-by-robots"}return(0,i.jsx)(f.x,{id:"product-review-card/report-banner/harmful-or-illegal/".concat(o,"/").concat(a),interpolations:{COMPANY:s,LINK:e=>(0,i.jsx)(U.rU,{color:"gray-6",weight:"medium",underline:!0,href:"https://support.trustpilot.com/hc/articles/207312237",target:"_blank",rel:"nofollow",children:e},"link")}})})(t,r,s,o);return(0,i.jsxs)("div",{className:A().reportBanner,children:[(0,i.jsx)(C.J,{name:"report",content:V()}),(0,i.jsx)(D.Z,{variant:"bodysmall",color:"gray-6",weight:"medium",children:a})]})};var M=r(59869),z=r(81674),Q=r(26805),W=r(27072),K=r(35425);const Y=e=>{let{rating:t,id:r}=e;const[s]=(0,g.T)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(D.Z,{variant:"bodysmall",color:"gray-7",children:s[r]}),(0,i.jsx)(M.Z,{rating:(0,K.f)(t),size:"small",variant:"review"})]})};var q=r(69136),G=r.n(q),X=r(9388);const $=(0,i.jsx)(D.Z,{variant:"bodysmall",color:"gray-7",children:(0,i.jsx)(f.x,{id:"product-review-card/review-labels/verified/tooltip",interpolations:{LINK:e=>(0,i.jsx)(U.rU,{href:"https://support.trustpilot.com/hc/articles/223402468?utm_campaign=verified_automatic&utm_content=verified_tooltipl&utm_medium=referral&utm_source=PPP",trackingProps:{name:"support-article-verified-automatic",target:"Support 223402468"},target:"_blank",children:e},"verified-automatic-link"),BOLD:e=>(0,i.jsx)("b",{style:{fontWeight:"bold"},children:e},"verified-automatic-bold")}})}),ee=(0,i.jsx)(f.x,{id:"service-review-card/review-labels/verified/label"}),te=()=>(0,i.jsx)("div",{className:A().reviewLabel,children:(0,i.jsx)(X.W,{button:(0,i.jsx)("button",{className:A().reviewLabelButton,children:(0,i.jsxs)(D.Z,{variant:"bodysmall",as:"div",className:A().detailsIcon,color:"gray-6",children:[(0,i.jsx)(C.J,{content:G(),color:"currentColor",width:14,height:14}),(0,i.jsx)("span",{children:ee})]})}),modalTitle:ee,trackingProps:{name:"Review Label Tooltip",tooltip:"Verified automatic",label:"Verified"},tooltipTriggers:["hover","focus"],children:$})}),re=e=>{let{productReview:t,reviewDates:r,isReviewContentHidden:s}=e;var o;const a=(0,z.hz)("consumer-site-show-product-attributes");return(0,i.jsxs)("div",{className:A().reviewInformation,children:[(0,i.jsxs)("div",{className:A().firstRow,children:[(0,i.jsx)(M.Z,{rating:t.rating,size:"medium",variant:"review"}),!s&&(0,i.jsx)(te,{})," ",(0,i.jsx)(D.Z,{variant:"bodysmall",color:"gray-6",as:"div",className:A().timeAgo,children:(0,i.jsx)(Q.i,(0,c.Z)({},r))})]}),(0,i.jsx)(D.Z,{variant:"body",color:"black",name:"review-text",className:(0,w.AK)(s&&A().hiddenContent),children:(0,i.jsx)(W.v,{withLineBreaks:!0,escapeHTML:!0,children:t.text})}),a&&!s&&(null===(o=t.attributes)||void 0===o?void 0:o.length)>0&&(0,i.jsx)("div",{className:A().attributesContainer,children:t.attributes.filter((e=>"number"===typeof e.rating)).map((e=>(0,i.jsx)("div",{className:A().attributeRow,children:(0,i.jsx)(Y,(0,c.Z)({},e))},e.id)))})]})},ie=e=>{let{productReview:t}=e;var r;const{isLoaded:s,isLoggedIn:c,consumer:d}=(0,o.xO)(),u=(0,l.c)(t.report),m=s&&c&&(null===d||void 0===d?void 0:d.id)===t.consumer.id,v=u&&!m,w={publishedDate:t.createdAt,reportedDate:v&&(null===(r=t.report)||void 0===r?void 0:r.createdAt)};return(0,i.jsxs)(i.Fragment,{children:[u&&(0,i.jsx)(J,{source:t.report.source,isCreatedByCurrentConsumer:m}),(0,i.jsxs)(a.Zb,{className:A().productReviewCard,name:"review",children:[(0,i.jsx)(F,{consumer:t.consumer}),(0,i.jsx)(n.i,{className:A().cardDivider}),(0,i.jsx)(re,{productReview:t,reviewDates:w,isReviewContentHidden:v}),!v&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.i,{className:A().cardDivider}),(0,i.jsx)(O,{reviewId:t.id,reviewText:t.text,consumerId:t.consumer.id})]})]})]})}},92711:function(e){e.exports={actionButtons:"buttons_actionButtons__z_q2D"}},33168:function(e){e.exports={productReviewCard:"styles_productReviewCard__rIIE2",cardDivider:"styles_cardDivider__NR89h",reportBanner:"styles_reportBanner__VDBZc",consumerInformation:"styles_consumerInformation__5TOPW",rightSide:"styles_rightSide__avtn_",reviewInformation:"styles_reviewInformation__OhtPR",firstRow:"styles_firstRow__1Ycxh",reviewLabel:"styles_reviewLabel__0uxBJ",detailsIcon:"styles_detailsIcon__Q20xE",reviewLabelButton:"styles_reviewLabelButton__iRIZH",timeAgo:"styles_timeAgo__f4QTj",hiddenContent:"styles_hiddenContent__W901_",attributesContainer:"styles_attributesContainer__BLFph",attributeRow:"styles_attributeRow__kYntn",cardFooter:"styles_cardFooter__T0Vx4",iconButton:"styles_iconButton__M1AcA",placeholderItem:"styles_placeholderItem__4uDNO",placeHolderShimmer:"styles_placeHolderShimmer__sjG33",consumerAvatarPlaceholder:"styles_consumerAvatarPlaceholder__PIfyh",consumerNamePlaceholder:"styles_consumerNamePlaceholder__bq54u",consumerCountryPlaceholder:"styles_consumerCountryPlaceholder__Q6R_A",datePlaceholder:"styles_datePlaceholder__uB2ws",textRowPlaceholder:"styles_textRowPlaceholder__0gMsm",reportButtonPlaceholder:"styles_reportButtonPlaceholder__9AwQS"}}}]);
//# sourceMappingURL=9769-7277a66169954e70.js.map