function doLiveSearch(e,d){return 38!=e.keyCode&&40!=e.keyCode&&($("#livesearch_search_results").remove(),updown=-1,!(""==d||d.length<3)&&(d=encodeURI(d),$.ajax({url:$("base").attr("href")+"index.php?route=product/search/ajax&keyword="+d,dataType:"json",success:function(e){var t=e.products,n=e.reviews,r=e.faqs,a=e.records,o=e.infos,i=e.comments;if(t.length>0||n.length>0||r.length>0||a.length>0||i.length>0||o.length>0){var c,h,l,p,u,m,s,f,C=document.createElement("ul");if(C.id="livesearch_search_results",C.className="list-unstyled",t.length>0)for(var v in c=document.createElement("li"),(l=document.createElement("span")).appendChild(document.createTextNode("Товары:")),c.appendChild(l),C.appendChild(c),t)c=document.createElement("li"),(h=document.createElement("a")).appendChild(document.createTextNode(t[v].name)),void 0!==t[v].href?h.href=t[v].href:h.href=$("base").attr("href")+"index.php?route=product/product&product_id="+t[v].product_id+"&keyword="+d,c.appendChild(h),C.appendChild(c);if(n.length>0)for(var v in c=document.createElement("li"),(p=document.createElement("span")).appendChild(document.createTextNode("Отзывы:")),c.appendChild(p),C.appendChild(c),n)c=document.createElement("li"),(h=document.createElement("a")).appendChild(document.createTextNode(n[v].name)),void 0!==n[v].href?h.href=n[v].href:h.href=$("base").attr("href")+"index.php?route=product/product&product_id="+n[v].product_id+"&keyword="+d,c.appendChild(h),C.appendChild(c);if(a.length>0||o.length>0){var g;if(c=document.createElement("li"),(g=document.createElement("span")).appendChild(document.createTextNode("Статьи:")),c.appendChild(g),C.appendChild(c),a.length>0)for(var v in a)c=document.createElement("li"),(h=document.createElement("a")).appendChild(document.createTextNode(a[v].name)),void 0!==a[v].href?h.href=a[v].href:h.href=$("base").attr("href")+"index.php?route=record/blog&record_id="+a[v].record_id,c.appendChild(h),C.appendChild(c);if(o.length>0)for(var v in o)c=document.createElement("li"),(h=document.createElement("a")).appendChild(document.createTextNode(o[v].name)),void 0!==o[v].href?h.href=o[v].href:h.href=$("base").attr("href")+"index.php?route=information/information&information_id="+o[v].information_id,c.appendChild(h),C.appendChild(c)}if(i.length>0)for(var v in c=document.createElement("li"),(u=document.createElement("span")).appendChild(document.createTextNode("Комментарии:")),c.appendChild(u),C.appendChild(c),i)c=document.createElement("li"),(h=document.createElement("a")).appendChild(document.createTextNode(i[v].name)),void 0!==i[v].href?h.href=i[v].href:h.href=$("base").attr("href")+"index.php?route=record/blog&record_id="+i[v].record_id,c.appendChild(h),C.appendChild(c);if(r.length>0)for(var v in c=document.createElement("li"),(m=document.createElement("span")).appendChild(document.createTextNode("Часто задаваемые вопросы:")),c.appendChild(m),C.appendChild(c),r)c=document.createElement("li"),(h=document.createElement("a")).appendChild(document.createTextNode(r[v].name)),void 0!==r[v].href?h.href=r[v].href:h.href=$("base").attr("href")+"index.php?route=faq/faq&faqcategory_id="+r[v].faqcategory_id,c.appendChild(h),C.appendChild(c);(c=document.createElement("li")).className="list-unstyled text-center",c.style.padding="0",(s=document.createElement("a")).className="close_results",(f=document.createElement("i")).className="fa fa-sort-up",s.appendChild(f),c.appendChild(s),C.appendChild(c),$("#livesearch_search_results").length>0&&$("#livesearch_search_results").remove(),$("#search input").after(C)}}}),!0))}function upDownEvent(e){var d=document.getElementById("livesearch_search_results");$("#search").find("[name=search]").first();if(d){var t=d.childNodes.length-2;if(-1!=updown&&void 0!==d.childNodes[updown]&&$(d.childNodes[updown]).removeClass("highlighted"),38==e.keyCode?updown=updown>0?--updown:updown:40==e.keyCode&&(updown=updown<t?++updown:updown),updown>=0&&updown<=t){$(d.childNodes[updown]).addClass("highlighted");var n=d.childNodes[updown].childNodes[0].text;void 0===n&&(n=d.childNodes[updown].childNodes[0].innerText),$("#search").find("[name=search]").first().val(new String(n).replace(/(\s\(.*?\))$/,""))}}return!1}var updown=-1;$(document).ready(function(){$("#search").find("[name=search]").first().keyup(function(e){doLiveSearch(e,this.value)}).focus(function(e){doLiveSearch(e,this.value)}).keydown(function(e){upDownEvent(e)}).blur(function(){window.setTimeout("$('#livesearch_search_results').remove();updown=0;",500)}),$(document).bind("keydown",function(e){try{13==e.keyCode&&$(".highlighted").length>0&&(document.location.href=$(".highlighted").find("a").first().attr("href"))}catch(e){}})});