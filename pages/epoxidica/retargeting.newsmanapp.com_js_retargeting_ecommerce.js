var _nzm_ecommerce=[];_nzm_ecommerce={payload:{ecommerce:{}},products:[],promotions:[],run:function(e,o,i,c,t,a,r){switch(e){case"ec:addProduct":_nzm_ecommerce._addProduct(o,i);break;case"ec:setAction":_nzm_ecommerce._setAction(o,i);break;case"ec:addImpression":_nzm_ecommerce._addImpression(o);break;case"ec:addPromo":_nzm_ecommerce._addPromo(o);break;case"send":_nzm_ecommerce._send(o,i,c,t,a,r);break;case"datalayer_load_send":this.payload.ecommerce=o,"detail"in this.payload.ecommerce||"impressions"in this.payload.ecommerce||"promoView"in this.payload.ecommerce||"checkout"in this.payload.ecommerce||"purchase"in this.payload.ecommerce?_nzm_ecommerce._send("pageview"):"checkout_option"in this.payload.ecommerce?_nzm_ecommerce._send("event","Checkout","Option"):_nzm_ecommerce._send("event","UX","click");break;case"set":_nzm_ecommerce._set(o,i);break;default:console.log("Unknown _nzm_ecommerce command")}},_addImpression:function(e){"impressions"in this.payload.ecommerce||(this.payload.ecommerce.impressions=[]),this.payload.ecommerce.impressions.push(e)},_addPromo:function(e){this.promotions.push(e)},_addProduct:function(e){this.products.push(e)},_set:function(e,o){this.payload.ecommerce[e]=o},_clearData:function(){this.payload={ecommerce:{}},this.products=[],this.promotions=[]},_setAction:function(e,o){-1!==["detail","click","add","remove","set_cart","clear_cart","set_qty","checkout","checkout_option","purchase","refund","promo_click"].indexOf(e)&&("detail"==e?(this.products.length>0&&("detail"in this.payload.ecommerce||(this.payload.ecommerce.detail={}),this.payload.ecommerce.detail.products=this.products),this.promotions.length>0&&("promoView"in this.payload.ecommerce||(this.payload.ecommerce.promoView={}),this.payload.ecommerce.promoView.promotions=this.promotions)):"add"==e?("add"in this.payload.ecommerce||(this.payload.ecommerce.add={}),this.payload.ecommerce.add.products=this.products):"remove"==e?("remove"in this.payload.ecommerce||(this.payload.ecommerce.remove={}),this.payload.ecommerce.remove.products=this.products):"set_cart"==e?("set_cart"in this.payload.ecommerce||(this.payload.ecommerce.set_cart={}),this.payload.ecommerce.set_cart.products=this.products):"clear_cart"==e?"clear_cart"in this.payload.ecommerce||(this.payload.ecommerce.clear_cart={}):"set_qty"==e?("set_qty"in this.payload.ecommerce||(this.payload.ecommerce.set_qty={}),this.payload.ecommerce.set_qty.products=this.products):"click"==e?("click"in this.payload.ecommerce||(this.payload.ecommerce.click={}),this.payload.ecommerce.click.products=this.products,null!=o&&(this.payload.ecommerce.click.actionField=o)):"promo_click"==e?("promoClick"in this.payload.ecommerce||(this.payload.ecommerce.promoClick={}),this.payload.ecommerce.promoClick.promotions=this.promotions):"checkout"==e?("checkout"in this.payload.ecommerce||(this.payload.ecommerce.checkout={}),this.payload.ecommerce.checkout.products=this.products,this.promotions.length>0&&("promoView"in this.payload.ecommerce||(this.payload.ecommerce.promoView={}),this.payload.ecommerce.promoView.promotions=this.promotions),null!=o&&(this.payload.ecommerce.checkout.actionField=o)):"checkout_option"==e?("checkout_option"in this.payload.ecommerce||(this.payload.ecommerce.checkout_option={}),null!=o&&(this.payload.ecommerce.checkout_option.actionField=o)):"purchase"==e&&("purchase"in this.payload.ecommerce||(this.payload.ecommerce.purchase={}),this.payload.ecommerce.purchase.products=this.products,null!=o&&(this.payload.ecommerce.purchase.actionField=o)))},_translateParams:function(){var e={};if("impressions"in this.payload.ecommerce&&this.payload.ecommerce.impressions.length>0){for(var o=[],i=0;i<this.payload.ecommerce.impressions.length;i++){var c=Object.assign({},this.payload.ecommerce.impressions[i]);c.list||(c.list="nolist");var t=o.indexOf(c.list);-1===t&&(o.push(c.list),t=o.indexOf(c.list));var a="il"+(t+1);if("nolist"!=c.list&&(e[a+"nm"]=c.list.toString()),prop_id=i+1-t,!("id"in c)&&!("name"in c))return void console.log("Product Impression 1 ID. Either ID or name must be set.");e[a+"pi"+prop_id+"id"]=c.id.toString(),e[a+"pi"+prop_id+"nm"]=c.name.toString(),"category"in c&&(e[a+"pi"+prop_id+"ca"]=c.category.toString()),"brand"in c&&(e[a+"pi"+prop_id+"br"]=c.brand.toString()),"variant"in c&&(e[a+"pi"+prop_id+"va"]=c.variant.toString()),"position"in c&&(e[a+"pi"+prop_id+"ps"]=c.position.toString()),"price"in c&&(e[a+"pi"+prop_id+"pr"]=c.price.toString());for(const o in c){const i=/(dimension|metric)(\d+)/i.exec(o);null!=i&&("dimension"==i[1]?e[a+"pi"+prop_id+"cd"+i[2]]=c[o].toString():"metric"==i[1]&&(e[a+"pi"+prop_id+"cm"+i[2]]=c[o].toString()))}}e.il_products_count=this.payload.ecommerce.impressions.length}var r=["detail","add","remove","set_cart","clear_cart","set_qty","click","promoClick","promoView","checkout","checkout_option","purchase"];for(var n in r){var m=r[n];if(m in this.payload.ecommerce){if(e.pa=m,"actionField"in this.payload.ecommerce[m]&&("step"in this.payload.ecommerce[m].actionField&&null!=this.payload.ecommerce[m].actionField.step&&(e.cos=this.payload.ecommerce[m].actionField.step.toString()),"option"in this.payload.ecommerce[m].actionField&&null!=this.payload.ecommerce[m].actionField.option&&(e.col=this.payload.ecommerce[m].actionField.option.toString()),"id"in this.payload.ecommerce[m].actionField&&null!=this.payload.ecommerce[m].actionField.id&&(e.ti=this.payload.ecommerce[m].actionField.id.toString()),"affiliation"in this.payload.ecommerce[m].actionField&&null!=this.payload.ecommerce[m].actionField.affiliation&&(e.ta=this.payload.ecommerce[m].actionField.affiliation.toString()),"revenue"in this.payload.ecommerce[m].actionField&&null!=this.payload.ecommerce[m].actionField.revenue&&(e.tr=Number.parseFloat(this.payload.ecommerce[m].actionField.revenue).toFixed(2)),"shipping"in this.payload.ecommerce[m].actionField&&null!=this.payload.ecommerce[m].actionField.shipping&&(e.ts=Number.parseFloat(this.payload.ecommerce[m].actionField.shipping).toFixed(2)),"tax"in this.payload.ecommerce[m].actionField&&null!=this.payload.ecommerce[m].actionField.tax&&(e.tt=Number.parseFloat(this.payload.ecommerce[m].actionField.tax).toFixed(2)),"coupon"in this.payload.ecommerce[m].actionField&&null!=this.payload.ecommerce[m].actionField.coupon&&(e.tcc=this.payload.ecommerce[m].actionField.coupon.toString())),"products"in this.payload.ecommerce[m]&&this.payload.ecommerce[m].products.length>0)for(i=0;i<this.payload.ecommerce[m].products.length;i++){a="pr"+(i+1);var s=Object.assign({},this.payload.ecommerce[m].products[i]);"id"in s&&s.id&&(e[a+"id"]=s.id.toString()),"name"in s&&s.name&&(e[a+"nm"]=s.name.toString()),"brand"in s&&s.brand&&(e[a+"br"]=s.brand.toString()),"category"in s&&s.category&&(e[a+"ca"]=s.category.toString()),"variant"in s&&s.variant&&(e[a+"va"]=s.variant.toString()),"price"in s&&s.price&&(e[a+"pr"]=s.price.toString()),"quantity"in s&&s.quantity>=0&&(e[a+"qt"]=s.quantity.toString()),"coupon"in s&&s.coupon&&(e[a+"tcc"]=s.coupon.toString()),"position"in s&&s.position&&(e[a+"ps"]=s.position.toString());for(const o in s){const i=/(dimension|metric)(\d+)/i.exec(o);null!=i&&("dimension"==i[1]?e[a+"cd"+i[2]]=s[o].toString():"metric"==i[1]&&(e[a+"cm"+i[2]]=s[o].toString()))}}if("promotions"in this.payload.ecommerce[m]&&this.payload.ecommerce[m].promotions.length>0)for(i=0;i<this.payload.ecommerce[m].promotions.length;i++){a="promo"+(i+1);var p=Object.assign({},this.payload.ecommerce[m].promotions[i]);"id"in p&&p.id&&(e[a+"id"]=p.id.toString()),"name"in p&&p.name&&(e[a+"nm"]=p.name.toString()),"creative"in p&&p.creative&&(e[a+"cr"]=p.creative.toString()),"position"in p&&p.position&&(e[a+"ps"]=p.position.toString()),"promoClick"==m&&(e.promoa="click")}"currencyCode"in this.payload.ecommerce&&(e.cu=this.payload.ecommerce.currencyCode)}}return e},_send:function(e,o,i,c,t,a){var r=this._translateParams(),n={dt:document.title};switch(e){case"pageview":n.t="pageview",n.dp=null!=o?o:window.location.pathname,n.dl=document.location.origin+document.location.pathname+document.location.search,n.dh=window.location.hostname;break;case"event":n.t="event",n.ec=null!=o?o:"Ecommerce",n.ea=null!=i?i:"Action",null!=c&&""!=c&&(n.el=c),null!=t&&(n.ev=parseInt(t));break;case"transaction":case"item":case"social":case"exception":case"timing":break;default:console.log("Unknown send hitType")}n=Object.assign(n,r),_nzm.track("_ecommerce",n,a),this._clearData()}};