!function(){var e=0,n=[],o=!1,r=window.evidon_dg.productIds.Observe,t=window.evidon_dg.companyId,i=window.evidon_dg.siteId,a=window.evidon_dg.getConfigValue("observe");if(a){a.percent&&a.pageScans&&a.initialDelay&&a.scanInterval||window.evidon_dg.logToConsoleF(r,"Configuration Corrupt. Missing Values.",!0,!0),window.evidon_dg.logToConsoleO(r,"Config: ",a);var l=a.percent,c=a.pageScans,d=a.initialDelay,s=a.scanInterval,u=a.noSite;if(!i){if(!u)return void window.evidon_dg.logToConsoleF(r,"Site Not Configured (No SiteId) - Observe Disabled");window.evidon_dg.logToConsoleF(r,"Site Not Configured (No SiteId) - Observe Override Enabled")}if(l<0||l>100)window.evidon_dg.logToConsoleF(r,'Configuration Contains Invalid Value For "collectionPercent" ('+l+").",!0,!0);else{var v=Math.floor(100*Math.random())+1;if(v<=l){window.evidon_dg.logToConsoleF(r,"Random ("+v+") Within Bounds of CollectionPercent ("+l+") - Observe Enabled");var g=window.setInterval(function u(){e++;window.clearInterval(g);e<c&&(g=window.setInterval(u,1e3*s));var v=[];!function e(o,r){if(void 0===performance)return;var t=o.document;if(null==t)return;var i=Array.from(o.performance.getEntriesByType("resource"));i=i.filter(function(e){return!e.name.includes(window.location.hostname)&&e.name.includes("//")});for(var a=0;a<i.length;a++){var l=i[a],c={scanType:"performance",src:l.name,latency:l.duration,resourceSizeBytes:l.transferSize};w(n,r,c,function(e){return e.src===c.src}),w(n,n,c,function(e){return e.src===c.src})}var d=Array.from(t.getElementsByTagName("iframe"));if(d.length>0)for(var s=0;s<d.length;s++){var u=null,v=null;try{u=d[s].contentWindow,v=d[s].contentWindow.document}catch(e){}null!=v&&e(u,r)}}(window,v);!function e(o,r){var t=o.document;if(null==t||null==t.querySelectorAll("[src]"))return;var i=Array.from(t.querySelectorAll("[src]")).filter(function(e){return!!e.src&&(!e.src.includes(window.location.hostname)&&e.src.includes("//"))});for(var a=0;a<i.length;a++){var l=i[a],c={scanType:"crawl",src:l.src,latency:null,resourceSizeBytes:null};w(n,r,c,function(e){return e.src===c.src}),w(n,n,c,function(e){return e.src===c.src})}var d=Array.from(t.getElementsByTagName("iframe"));if(d.length>0)for(var s=0;s<d.length;s++){var u=null,v=null;try{u=d[s].contentWindow,v=d[s].contentWindow.document}catch(e){}null!=v&&e(u,r)}}(window,v);var p=a.recollect?n:v;if(0==p.length)return void window.evidon_dg.logToConsoleF(r,"[Scan "+e+"] Collecting: No New Resources Found");p=function(e){var n=e.slice();if(arguments.length<2)return n.sort();var o=Array.prototype.slice.call(arguments);return n.sort(function(e,n){for(var r=o.slice(),t=r.shift();e[t]==n[t]&&r.length;)t=r.shift();return e[t]==n[t]?0:e[t]>n[t]?1:-1})}(p,"src");var y=window.evidon_dg.getUcpNoticeId();var m=document.documentURI;var C=function(){var e=window.performance.timing;if(!o&&e.loadEventEnd>0){var n=e.loadEventEnd-e.navigationStart;return o=!0,n}return 0}();var S=[];p.forEach(function(n){S.push({companyId:t,siteId:i,ucpNoticeId:y,pageLoadId:window.evidon_dg.pageLoadId,resourceUri:n.src,pageUri:m,resourceLatencyMs:n.latency>0?n.latency:null,resourceSizeBytes:n.resourceSizeBytes>0?n.resourceSizeBytes:null,pageLatencyMs:C>0?C:null,disposition:"observe",initialDelaySeconds:d,scanIntervalSeconds:s,collectionPercent:l,pageScans:c,throwIndex:e})});var h={"csp-report":{resources:S}};var I=JSON.stringify(h["csp-report"]);var _=new XMLHttpRequest;_.open("POST",window.evidon_dg.collector,!0);_.setRequestHeader("content-type","application/json");_.addEventListener("error",f);_.send(I);window.evidon_dg.logToConsoleO(r,"[Scan "+e+"] Collecting: ",p)},1e3*d)}else window.evidon_dg.logToConsoleF(r,"Random ("+v+") Outside Bounds of CollectionPercent ("+l+") - Observe Disabled")}}else window.evidon_dg.logToConsoleF(r,"Configuration (observe) Not Found For Company ("+t+") OR Site ("+i+")",!0,!0);function f(){window.evidon_dg.logToConsoleF(r,"Error sending observed data",!0)}function w(e,n,o,r){(function(e,n){for(var o=0;o<e.length;o++)if(n(e[o]))return!0;return!1})(e,r)||n.push(o)}}();