define(function(){"use strict";IEA.service("LazyLoad",function(e,t,n){function o(){return this}return _.extend(o.prototype,{initialize:function(e){return this},isElementInViewport:function(e){e=(e.jquery?e[0]:e).getBoundingClientRect();return(0<=e.top&&e.top<=(window.innerHeight||document.documentElement.clientHeight)||e.top<0&&0<=e.bottom)&&0<=e.left&&parseInt(e.right)<=parseInt(window.innerWidth||document.documentElement.clientWidth)},preLoader:function(e,t,n){if(n=n?n.toLowerCase():"append","object"!=typeof e)return!1;t&&!$(e).find("span.o-preloader").length?$(e)[n]('<span class="o-preloader lazy-preloader"></span>'):$(e).find("span.o-preloader").remove()},lazyLoadFeature:function(e,t){var n,o;e&&$(e).length&&(n=this,"function"==typeof t&&(o=_.throttle(function(){n.isElementInViewport(e)&&(t(),document.removeEventListener("scroll",o))},100),n.isElementInViewport(e)?t():document.addEventListener("scroll",o)))},bgImageLoad:function(e){var t;(t=e&&document.querySelectorAll(e+" [data-bg-id]")?Array.prototype.slice.call(document.querySelectorAll(e+" [data-bg-id]")):t)&&t.forEach(function(e){e.classList.add(e.dataset.bgId)})},promoInView:function(e,t){var n,o,i=this,r=t.find(".promotion-box-item[data-inview=false]");r&&$(r).length&&(n=_.throttle($.proxy(function(){var e=t.find(".promotion-box-item[data-inview=false]");$(e).each(function(e,t){"false"===t.dataset.inview&&i.isElementInViewport($(t))&&($(t).attr("data-inview","true"),o.push(t),i._promoTracking(t))})},t),1e3),o=[],$(r).each(function(e,t){i.isElementInViewport(t)&&($(t).attr("data-inview","true"),o.push(t),i._promoTracking(t))}),e&&"boolean"==typeof e&&addEventListener("scroll",n))},_promoTracking:function(e){$(document).trigger("onPromoView",[{ref:e}])}}),o})});