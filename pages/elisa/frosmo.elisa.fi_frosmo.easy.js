"5787cd0fd9a715e23bf74302de5e1ecec0db498f";
(function(){function ba(f,g,d){function e(){b?a.log.error(c,a.ERROR_TYPE_DEPRECATED+".removed"):a.console.error(c)}var b=4===arguments.length;if(b||"dev"===a.ENV){ba.constants[f]=d;var c='"'+f+'" deprecated, use "'+g+'" instead',h=f.split("."),r=h.slice(0,-1).join("."),h=h.slice(-1);(r=a.utils.getByDotString(r,x))&&J.defineProperty(r,h,{get:function(){e();return ba.constants[f]},set:function(a){e();ba.constants[f]=a},enumerable:!0,configurable:!0})}}var ia="frosmo",ja="_frosmo",ka="";try{if(ka=window.document.currentScript.getAttribute("data-namespace")||
"")ia+=ka,ja+=ka}catch(f){}var x=window[ia]=window[ia]||{},W=window[ja]=window[ja]||{},a=x.easy=x.easy||{};a.config=a.config||{};a.scriptNamespace=ka;if(!0===a.namespaceLoaded)a.console&&a.console.error("frosmo.easy.js is already loaded. Initialization could be corrupted");else{var ha=window.Array,D=window.Boolean,ua=window.clearInterval,X=window.clearTimeout,T=window.console,E=window.Date,da=window.decodeURIComponent,A=window.document,O=window.encodeURIComponent,y=window.Error,la=window.escape,va=
window.Event,ma=window.Function,wa=window.getComputedStyle,U=window.history,xa=window.Image,ya=window.isFinite,za=window.isNaN,qa=window.JSON,R=window.location,H=window.Math,ra=window.MutationObserver,P=window.navigator,V=window.Node,M=window.Number,J=window.Object,L=window.parseFloat,I=window.parseInt,Q=window.RegExp,Aa=window.setInterval,Ba=window.setTimeout,B=window.String,ea=window.TypeError,Y=window.unescape,Ca=window.WebKitMutationObserver,Da=window.XMLHttpRequest,na;try{na=window.localStorage}catch(f){}x.MutationObserver=
ra;x.WebKitMutationObserver=Ca;a.overrideBrowser=function(f,g){if(void 0===g){var d=a.domElements.selector("#frosmo-internal-frame")[0];d||(d=A.createElement("iframe"),d.width=0,d.height=0,d.tabIndex=-1,d.id="frosmo-internal-frame",d.style.display="none",(A.body?A.body:A.head).appendChild(d));g=d.contentWindow[f];if(!g)return}switch(f){case "Array":ha=g;break;case "Boolean":D=g;break;case "clearInterval":ua=g;break;case "clearTimeout":X=g;break;case "console":T=g;break;case "Date":E=g;break;case "decodeURIComponent":da=
g;break;case "document":A=g;break;case "encodeURIComponent":O=g;break;case "Error":y=g;break;case "escape":la=g;break;case "Event":va=g;break;case "Function":ma=g;break;case "getComputedStyle":wa=g;break;case "history":U=g;break;case "Image":xa=g;break;case "isFinite":ya=g;break;case "isNaN":za=g;break;case "JSON":qa=g;break;case "localStorage":na=g;break;case "location":R=g;break;case "Math":H=g;break;case "MutationObserver":ra=g;x.MutationObserver=g;break;case "navigator":P=g;break;case "Node":V=
g;break;case "Number":M=g;break;case "Object":J=g;break;case "parseFloat":L=g;break;case "parseInt":I=g;break;case "RegExp":Q=g;break;case "setInterval":Aa=g;break;case "setTimeout":Ba=g;break;case "String":B=g;break;case "TypeError":ea=g;break;case "unescape":Y=g;break;case "WebKitMutationObserver":Ca=g;x.WebKitMutationObserver=g;break;case "XMLHttpRequest":Da=g}};a.deprecate=function(f,g,d,e){var b=5===arguments.length;return function(){var c='"'+f+'" deprecated, use "'+g+'" instead';b?a.log.error(c,
a.ERROR_TYPE_DEPRECATED+".removed"):a.console.error(c);return d.apply(e,arguments)}};(function(){a.VERSION="8.120.0";a.MINIMUM_RULES_VERSION="3.6";a.getVersion=function(){return a.VERSION+"-"+(a.VERSION_RULES?a.VERSION_RULES:"1.0")};a.versionAtLeast=function(f,g){if(!f||!g)return!1;for(var d=a.utils.map(B(f).split("."),M),e=a.utils.map(B(g).split("."),M);3>d.length;)d.push(0);for(;3>e.length;)e.push(0);for(var b=!0,c=0;3>c&&!(e[c]>d[c]);c++)if(e[c]<d[c]){b=!1;break}b||a.console.error("[version]",
"Minimum version mismatch, for "+g+", expected "+f);return b}})();a.ERROR_SITE_JQUERY_MISSING=20017;a.ERROR_SITE_LOCALE=20008;a.ERROR_SITE_UNKNOWN=20009;a.ERROR_SITE_USER=20010;a.ERROR_SITE_CONVERSION=20021;a.ERROR_SITE_CONVERSION_TRANS_ID_MISSING=20013;a.ERROR_SITE_CONVERSION_ID=20014;a.ERROR_SITE_CONVERSION_VALUE=20015;a.ERROR_SITE_CONVERSION_QUANTITY=20025;a.ERROR_SITE_CUSTOMACTION=20024;a.ERROR_SITE_CUSTOMACTION_VALUE=20018;a.ERROR_SITE_INIT=20019;a.ERROR_SITE_CUSTOM_API=20020;a.ERROR_SITE_PRODUCT_ID=
20026;a.ERROR_SITE_PRODUCT_ATTRIBUTE=20027;a.ERROR_SITE_TRANSACTION=20029;a.EVENT_SEGMENT_ENTER="segment.enter";a.EVENT_SEGMENT_LEAVE="segment.leave";a.EVENT_SEGMENTS_READY="segments.ready";a.EVENT_CUSTOMACTION="customAction";a.EVENT_INIT_START="init.start";a.EVENT_INIT_SUCCESS="init.success";a.EVENT_INIT_FAILURE="init.failure";a.EVENT_INIT_UID="init.uid";a.EVENT_UID_CREATED="uid.created";a.EVENT_INIT_CONTEXT="init.context";a.EVENT_INIT_QUICK_CONTEXT="init.quick_context";a.EVENT_LOGIN="login";a.EVENT_LOGOUT=
"logout";a.EVENT_EASY_CONFIG="easy.config";a.EVENT_SCRIPT_LOAD="scriptLoad";a.EVENT_VISIT="visit";a.EVENT_LOCATION="location";a.EVENT_LOCATION_FAILURE="location.failure";a.EVENT_XDM_REQUEST="xdm.request";a.EVENT_XDM_READY="xdm.ready";a.EVENT_XDM_FAILURE="xdm.failure";a.EVENT_CONVERSION="conversion";a.EVENT_PRODUCT_DATA="product";a.EVENT_PRODUCT_PURCHASE="product.purchase";a.EVENT_DATALAYER="dataLayer";a.EVENT_MESSAGE_INIT="message.initSuccess";a.EVENT_MESSAGE_REQUEST="message.request";a.EVENT_MESSAGE_RECEIVE=
"message.receive";a.EVENT_MESSAGE_SUCCESS="message.success";a.EVENT_MESSAGE_FAILURE="message.failure";a.EVENT_MESSAGESHOW_COMPLETE="messageshow.complete";a.EVENT_MESSAGESHOW_FAILED="messageshow.failed";a.EVENT_MESSAGE_SHOW="message.showMessage";a.EVENT_MESSAGE_CLICK="message.clickMessage";a.EVENT_MESSAGE_TRUE_DISPLAY="message.trueDisplay";a.EVENT_URL_CHANGED="pageload.urlChanged";a.EVENT_PAGE_CHANGED="pagechange.urlChanged";a.EVENT_TARGETGROUP_ENTER="targetgroup.enter";a.EVENT_TARGETGROUP_LEAVE="targetgroup.leave";
a.EVENT_CAMPAIGN_STAMP="campaign.stamp";a.EVENT_CAMPAIGN_UNSTAMP="campaign.unstamp";a.EVENT_CAMPAIGN_CLICK="campaign.click";a.EVENT_DOM_EVENT="domEvent";a.EVENT_DOM_WAIT="domWait";a.EVENT_EASY_EVENT="easyEvent";a.EVENT_JSVAR_WAIT="jsvarWait";a.EVENT_TRIGGER_EVENT="trigger.event";a.EVENT_TRIGGER_FIRE="trigger.fire";a.EVENT_PREVIEW_TOOL_ENABLE="previewTool.enable";a.EVENT_PREVIEW_TOOL_DISABLE="previewTool.disable";a.EVENT_ERROR_SENT="error.sent";a.EVENT_EASY_READY="easy.ready";a.EVENT_DOM_READY="domReady";
a.EVENT_JQUERY_READY="jquery.ready";a.EVENT_STATE_REMOVE="state.remove";a.EVENT_STATE_SET="state.set";a.EVENT_PROMISE_REJECTION_HANDLED="promise.rejectionHandled";a.EVENT_PROMISE_UNHANDLED_REJECTION="promise.unhandledRejection";a.XDM_INIT_TIMEOUT=5E3;a.ENV="prod";a.CUSTOM_SCRIPT_UPDATED_AT=void 0;a.COOKIE_QUICK_CONTEXT="frosmo_quickContext";a.COOKIE_MAX_SIZE=3E3;a.MESSAGE_TRUE_DISPLAY_TIME=3E3;a.JQUERY_INIT_TIMEOUT=1E4;a.CONTEXT_TYPE_SERVER="context.api";a.CONTEXT_TYPE_STORAGE="local.storage";a.CONTEXT_TYPE_XDM=
"shared.context";a.MESSAGE_TYPE_BASIC="basic";a.MESSAGE_TYPE_CACHED="cached";a.STATE_DEVICE="_device";a.STATE_MODE="_mode";a.STATE_MODE_TEST="test";a.STATE_TYPE_PAGE=3;a.STATE_TYPE_SESSION=2;a.DEVICE_REGEXP_IOS=/(iPhone|iPod)/i;a.DEVICE_REGEXP_IPAD=/iPad/i;a.DEVICE_REGEXP_ANDROIDMOBILE=/Android.+(mobile|Opera (mini|mobi))/i;a.DEVICE_REGEXP_ANDROIDTABLET=/Android(?!.+(mobile|Opera (mini|mobi)))/i;a.DEVICE_REGEXP_WINDOWSPHONE=/Windows Phone|Windows CE|Windows Mobile|IEMobile/i;a.DEVICE_REGEXP_WINDOWSTABLET=
/Windows.*ARM/i;a.DEVICE_REGEXP_OTHERMOBILE=/(\sPPC|Blackberry|Cricket|iPAQ|HTC_Touch|HTC_HD2|HTC-ST7377|Kindle|LG\d|LG-G|LG-L|LGE|Teleca|POLARIS|MOT-|MOT\d|Nintendo|Nokia|Symbian|SymbOS|SPV\s|PalmSource|PalmOS|SAMSUNG|sam-r\d|samr\d|SCH-A950|SEC-SGH|SHARP|SIE-|UP\.BROWSER|sonyericsson|UC(\s?)Browser|WebOS|Pantech|MobileExplorer|ZuneWP7|Opera Mini|Opera Mobi)/i;a.DEVICE_REGEXP_OTHERTABLET=/Playbook|hp-tablet|Opera Tab/i;a.MESSAGE_PRE_RENDERER_SCRIPT_ID="frosmo_message_pre_renderer_script_id_";a.MESSAGE_SCRIPT_ID=
"frosmo_message_script_id_";a.SHARED_CODE_ID="frosmo_shared_code_id_";a.MESSAGE_STYLE_ID="frosmo_message_style_id_";a.DOM_EVENT_NAMESPACE="easy_core";a.LOG_LEVEL_DEBUG="debug";a.LOG_LEVEL_INFO="info";a.LOG_LEVEL_WARN="warn";a.LOG_LEVEL_WARNING="warning";a.LOG_LEVEL_LOG="log";a.LOG_LEVEL_ERROR="error";a.LOG_LEVEL_CRITICAL="critical";a.MAXIMUM_URL_LENGTH=4100;a.MAXIMUM_TRACE_LENGTH=2E3;a.GA_INIT_TIMEOUT=5E3;a.sharedContextRpc=null;ba.constants={};a.ERROR_TYPE_AJAX_EXCEPTION="ajax.exception";a.ERROR_TYPE_AJAX_CANCELLED=
"ajax.cancelled";a.ERROR_TYPE_AJAX_TIMEOUT="ajax.timeout";a.ERROR_TYPE_ARG_INVALID="arg.invalid";a.ERROR_TYPE_CONTEXT_EXCEPTION="context.exception";a.ERROR_TYPE_CONTEXT_INVALID="context.invalid";a.ERROR_TYPE_CONTEXT_INIT="context.init";a.ERROR_TYPE_CONTEXT_INIT_LONG="context.init_long";a.ERROR_TYPE_CONTEXT_INIT_READY="context.init_ready";a.ERROR_TYPE_CONTEXT_INIT_REQUIREMENTS="context.init_requirements";a.ERROR_TYPE_CONTEXT_INIT_SELECTOR="context.init_selector";a.ERROR_TYPE_CONTEXT_INIT_STORAGE="context.init_storage";
a.ERROR_TYPE_CONTEXT_INIT_TIMEOUT="context.init_timeout";a.ERROR_TYPE_CONTEXT_READY="context.ready";a.ERROR_TYPE_COOKIE_LONG="cookie.long";a.ERROR_TYPE_CORE_INIT="core.init";a.ERROR_TYPE_CUSTOM_ACTION_INVALID="customaction.invalid";a.ERROR_TYPE_DEPRECATED="deprecated";a.ERROR_TYPE_ELEMENTS_LONG="elements.long";a.ERROR_TYPE_EXCEPTION="exception";a.ERROR_TYPE_GA_EXCEPTION="ga.exception";a.ERROR_TYPE_GA_MISSING="ga.missing";a.ERROR_TYPE_INIT="init";a.ERROR_TYPE_JQUERY_MISSING="jquery.missing";a.ERROR_TYPE_SHARED_CODE_EXCEPTION=
"sharedCode.exception";a.ERROR_TYPE_MESSAGE_EXCEPTION="message.exception";a.ERROR_TYPE_MESSAGE_INIT="message.init";a.ERROR_TYPE_MESSAGE_INVALID="message.invalid";a.ERROR_TYPE_MODULE_MISSING="module.missing";a.ERROR_TYPE_ORIGIN_MISMATCH="origin.mismatch";a.ERROR_TYPE_POSITION_EXCEPTION="position.exception";a.ERROR_TYPE_QUEUE_LONG="queue.long";a.ERROR_TYPE_RENDERER_INVALID="renderer.invalid";a.ERROR_TYPE_SEGMENT_EXCEPTION="segment.exception";a.ERROR_TYPE_SELECTOR_INVALID="selector.invalid";a.ERROR_TYPE_SITE_EXCEPTION=
"site.exception";a.ERROR_TYPE_SITE_INIT="site.init";a.ERROR_TYPE_STORAGE_EXCEPTION="storage.exception";a.ERROR_TYPE_STORAGE_MISSING="storage.missing";a.ERROR_TYPE_TEMPLATE_EXCEPTION="template.exception";a.ERROR_TYPE_TEMPLATE_MISSING="template.missing";a.ERROR_TYPE_TIMEOUT="timeout";a.ERROR_TYPE_TRIGGER_EXCEPTION="trigger.exception";a.ERROR_TYPE_URL_LONG="url.long";a.ERROR_TYPE_VERSION_INVALID="version.invalid";a.MODULE_CORE="[core]";a.MODULE_SITE="[site]";a.MODULE_SHARED_CODE="[sharedCode]";a.MODULE_MESSAGE=
"[message]";a.MODULE_POSITION="[position]";a.MODULE_SEGMENT="[segment]";a.MODULE_TRIGGER="[trigger]";(function(){a.xdmLocal=function(f){if(!f.remote)throw new y('Invalid "remote" property for '+f.remote);this.timeout=f.timeout;this.timerId=0;f=a.utils.parseUri(f.remote);this.domain=f.protocol+"://"+f.authority;this.path=f.path;this.callbacks=[];this.allowedOrigin=this.domain;this.remoteOrigin=this.remoteIframe=null;this.debugging=a.store.get("frosmo_xdm_debug");this.index=this.totalCount;this.selector=
a.config.xdmIframeInHead?"head":"body";f="Selector: "+this.selector+", Domain: "+this.domain+", Path: "+this.path;this.errOpts={level:a.LOG_LEVEL_ERROR,debug:f};this.warnOpts={level:a.LOG_LEVEL_WARNING,debug:f};this.infoOpts={level:a.LOG_LEVEL_INFO,debug:f};return this};a.xdmLocal.prototype={totalCount:0,domains:{},init:function(){if(!this.domain||!this.path)throw new y("Invalid domain/path for "+this.domain+","+this.path);if(a.xdmLocal.prototype.domains[this.domain])throw new y("Already connected to "+
this.domain);a.xdmLocal.prototype.domains[this.domain]=!0;a.xdmLocal.prototype.totalCount+=1;this.log("Initialize "+this.domain);var f=this,g=new a.Promise(function(a,e){f.onReady=function(){a(f)};f.onError=e});return a.domElements.waitFor({selector:f.selector,timeout:1E4}).then(function(d){a.domEvents.on(window,"message."+a.DOM_EVENT_NAMESPACE,f.receiveMessage,f);var e=A.createElement("iframe");e.src=f.domain+f.path+"?"+a.VERSION;e.width=0;e.height=0;e.tabIndex=-1;e.id="frosmo-xdm";e.style.display=
"none";d[0].appendChild(e);f.timeout&&(f.timerId=a.utils.setTimeout(function(){var b=new y('xdmRemote "ready" method timed out after '+f.timeout+" millisecond(s)");f.onError(a.internal.createLogError(b,a.ERROR_TYPE_CONTEXT_INIT_TIMEOUT,f.warnOpts))},f.timeout));return g}).catch(function(d){f.onError(a.internal.createLogError(d,a.ERROR_TYPE_CONTEXT_INIT_SELECTOR,f.warnOpts));return g})},get:function(f){var g=this;return new a.Promise(function(a){g.callbacks.push(a);g.sendMessage({method:"get",name:f})})},
set:function(f,g){var d=this;return new a.Promise(function(a){d.callbacks.push(a);d.sendMessage({method:"set",name:f,value:g})})},reset:function(){a.xdmLocal.prototype.domains={};a.xdmLocal.prototype.totalCount=0},receiveMessage:function(f){if(f.origin)if(f.origin.toLowerCase()!==this.allowedOrigin.toLowerCase())this.log("Invalid domain for "+f.origin+", it was not "+this.allowedOrigin,void 0,!0);else{var g;try{g=x.JSON.parse(f.data),g.method=g.method}catch(d){this.log('Invalid message "data" property',
f,!0);return}this.log("Recieved (local) "+g.method+", origin: "+f.origin,f.data);switch(g.method){case "ready":X(this.timerId);if(this.remoteIframe){a.log.warn('xdmRemote "ready" method already received',a.ERROR_TYPE_CONTEXT_READY,this.warnOpts);break}this.remoteIframe=f.source;this.remoteOrigin=f.origin;this.onReady();break;case "error":X(this.timerId);f=new y(g.value);switch(g.type){case a.ERROR_TYPE_CONTEXT_INIT_REQUIREMENTS:this.onError(a.internal.createLogError(f,a.ERROR_TYPE_CONTEXT_INIT_REQUIREMENTS,
this.infoOpts));break;case a.ERROR_TYPE_CONTEXT_INIT_LONG:this.onError(a.internal.createLogError(f,a.ERROR_TYPE_CONTEXT_INIT_LONG,this.warnOpts));break;default:this.onError(a.internal.createLogError(f,a.ERROR_TYPE_CONTEXT_EXCEPTION,this.errOpts))}break;case "get":case "set":f=this.callbacks.shift(),a.utils.isFunction(f)&&f(g.value),g.error&&a.log.warn(g.error,a.ERROR_TYPE_CONTEXT_EXCEPTION,this.warnOpts)}}else this.log('Invalid "message" argument, does not contain an origin property',void 0,!0)},
sendMessage:function(f){if(!this.remoteIframe||!this.remoteOrigin){f=new y('xdmRemote "ready" method not received');var g=a.utils.clone(this.errOpts);g.module=a.internal.getCurrentModule();throw a.internal.createLogError(f,a.ERROR_TYPE_CONTEXT_INIT_READY,g);}try{this.remoteIframe.postMessage(x.JSON.stringify(f),this.remoteOrigin)}catch(d){throw a.internal.createLogError(d,"context_"+a.ERROR_TYPE_ARG_INVALID,this.warnOpts);}},log:function(f,g,d){this.debugging&&(d?a.console.error:a.console.log)("[xdmLocal]",
"Index:"+this.index+","+f,g)}}})();a.fetch=function(){function f(b){function c(b,c){b=b||t.status?b.slice(0,255):"Unexpected error with the ajax request (default)";var d={text:b,type:c,status:t.status,url:z,method:f},e;try{e=x.JSON.stringify(d)}catch(h){e='{"text":"Unexpected error with the ajax request (default)","type":"'+c+'","status":-1,"url":"'+z+'","method":"'+f+'"}'}v?v(t,t.statusText,d,e):a.internal.hasRejectionHandler(u)||a.log.error(b,c,{debug:e});l({xhr:t,textStatus:t.statusText,errorThrown:d})}
if(!a.utils.isObject(b)||a.utils.isEmpty(b))throw new y('Invalid type for ajax "options" argument, for "'+b+'"');if(!b.url)throw new y('Invalid type for ajax "url" property, got "'+a.utils.getType(b.url)+'"');var h=b.dataType||"JSON";g(h,d,"options.dataType");g(b.method,e,"options.method");var f=b.method.toUpperCase(),n,l,k,u=new a.Promise(function(a,b,c){n=a;l=b;k=c}),w=a.utils.isFunction(b.success)?a.guard(b.success):function(){},v=a.utils.isFunction(b.error)?a.guard(b.error):void 0,t=new Da;k(function(){t.abort()});
var z=b.url,G=b.data,C=b.headers;if("GET"===f)z=a.utils.addQueryString(z,b.params),G=void 0;else if("POST"===f||"PUT"===f||"PATCH"===f)"formdata"!==a.utils.getType(G)&&a.utils.isObject(G)&&(G=a.utils.addQueryString("",G).slice(1)),b.skipDefaultHeaders||(C=a.utils.extend({"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},C));t.onload=t.onerror=a.guard(function(){if(u.isCancelled())c("Request was cancelled",a.ERROR_TYPE_AJAX_CANCELLED);else if(200<=t.status&&299>=t.status)a:{var b=
t.responseText,d=b;if("JSON"===h)try{d=x.JSON.parse(b)}catch(z){if("GET"===f){c('Invalid JSON ajax response, for "'+b+'"',a.ERROR_TYPE_AJAX_EXCEPTION);break a}}w(d,t.statusText,t);n(d)}else c(t.responseText,a.ERROR_TYPE_AJAX_EXCEPTION)});t.ontimeout=a.guard(function(){c("Timeout occurred with the ajax request (default)",a.ERROR_TYPE_AJAX_TIMEOUT)});a.utils.setTimeout(function(){a.debug.addEntry("fetch",b);t.open(f,z,!0);t.withCredentials=D(b.withCredentials);a.utils.each(C,function(a,b){t.setRequestHeader(b,
a)});0<b.timeout&&(t.timeout=b.timeout);t.send(void 0===G?null:G)});return u}function g(b,c,d){if(!a.utils.inArray(c,B(b).toUpperCase()))throw new y('Invalid ajax "'+d+'" argument, got "'+x.JSON.stringify(b)+'"');}var d=["JSON","TEXT"],e=["GET","POST","PUT","DELETE","PATCH"];return{ajax:f,get:function(b,c){return f(a.utils.extend({},c,{url:b,method:"GET"}))},post:function(b,c){return f(a.utils.extend({},c,{url:b,method:"POST"}))}}}();a._jsonp=function(){function f(a,b,c){return function(d){a(d);g[b]=
function(){};c.removeAttribute("src");c.parentNode&&c.parentNode.removeChild(c)}}var g={},d=0;return{request:function(e,b){if(a.utils.isString(e)&&a.utils.isFunction(b)){var c="req"+d++;e=a.utils.addQueryString(e,{callback:"frosmo.easy._jsonp._callbacks."+c});var h=a.domElements.addScriptTag(e,!1);g[c]=f(a.guard(b),c,h)}},_callbacks:g}}();x.JSON=function(){function f(){return qa.parse.apply(this,arguments)}return{parse:f,safeParse:function(g,d,e){try{return f(g,e)}catch(b){a.console.warn("[JSON]",
'Invalid type for "str" argument, got',g,b,e)}return d},stringify:function(){var a=[0,0],d=[ha,J],e;for(e=0;2>e;e++)a[e]=d[e].prototype.toJSON,delete d[e].prototype.toJSON;var b=qa.stringify.apply(this,arguments);for(e=0;2>e;e++)a[e]&&(d[e].prototype.toJSON=a[e]);return b}}}();a.spa=function(){function f(b,c){if(c.hashchange)a.domEvents.on(window,"hashchange."+a.DOM_EVENT_NAMESPACE,a.spa.onHashChangeEvent);if(c.popstate)a.domEvents.on(window,"popstate."+a.DOM_EVENT_NAMESPACE,a.spa.onPopStateEvent);
c.pushstate&&U&&U.pushState&&(e=U.pushState,g(c.checkInterval))}function g(c){U.pushState!==d&&(void 0!==d&&c.updateRef&&(e=U.pushState),U.pushState=d=a.guard(a.spa.onPushState));0<c.delay&&(b=a.utils.setTimeout(function(){g(c)},c.delay))}var d,e,b=0,c;return{init:function(b){a.spa.isEnabled()&&(c=b,f(b,a.spa.getConfig()),a.ready(function(){a.events.on(a.EVENT_PAGE_CHANGED,a.spa.onPageChangeEvent)}))},clear:function(){a.domEvents.off(window,"hashchange."+a.DOM_EVENT_NAMESPACE,a.spa.onHashChangeEvent);
a.domEvents.off(window,"popstate."+a.DOM_EVENT_NAMESPACE,a.spa.onPopStateEvent);X(b);void 0!==e&&U.pushState!==e&&(U.pushState=e);a.events.off(a.EVENT_PAGE_CHANGED,a.spa.onPageChangeEvent);e=d=void 0;b=0;c=void 0},getConfig:function(){if(!a.config.singlePageSupport)return{hashchange:!1,popstate:!1,pushstate:!1,cancelPendingRequests:!1,clearEvents:[],checkInterval:{delay:1E3,updateRef:!1}};var b={hashchange:!0,popstate:!0,pushstate:!0,cancelPendingRequests:!1,clearEvents:[],checkInterval:{delay:1E3,
updateRef:!1}};if(a.utils.isObject(a.config.singlePageSupport))return a.utils.extend(b,a.config.singlePageSupport);a.deprecate('Data type of boolean for "easy.config.singlePageSupport"',"SinglePageConfig",function(){})();return b},isEnabled:function(){return D(a.config.singlePageSupport)},onPageChangeEvent:function(b,c){a.console.log("[spa]","URL changed, re-initializing",b);a.debug.clear();var d=a.spa.getConfig();a.events.clearEvent(a.EVENT_UID_CREATED);a.events.clearEvent(a.EVENT_VISIT);a.events.clearEvent(a.EVENT_URL_CHANGED);
a.utils.each(d.clearEvents,function(b){a.events.clearEvent(b)});a.campaign.clear();a.message.clear();a.triggers.clear();a.segments.clear();a.strategies&&a.strategies.clear();var e=a.main.getCurrentBrowserData(),f=a.utils.extend({},R,{href:b});a.handleCurrentPage(f,e.href);a.events.clearEvent(a.EVENT_SCRIPT_LOAD);a.events.clearEvent(a.EVENT_DOM_READY);a.events.trigger(a.EVENT_SCRIPT_LOAD);a.events.trigger(a.EVENT_DOM_READY);a.strategies&&a.strategies.init(a.config.strategies);a.triggers.init(a.config.triggers);
a.states.init();a.internal.states(f.href);a.segments.init();a.quickMessage.requestMessages();a.config.requestMessages&&a.message.requestMessages({cancelPending:d.cancelPendingRequests});a.events.trigger(a.EVENT_URL_CHANGED,b,c)},onHashChangeEvent:function(){var b=R.href;a.utils.getAbsoluteUrl(b)!==c&&a.spa.trigger(b)},onPopStateEvent:function(){a.spa.trigger(R.href)},onPushState:function(b,c,d){a.spa.trigger(d);return e.apply(U,arguments)},trigger:function(b){b=a.utils.getAbsoluteUrl(b);a.events.trigger(a.EVENT_PAGE_CHANGED,
b,c);c=b}}}();a.config={};a.init=function(f){a.main.setCurrentBrowserData(R.href,A.referrer);a.main.initStart();if(a.isDisabled())return a.console.warn("[init]","Frosmo Core is disabled"),!1;a.internal.debug(R.href);f=a.utils.extend({},a.config,f);a.config=f;a.api.init(f.api.domain,f.api.origin);if(!a.checkRequirements(P.userAgent))return a.main.initFailure(void 0),!1;if(!a.versionAtLeast(a.MINIMUM_RULES_VERSION,a.VERSION_RULES))return a.main.initFailure('Invalid minimum "rules" version, expected '+
a.MINIMUM_RULES_VERSION,a.ERROR_TYPE_VERSION_INVALID,{level:a.LOG_LEVEL_WARNING}),!1;a.events.trigger(a.EVENT_SCRIPT_LOAD);a.internal.dispatchEvent("frosmo.load");f.cookieDomain&&a.cookies.setCookieDomain(f.cookieDomain);a.events.trigger(a.EVENT_EASY_CONFIG);a.sharedCode.init(f.sharedCode);a.domEvents.init();a.spa.init(R.href);a.strategies&&a.strategies.init(f.strategies);a.triggers.init(f.triggers);a.domElements.init(a.scriptNamespace);a.domElements.addStyles(a.styles);a.states.init();a.internal.states(R.href);
a.message.init({positions:f.positions});if(f.requestMessages){var g=a.spa.getConfig();a.message.requestMessages({cancelPending:g.cancelPendingRequests})}f.dataLayer&&a.ready(a.dataLayer.init);a.contextLoader.init(f,P.userAgent);a.events.once(a.EVENT_INIT_CONTEXT,function(d){if(d.origin!==f.api.origin)a.main.initFailure('Origin mismatch for local context, got "'+d.origin+'"',a.ERROR_TYPE_ORIGIN_MISMATCH,{level:a.LOG_LEVEL_ERROR,module:a.internal.getCurrentModule()});else a.events.once(a.EVENT_INIT_UID,
function(){a.main.init(d,f,new E)})});a.events.on(a.EVENT_UID_CREATED,function(d){a.ready(function(){a.internal.connectSegments(d)})});a.quickMessage.init(f.quickMessages,P.userAgent);a.events.once(a.EVENT_INIT_QUICK_CONTEXT,function(d){a.quickMessage.requestMessages();d.origin&&d.origin!==f.api.origin&&a.log.info('Origin mismatch for quick context, got "'+d.origin+'"',a.ERROR_TYPE_ORIGIN_MISMATCH,{module:a.internal.getCurrentModule()})});return!0};a.getSite=function(){x.site=x.site||{};return x.site};
a.handleCurrentPage=function(f,g){a.main.updateBrowserData(window,function(){a.conversion.handle(A,"core_module",0)},f,g)};a.isDev=function(){return"dev"===a.ENV};a.isDisabled=function(){var f=a.utils.parseUri(R.href).queryKey.frosmo;"on"===f?a.cookies.remove("frosmo-off"):"off"===f&&a.cookies.set("frosmo-off",1);return D(a.cookies.get("frosmo-off"))};a.isReady=function(){return a.events.isTriggered(a.EVENT_EASY_READY)};a.ready=function(f,g){if(a.utils.isFunction(f))a.events.once(a.EVENT_EASY_READY,
f,g);return new a.Promise(function(d){a.events.once(a.EVENT_EASY_READY,d,g)})};(function(){function f(a){r(K.bind(c,a));if("pending"!==a._state&&a._chains.length!==a._index)for(;a._index<a._chains.length;){var b=a._chains[a._index++];b.promise._suppressRejections=a._suppressRejections;var d="resolved"===a._state?b.onResolved:b.onRejected;if(d)r(K.bind(g,b,a,d));else if("resolved"===a._state)b.resolve(a.value);else if("rejected"===a._state){var d=a,e=b.promise;e._isCancelled=d._isCancelled;e._suppressRejections=
d._suppressRejections;b.reject(a.value)}}}function g(a,b){try{d.call(this,b(a.value))}catch(c){this.reject(c)}}function d(b){function c(a,b){if(!g)return g=!0,a?d.call(this,b):this.reject(b)}if(this.promise===b)this.reject(new ea("A Promise's callback cannot return the same Promise instance"));else if(b instanceof a.Promise)b.then(K.bind(d,this),this.reject);else if(a.utils.isFunction(b)||a.utils.isObject(b)){var e;try{e=b.then}catch(f){this.reject(f);return}if(a.utils.isFunction(e)){var g=!1;try{e.call(b,
K.bind(c,this,!0),K.bind(c,this,!1))}catch(f){c.call(this,!1,f)}}else this.resolve(b)}else this.resolve(b)}function e(a,b){var c=2===arguments.length;this._onCancel=function(d){this._isCancelled=!0;void 0===d&&(d=new y("Promise was cancelled"));r(function(){try{c&&b(),a(d)}catch(e){a(e)}})}}function b(a,b){"pending"===this._state&&(this._state=a,this.value=b,f(this))}function c(){if("rejected"===this._state&&!this._rejectionChecked){var b=h(this);a.isDev()&&(v[this._id]=[b?a.EVENT_PROMISE_REJECTION_HANDLED:
a.EVENT_PROMISE_UNHANDLED_REJECTION,this.value,this]);this._suppressRejections||(b?a.events.trigger(a.EVENT_PROMISE_REJECTION_HANDLED,this):(a.events.trigger(a.EVENT_PROMISE_UNHANDLED_REJECTION,this.value,this),a.console.warn("[easy.Promise]","Uncaught (in Promise)",this.value,this)))}}function h(b){if(b._hasRejectionHandler||b._rejectionChecked)return!0;b._rejectionChecked=!0;return a.utils.some(b._chains,function(a){return h(a.promise)})}function r(b){1===k.push(a.guard(b,w))&&u()}function n(){for(var a=
0;a<k.length;a++)(0,k[a])();k.length=0}var l=0,k=[],u=function(){var b=x.MutationObserver||x.WebKitMutationObserver||b;if(b){var c=0,d=A.createTextNode("");(new b(function(){a.runGuarded(n)})).observe(d,{characterData:!0});return function(){c=0===c?1:0;d.data=c}}return function(){a.utils.setTimeout(n)}}(),w={onError:function(b){a.log.send(b,"promise."+a.ERROR_TYPE_EXCEPTION,{level:a.LOG_LEVEL_CRITICAL})}},v={},t=!0;a.Promise=function(c,f){var g=this instanceof a.Promise;if(!g)throw new ea('"easy.Promise" cannot be called as a function. Use the "new" keyword to construct a new "Promise" object');
if(!a.utils.isFunction(c))throw new ea('Invalid type for "executor" argument, got "'+a.utils.getType(c)+'"');if(g&&("pending"===this._state||"resolved"===this._state))throw new ea('Invalid "this", cannot be a pending or resolved "Promise" object');this._id=++l;this._state="pending";this._index=0;this._chains=[];this._parent=void 0;this._suppressRejections=void 0!==f?D(f):a.Promise.suppressRejections;this._rejectionChecked=this._hasRejectionHandler=!1;a.isDev()&&(this._executor=c,this._stackTrace=
(new y).stack);this.value=void 0;var h=K.bind(b,this,"resolved"),g=K.bind(b,this,"rejected"),t=K.bind(e,this,g);this._isCancelled=!1;e.call(this,g);h={promise:this,resolve:h,reject:g,onCancel:t};try{c(K.bind(d,h),g,t)}catch(v){g(v)}};J.defineProperty(a.Promise,"suppressRejections",{get:function(){return t},set:function(b){if(!a.utils.isBoolean(b))throw new y('Invalid type for "suppressRejections" argument, got "'+a.utils.getType(b)+'"');t=b}});a.Promise.prototype.then=function(b,c){var d={};d.promise=
new this.constructor(function(a,b,c){d.resolve=a;d.reject=b;d.onCancel=c});d.onResolved=a.utils.isFunction(b)?b:void 0;d.onRejected=a.utils.isFunction(c)?c:void 0;d.promise._parent=this;d.promise._hasRejectionHandler=D(d.onRejected);this._chains.push(d);f(this);return d.promise};a.Promise.prototype.catch=function(a){return this.then(void 0,a)};a.Promise.resolve=function(b){return a.utils.isObject(b)&&b.constructor===this?b:new this(function(a){a(b)})};a.Promise.reject=function(a){return new this(function(b,
c){c(a)})};a.Promise.all=function(b){var c=this;return new c(function(d,e){if(a.utils.isArray(b)){var f=[],g=b.length;0===g?d(f):a.utils.each(b,function(a,b){c.resolve(a).then(function(a){f[b]=a;0===--g&&d(f)},e)})}else e(new ea('Invalid argument, expected "iterable" to be an array data type::"'+a.utils.getType(b)+'"'))})};a.Promise.race=function(b){var c=this;return new c(function(d,e){a.utils.isArray(b)?a.utils.each(b,function(a){c.resolve(a).then(d,e)}):e(new ea('Invalid argument, expected "iterable" to be an array data type::"'+
a.utils.getType(b)+'"'))})};a.Promise.prototype.finally=function(b){this._hasRejectionHandler=!0;b=a.utils.isFunction(b)?b:function(){};var c=this;return c.then(function(a){return c.constructor.try(b).then(function(){return a})}).catch(function(a){return c.constructor.try(b).then(function(){throw a;})})};a.Promise.prototype.cancel=function(a){"pending"!==this._state||this.isCancelled()||this._onCancel(a)};a.Promise.prototype.isCancelled=function(){return this._isCancelled};a.Promise.prototype.timeout=
function(b,c){1===arguments.length&&(c=new y("Promise timed out after "+b+" millisecond(s)"));var d=this,e=new d.constructor(function(e,f){a.utils.setTimeout(function(){d.cancel(c);f(c)},b)});return d.constructor.race([d,e])};a.Promise.errors=function(){return v};a.Promise.try=function(a){return new this(function(b){b(a())})}})();var K=function(){var f=function(){};return{bind:function(g,d){if(!a.utils.isFunction(g))throw new y('Invalid type for bind "fn" argument, got "'+a.utils.getType(g)+'"');
var e=a.utils.arrayFrom(arguments).slice(2);return function(){var b=a.utils.arrayFrom(arguments);return g.apply(g instanceof f?g:d,e.concat(b))}}}}();a.console=function(){function f(b){var d=a.store.get("frosmo_debug_level")||a.LOG_LEVEL_WARN;return c[b]>=c[d]}function g(){if(void 0!==b)return b;b=D(a.store.get("frosmo_debug"));return T&&b}function d(c,d,l){if(!1!==b&&g()&&f(c)){var k=E.now();h=h||k;k-=h;d=a.utils.arrayFrom(d);var u=d[0];if(a.utils.isString(u)&&0===u.search(/^\[.*\]$/)){u=u.substring(1,
u.length-1);if(0<e.length&&!a.utils.inArray(e,u))return;d.shift();k=k+": EASY ["+u+"] "+c+"::"}else k=k+": EASY "+c+"::";c=l||c;T[c]?(d.unshift(k),T[c].apply(T,d)):T.log(k,1===d.length?d[0]:d)}}var e=[],b,c={critical:4,error:4,log:3,warn:2,warning:2,info:1,debug:0},h;return{debug:function(){d(a.LOG_LEVEL_DEBUG,arguments,a.LOG_LEVEL_INFO)},error:function(){d(a.LOG_LEVEL_ERROR,arguments)},groupCollapsed:function(a){g()&&T.groupCollapsed&&T.groupCollapsed(a)},groupEnd:function(){g()&&T.groupEnd&&T.groupEnd()},
info:function(){d(a.LOG_LEVEL_INFO,arguments)},log:function(){d(a.LOG_LEVEL_LOG,arguments)},warn:function(){d(a.LOG_LEVEL_WARN,arguments)},isActiveLevel:f,isEnabled:g,setEnabled:function(c){b=D(c);a.store.set("frosmo_debug",b)},setEnabledModules:function(a){e=a},setLevel:function(b){if(!a.utils.isNumber(c[b]))throw new y('Invalid console "level" argument, got  "'+b+'"');a.store.set("frosmo_debug_level",b)}}}();a.domEvents=function(){function f(c){if(a.utils.isString(c))c=[c];else if(!a.utils.isArray(c))throw new y('Invalid type for DOM "eventNamespace" argument, got "'+
a.utils.getType(c)+'" for "'+c+'"');c=b(c);a.utils.each(c,function(b,c){a.utils.each(b,function(a){h(a,a.el)});r[c]=[]})}function g(a,b,c,e,f,g){d(a,b,c,e,f,g,"once")}function d(b,c,d,f,g,h,t){var z=B(c).split(".")[0];if(!a.utils.isString(z)||0===z.length)throw new y('Invalid type for DOM "eventNamespace" argument, got "'+a.utils.getType(c)+'" for "'+c+'"');a.utils.isFunction(d)&&(h=g,g=f,f=d,d=void 0);g=g||this;a.utils.isBoolean(h)||a.utils.isObject(h)||(h=!1);a.utils.each(e(b),function(b){var e=
{el:b,domEvent:z,selector:d,fn:f,context:g,options:h,type:t,delegate:a.guard(function(b){a:{var c=e;if(!c.handled||"once"!==c.type)if(c.selector)for(var d=a.domElements.selector(c.selector,c.el),f=b.target;f&&c.el!==f&&f.nodeType!==V.DOCUMENT_NODE;){if(a.utils.inArray(d,f)){c.handled=!0;c.fn.call(c.context,b,f);break a}f=f.parentNode}else c.handled=!0,c.fn.call(c.context,b,c.el)}}),handled:!1};r[c]=r[c]||[];r[c].push(e);b.addEventListener(z,e.delegate,h)})}function e(b){if(a.utils.isString(b))return a.domElements.selector(b);
b=a.utils.isArray(b)?b:[b];return a.utils.filter(b,function(b){return b&&a.utils.isFunction(b.addEventListener)})}function b(b){var c=/^\*\./;return a.utils.reduce(r,function(d,e,f){a.utils.some(b,function(b){b=c.test(b)?".*\\."+a.utils.escapeRegExp(b.replace(c,"")):a.utils.escapeRegExp(b);return(new Q("^"+b+"(\\.|$)")).test(f)})&&(d[f]=a.utils.arrayFrom(e));return d},{})}function c(){a.events.isTriggered(a.EVENT_DOM_READY)||a.events.trigger(a.EVENT_DOM_READY)}function h(a,b,c,d){return!b.removeEventListener||
b!==a.el||d&&d!==a.fn||c&&c!==a.selector?!1:(b.removeEventListener(a.domEvent,a.delegate,a.options),!0)}var r={};return{init:function(){"complete"===A.readyState||"loading"!==A.readyState&&!A.documentElement.doScroll?c():(g(A,"DOMContentLoaded."+a.DOM_EVENT_NAMESPACE,c),g(window,"load."+a.DOM_EVENT_NAMESPACE,c));a.utils.waitFor(10,a.JQUERY_INIT_TIMEOUT,function(){return D(window.jQuery)}).then(function(){a.events.trigger(a.EVENT_JQUERY_READY,window.jQuery)}).catch(function(){a.events.trigger(a.ERROR_SITE_JQUERY_MISSING)})},
clear:f,fire:function(a,b){var c=A.createEvent("HTMLEvents");c.initEvent(b,!0,!0);return!a.dispatchEvent(c)},off:function(c,d,f,g){var w=e(c);a.utils.isFunction(f)&&(g=f,f=void 0);c=b([d]);a.utils.each(c,function(b,c){a.utils.each(w,function(d){r[c]=a.utils.filter(b,function(a){return!h(a,d,f,g)})})})},on:function(a,b,c,e,f,g){d(a,b,c,e,f,g,"on")},once:g,ready:function(b,c){if(a.utils.isFunction(b))a.events.once(a.EVENT_DOM_READY,b,c);return new a.Promise(function(b){a.events.once(a.EVENT_DOM_READY,
b,c)})},_testClear:function(){var b=a.utils.keys(r);f(b)}}}();a.domElements=function(){function f(a,b,c,d){var e=A.createElement("script");b?e.text=a:e.src=a;e.async=!0;return w(e,c,!1,d)}function g(b,c){a.utils.isString(c)&&c.length&&(b="/**"+c+"**/\n"+b+"\n/**"+c+"**/\n");h(a.utils.trim(m+" "+b))}function d(a){return a&&z(a)?a.getBoundingClientRect():{}}function e(a){var b=d(a);a=r(a);return 300<b.width||300<b.height?.75<=a.visible||.75<=a.possible:1===a.visible}function b(a){var b=d(a);return"none"!==
a.style.display&&"hidden"!==a.style.visibility&&(0<b.width||0<b.height)}function c(b,c,d){c=c||A;d=!1!==d;var e=a.events.isTriggered(a.EVENT_JQUERY_READY)&&window.jQuery;try{return d&&e?a.utils.arrayFrom(window.jQuery(b,c)):a.sizzle?a.sizzle(b,c):a.utils.arrayFrom(c.querySelectorAll(b))}catch(f){a.log.error(f,a.ERROR_TYPE_SELECTOR_INVALID,{debug:d&&!e?'jQuery not found for selector of "'+b+'"':"Invalid "+(d?"jQuery":"CSS")+' selector of "'+b+'"'})}return[]}function h(a){F||(F=A.createElement("style"),
F.id=q);m=F.innerHTML=a;c("#"+q)[0]||A.head.appendChild(F)}function r(b){var c={possible:1,visible:1},e=A.documentElement.clientHeight,f=A.documentElement.clientWidth,g=d(b);if(0<=g.top&&0<=g.left&&g.bottom<=e&&g.right<=f)return c;if(!A.body)throw a.internal.createLogError("Body not found",a.ERROR_TYPE_SELECTOR_INVALID,{module:a.internal.getCurrentModule()});var h=A.body.scrollLeft,z=A.body.scrollTop;b=t(g.left+h,g.top+z,b.offsetWidth,b.offsetHeight);e=t(h,z,f,e);f=H.max(b.left,e.left);h=H.min(b.right,
e.right);z=H.max(b.top,e.top);z=H.min(b.bottom,e.bottom)-z;f=h-f;f=0<=f&&0<=z?f*z:0;e=f/(H.min(b.width,e.width)*H.min(b.height,e.height));b=f/(b.width*b.height);c.possible=e||0;c.visible=b||0;return c}function n(b,c,d,e){function f(){g&&(g.disconnect(),g=void 0);h&&(X(h),h=void 0)}var g,h;e(f);e=a.guard(function(){k(b,c,f)});g=new ra(e);g.observe(A.documentElement,{attributes:!1,characterData:!1,childList:!0,subtree:!0});0!==b.timeout&&(h=a.utils.setTimeout(function(){u(b,d,f)},b.timeout));e()}function l(b,
c,d,e){var f=a.utils.waitFor(b.interval,b.timeout,function(){return k(b,c)},function(){u(b,d)});e(function(){f.cancel()})}function k(a,b,d){var e=c(a.selector,a.context);if(0===e.length)return!1;d&&d();b(e);a.success(e);return!0}function u(a,b,c){c&&c();c=new y("Timed out after "+a.timeout+' millisecond(s), for the selector "'+a.selector+'"');b(c);a.failure(c)}function w(b,c,d,e){c=a.utils.isFunction(c)?c:function(){};if(d)c(b);else a.domEvents.once(b,"load."+a.DOM_EVENT_NAMESPACE,function(){c(b)});
(e||A.head).appendChild(b);return b}function v(b){b=a.utils.isArray(b)?b:[b];return a.utils.filter(b,function(a){return a&&a.nodeType===V.ELEMENT_NODE})}function t(a,b,c,d){a=H.round(a)||0;b=H.round(b)||0;c=H.round(c)||0;d=H.round(d)||0;return{left:a,top:b,width:c,height:d,right:a+c,bottom:b+d}}function z(a){for(var b=0;a;)b=a.nodeType,a=a.parentNode;return b===V.DOCUMENT_NODE}function G(a,b){var c=b.join("|"),d=new Q("<\\s*("+c+")\\b[^>]*>([\\s\\S]*?)<\\/(?:"+c+")>","gim"),e=new Q("^<\\s*(?:"+c+
")[^>]+src=([\\'\"])(.*?)\\1"),f=[];a=a.replace(d,function(a,b,c){a=a.match(e);f.push({name:b,srcAttr:a?a[2]:"",content:c});return""});return[a,f]}function C(b,c){var d=0;a.utils.each(b,function(b){switch(b.name){case "script":b.srcAttr&&b.content&&a.console.warn('Invalid "script" tag, both "src" and "content" have been defined. Info:',c.guardOptions);b.srcAttr?(b=f(b.srcAttr),c.scriptNamespace&&a.utils.addClassName(b,c.scriptNamespace)):b.content&&(a.internal.safeEval(b.content,c,d),d+=1);break;
case "style":g(b.content,c.styleNamespace)}})}function N(b){return b.getClientRects?a.utils.every(b.getClientRects(),function(a){for(a=A.elementFromPoint((a.left+a.right)/2,(a.top+a.bottom)/2);a&&a.parentNode&&a.nodeType===V.ELEMENT_NODE;){if(a===b)return!0;a=a.parentNode}return!1}):!1}var q="f3-style",F=null,m="";return{init:function(a){a&&(q+="-"+a)},addScriptTag:f,addStyleTag:function(a,b,c,d){var e=A.createElement(b?"style":"link");b?e.innerHTML=a:(e.href=a,e.rel="stylesheet",e.type="text/css");
return w(e,c,b,d)},addStyles:g,getBoundingClientRect:d,getCssStyles:function(){return m},getStylesElement:function(){return F},html:function(b,c,d){b=v(b);if(void 0===c)return b.length?b[0].innerHTML:void 0;if(!a.utils.isString(c))throw new y('Invalid type for "htmlString" argument, got "'+a.utils.getType(c)+'"');c=G(c,["script","style"]);var e=c[0];a.utils.each(b,function(a){a.innerHTML=e});d=a.utils.extend({args:{},guardOptions:{},scriptNamespace:void 0,styleNamespace:void 0},d);C(c[1],d)},isInViewPort:e,
isSelector:function(a){try{return A.querySelector(a),!0}catch(b){}return!1},isStyleVisible:b,isVisible:function(c){if(!c)return a.console.warn("[domElements]",'Invalid argument, "el" was not an element node for checking visibility'),!1;var d=e(c),f=b(c);c=N(c);return d&&f&&c},loadPiwik:function(a){if(!a)return!1;var b=window._paq||[];b.push(["trackPageView"]);b.push(["enableLinkTracking"]);b.push(["setTrackerUrl","//piwik.inpref.com/piwik.php"]);b.push(["setSiteId",a]);f("//piwik.inpref.com/piwik.js");
return!0},matches:function(b,c,d){d=d||b.ownerDocument||A;c=a.domElements.selector(c,d);return a.utils.inArray(c,b)},removeStyles:function(b,c){if(F){b=a.utils.isString(b)?b:"";c=a.utils.isString(c)?c:"";var d=(c=a.utils.escapeRegExp(c))?"\\s*\\/\\*\\*"+c+"\\*\\*\\/\\s*":"\\s*";b=a.utils.escapeRegExp(b).replace(/"|'/g,"(\"|')");d=new Q(d+(b?b+"(\\s*)\\{[^\\{\\}]*\\}":"[\\s\\S]*")+d,"gi");d=m.replace(d,"\n").replace(/\n+/g,"\n");h(a.utils.trim(d))}},removeStylesElement:function(){F&&(F.parentNode.removeChild(F),
F=null,m="")},selector:c,updateStylesElement:h,visible:r,visibility:function(a){var b;if(!(b=!z(a))){a:{for(b=a;b&&b.nodeType!==V.DOCUMENT_NODE;){var c=wa(b);if("0"===c.opacity||"none"===c.display||"hidden"===c.visibility){b=!1;break a}b=b.parentNode}b=!0}b=!b}if(b)return 0;b=A.documentElement.clientHeight;var c=A.documentElement.clientWidth,e=d(a);return 0>e.bottom||0>e.right||e.top>b||e.left>c||0===e.height||0===e.width?0:r(a).visible},waitFor:function(b){b={selector:b.selector,context:b.context,
success:a.utils.isFunction(b.success)?b.success:function(){},failure:a.utils.isFunction(b.failure)?b.failure:function(){},interval:L(b.interval)||100,timeout:a.utils.isNumeric(b.timeout)?L(b.timeout):5E3};b=x.MutationObserver||x.WebKitMutationObserver?K.bind(n,null,b):K.bind(l,null,b);return new a.Promise(b)}}}();(function(){a.storage=function(f){if(!(this instanceof a.storage))throw new y('"easy.storage" cannot be called as a function. Use the "new" keyword to construct a new "Storage" object');
this._storage=f&&f.clear&&f.getItem&&f.removeItem&&f.setItem?f:null};a.storage.prototype={get length(){return this.exists()?M(this._storage.length):0},set length(a){}};a.storage.prototype.clear=function(){if(this.exists())try{this._storage.clear()}catch(a){}};a.storage.prototype.exists=function(){return D(this._storage)};a.storage.prototype.get=function(f,g){if(!this.exists())return null;var d="__frosmoeasy__"+f,e;try{e=this._storage.getItem(d)}catch(b){throw a.internal.createLogError(b,a.ERROR_TYPE_STORAGE_EXCEPTION,
{level:a.LOG_LEVEL_WARNING,module:a.internal.getCurrentModule()});}if(e=e?x.JSON.safeParse(e):void 0)return e.data;this.remove(d);return g};a.storage.prototype.remove=function(a){this.exists()&&this._storage.removeItem("__frosmoeasy__"+a)};a.storage.prototype.set=function(f,g){if(this.exists())try{this._storage.setItem("__frosmoeasy__"+f,x.JSON.stringify({data:g}))}catch(d){throw a.internal.createLogError(d,a.ERROR_TYPE_STORAGE_EXCEPTION,{level:a.LOG_LEVEL_WARNING,module:a.internal.getCurrentModule()});
}}})();a.store=new a.storage(na);a.store.check=function(){if(this.exists())try{return this.set("_(test_key)",1),this.remove("_(test_key)"),!0}catch(a){}return!1};a.utils=function(){function f(a,b,c){var d=!0;D(a,function(a,e,f){return b.call(c,a,e,f)?!0:d=!1},c,0,!0);return d}function g(a,b,c){var d=[];D(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)});return d}function d(a){return e(a,function(a,b){return B(b)})}function e(a,b,c){var d=[];D(a,function(a,e,f){d.push(b.call(c,a,e,f))});return d}function b(a,
b,c,d){var e=3<=arguments.length;D(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(e=!0,c=a)});return c}function c(a){return e(a,function(a){return a})}function h(a){return ha.isArray(a)}function r(a){return"date"===F(a)}function n(a){return k(a)?!0:oa(a)||t(a)?0===a.length:0===d(a).length}function l(a){return"function"===typeof a||"function"===F(a)}function k(a){return null===a||void 0===a}function u(a){return"number"===typeof a||"number"===F(a)}function w(a){return(u(a)||t(a))&&!za(a-L(a))}function v(a){return J(a)===
a}function t(a){return"string"===typeof a||"string"===F(a)}function z(a,c){if(!v(a))return a;c=G({complex:!0,function:!1,node:!1,regexp:!1},c);var d=F(a);switch(d){case "array":return e(a,function(a){return z(a,c)});case "date":return new E(a.getTime());case "function":if(c.function)return function(){return a.apply(this,arguments)};break;case "regexp":if(c.regexp)return d=a.toString().match(/[gimuy]*$/)[0],new Q(a.source,d);break;default:if(pa(a))return c.node&&a.cloneNode?a.cloneNode(!0):a}return"object"===
d||c.complex?b(a,function(a,b,d){a[d]=z(b,c);return a},{}):a}function G(a){D(arguments,function(b){D(b,function(b,c){a[c]=b})},void 0,1);return a}function C(a){var b={anchor:"",host:"",params:{},path:"",queryVariables:{}};if(k(a)||0===B(a).length)return b;a=N(a);if(a.anchor)try{b.anchor=da(a.anchor)}catch(c){b.anchor=a.anchor}b.host=a.host;D(a.queryKey,function(a,c){try{c=da(c),a=da(a),b.params[c]=a}catch(d){b.params[c]=a}});try{b.path=da(a.path)}catch(c){b.path=a.path}b.queryVariables=a.queryKey;
return b}function N(a){a=Ga(a);var b=14,c={};for(a=ga.parser[ga.strictMode?"strict":"loose"].exec(a);0<b-1;)--b,c[ga.key[b]]=a[b]||"";c[ga.queryKey.name]={};c[ga.key[12]].replace(ga.queryKey.parser,function(a,b,d){b&&(c[ga.queryKey.name][b]=d)});return c}function q(a){return pa(a)&&(a=a.getAttribute("class"))?a.match(/[^\x20\t\r\n\f]+/g)||[]:[]}function F(a){return J.prototype.toString.call(a).replace(/^\[object (.*?)\]$/,"$1").toLowerCase()}function m(b){var c=a.context?a.context.userAgent:P.userAgent;
switch(b){case "android":return a.DEVICE_REGEXP_ANDROIDMOBILE.test(c)&&!m("windowsphone");case "ios":return a.DEVICE_REGEXP_IOS.test(c)&&!m("windowsphone");case "othermobile":return a.DEVICE_REGEXP_OTHERMOBILE.test(c)&&!m("android")&&!m("ios")&&!m("windowsphone");case "androidtablet":return a.DEVICE_REGEXP_ANDROIDTABLET.test(c);case "ipad":return a.DEVICE_REGEXP_IPAD.test(c);case "othertablet":return a.DEVICE_REGEXP_OTHERTABLET.test(c)&&!m("androidtablet")&&!m("windowstablet");case "windowsphone":return a.DEVICE_REGEXP_WINDOWSPHONE.test(c);
case "windowstablet":return a.DEVICE_REGEXP_WINDOWSTABLET.test(c)&&!m("windowsphone");case "desktop":return!m("android")&&!m("ios")&&!m("windowsphone")&&!m("othermobile")&&!m("androidtablet")&&!m("ipad")&&!m("windowstablet")&&!m("othertablet");default:throw new y('Invalid "deviceType" argument, got "'+b+'"');}}function p(b,c){return Ba(a.guard(b),c)}function ca(a,b){return-1!==S(a,b)}function S(a,b,c){if(oa(a))for(c=I(c,10)||0,c=H.max(0<=c?c:a.length-H.abs(c),0);c<a.length;c++)if(b===a[c])return c;
return-1}function fa(){return b(arguments,function(a,b){D(b,function(b){ca(a,b)||a.push(b)});return a},[])}function x(a){var b=/([\].|*?+(){}^$\\:=[])/g;return t(a)?a.replace(b,"\\$&"):a}function sa(a,b,c){var d=0<=c;c=H.abs(c);a=B(a);if(0===a.length||a.length>=c)return a;b=B(b);if(0===b.length)return a;c-=a.length;var e=H.ceil(c/b.length)+1;b=ha(e).join(b).slice(0,c);return d?b+a:a+b}function Ea(a,b){if(!t(a))return a;b=t(b)?x(b):"\\s\\uFEFF\\xA0";return a.replace(new Q("^["+b+"]+|["+b+"]+$","g"),
"")}function D(a,b,c,d,e){if(oa(a))for(d=d||0;d<a.length&&(!1!==b.call(c,a[d],d,a)||!e);d++);else if(a)for(var f in a)if(J.prototype.hasOwnProperty.call(a,f)&&!1===b.call(c,a[f],f,a)&&e)break}function ta(a){t(a)?a=Ea(a).split(" "):h(a)||(a=void 0);return a}function Fa(a){return a=pa(a)?[a]:g(a,pa)}function oa(a){return a&&u(a.length)&&0<=a.length&&9007199254740991>=a.length}function pa(a){return a&&a.nodeType===V.ELEMENT_NODE}function Ga(a){if(!a)return a;var c=[[/\?&/g,"?"],[/@/,O("@")]];return b(c,
function(a,b){return a.replace(b[0],b[1])},a)}var ga={strictMode:!1,key:"source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),queryKey:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?))?((((?:[^?#/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@/]*@)([^:/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#/]*\.[^?#/.]+(?:[?#]|$)))*\/?)?([^?#/]*))(?:\?([^#]*))?(?:#(.*))?)/}};
return{each:function(a,b,c){D(a,b,c)},entries:function(a){return e(a,function(a,b){return[b,a]})},every:f,filter:g,find:function(a,b,c){var d;D(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!1):!0},c,0,!0);return d},findIndex:function(a,b,c){var d=-1;D(a,function(a,e,f){return b.call(c,a,e,f)?(d=e,!1):!0},c,0,!0);return d},keys:d,map:e,reduce:b,some:function(a,b,c){var d=!1;D(a,function(a,e,f){return b.call(c,a,e,f)?(d=!0,!1):!0},c,0,!0);return d},values:c,isArray:h,isBoolean:function(a){return"boolean"===
typeof a||"boolean"===F(a)},isDate:r,isEmpty:n,isFunction:l,isInteger:function(a){return u(a)&&ya(a)&&H.floor(a)===a},isNil:k,isNumber:u,isNumeric:w,isObject:v,isPlainObject:function(a){if(!v(a))return!1;a=J.getPrototypeOf(J(a));if(null===a)return!0;a=J.prototype.hasOwnProperty.call(a,"constructor")&&a.constructor;return l(a)&&a instanceof a&&ma.prototype.toString.call(a)===ma.prototype.toString.call(J)},isPositiveInteger:function(a){var b=~~M(a);return B(b)===a&&0<b},isString:t,arrayFrom:function(a,
b,d){return oa(a)?l(b)?e(a,b,d):c(a):[]},clone:z,extend:G,addQueryString:function(b,c){c=e(c,function(d,e){v(d)&&a.console.error("[utils]",'Invalid type for "params" value. Arrays/Objects should be serialized.',d,e,b,c);return O(e)+"="+O(d)});if(0===c.length)return b;var d=/\?/.test(b)?"&":"?";return b+d+c.join("&")},getAbsoluteUrl:function(a){var b=A.createElement("a");b.href=a;return b.href},getLocationFromUrl:C,matchStringUrls:function(c,d,e){if(/^\//.test(d)){var f=a.main.getCurrentBrowserData().href;
d=(f?C(f).host:"")+d}d=C(d);var f=b(d.queryVariables,function(a,b,c){a[c]=["matchExact",b];return a},{}),g={anchor:d.anchor,matcher:"matchExact"},h=/^www\./;e=C(e);return d.host.toLowerCase().replace(h,"")===e.host.toLowerCase().replace(h,"")&&a.evaluator.matchUrl(c,d.path,f,g,e)},parseUri:N,getDateFromContextFormat:function(a){if(!t(a)||8!==a.length)throw new y('Invalid length for "str" argument, got "'+a+'"');var b=I(a.substring(0,4),10),c=I(a.substring(4,6),10)-1;a=I(a.substring(6,8),10);return new E(b,
c,a,0,0,0,0)},getDateInContextFormat:function(b){if(!r(b))throw a.internal.createLogError('Invalid type for "date" argument, got "'+a.utils.getType(b)+'" for "'+b+'"',a.ERROR_TYPE_ARG_INVALID,{level:a.LOG_LEVEL_WARNING});var c=b.getFullYear(),d=sa(b.getMonth()+1,"0",2);b=sa(b.getDate(),"0",2);return B(c)+B(d)+B(b)},getTargetGroupsFromCookie:function(){var a=A.cookie.match(/frosmo_keywords=([^;$]+)/);return a?(a=Y(a[1]).split("."),g(a,function(a){return 0<a.length})):[]},addClassName:function(a,b){D(Fa(a),
function(a){var c=fa(q(a),ta(b));a.setAttribute("class",c.join(" "))})},getClassNames:q,hasClassName:function(a,b){var c=q(a);return f(ta(b),function(a){return ca(c,a)})},removeClassName:function(a,b){b=ta(b);D(Fa(a),function(a){var c=g(q(a),function(a){return!ca(b,a)});a.setAttribute("class",c.join(" "))})},getIEVersion:function(a,b){var c=new Q(b?"(?:MSIE|Trident.*rv|Edge)[ :/]([0-9]+)":"(?:MSIE|Trident.*rv)[ :]([0-9]+)","i");return(c=a.match(c))?I(c[1],10):-1},getByDotString:function(a,c,d){c=
c||window;d=G({empty:!0,nonObjects:!0,self:!0},d);"window"===a?a=window:(a=a.replace(/^\bwindow\b\.?/,""),a=b(a.split("."),function(a,b){return a&&J.prototype.hasOwnProperty.call(a,b)?a[b]:void 0},c));return d.empty&&n(a)||d.self&&a===c||d.nonObjects&&!v(a)?void 0:a},getTimestamp:function(a){a=r(a)?a:new E;return H.round(a.getTime()/1E3)},getType:F,isDesktop:function(){return m("desktop")},isDevice:m,isMobile:function(){return m("android")||m("ios")||m("othermobile")||m("windowsphone")},isTablet:function(){return m("androidtablet")||
m("ipad")||m("othertablet")||m("windowstablet")},setInterval:function(b,c){(!w(c)||0>=c)&&a.log.error("Invalid interval delay argument, got "+c,a.ERROR_TYPE_ARG_INVALID);return Aa(a.guard(b),c)},setTimeout:p,waitFor:function(b,c,d,e){function f(){v=!0;q&&(X(q),q=void 0)}function g(a,b){try{return a(b)}catch(c){throw t(c),C.reject(c),c;}}function h(b){f();var c=a.utils.arrayFrom(arguments).slice(1);b.apply(null,c)}function t(a){w&&(w=!1,e(a))}function z(){if(!v)if(g(d,C))C.resolve();else if(0===r||
E.now()<r)q=p(z,b);else{var a=new y("Timed out after "+c+" millisecond(s)");g(t,a);C.reject(a)}}var v=!1,w=l(e),q,C={};C.promise=new a.Promise(function(a,b,c){C.resolve=K.bind(h,null,a);C.reject=K.bind(h,null,b);c(f)});c=L(c);var r=0!==c?E.now()+c:c;a.runGuarded(z,void 0,{type:a.ERROR_TYPE_TIMEOUT});return C.promise},inArray:ca,indexOf:S,uniq:fa,escapeRegExp:x,pad:sa,subs:function(a,c,d){if(c.length!==d.length)throw new y('Invalid lengths for "set1" and "set2" arguments, got '+c.length+" and "+d.length);
return b(c,function(a,b,c){return a.replace(new Q(b,"g"),d[c])},a)},trim:Ea,trimInside:function(a){var b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,c=/\s+/g;return t(a)?a.replace(b,"").replace(c," "):a}}}();a.states=function(){function f(c){delete b[c];a.ready(function(){void 0!==a.context.states.session[c]&&(delete b[c],delete a.context.states.session[c],a.context.save())});a.events.trigger(a.EVENT_STATE_REMOVE,c)}function g(c,d,e){b[c]=d;e===a.STATE_TYPE_SESSION&&a.ready(function(){b[c]=d;a.context.states.session[c]=
d;a.context.save()});a.events.trigger(a.EVENT_STATE_SET,c,d,e)}function d(){a.utils.each(a.context.states.session,function(a,b){f(b)})}function e(b){a.utils.each(b.states.session,function(a,b){g(b,a)})}var b={};return{init:function(){b={};a.events.once(a.EVENT_INIT_CONTEXT,e);a.events.once(a.EVENT_INIT_QUICK_CONTEXT,e);a.events.on(a.EVENT_VISIT,d)},get:function(a){return b[a]},getAll:function(){return a.utils.reduce(b,function(a,b,d){a[d]=B(b);return a},{})},remove:f,set:g}}();a.cookies=function(){function f(a){try{a+=
"=";for(var b=A.cookie.split(";"),d=0;d<b.length;d++){var e=b[d].replace(/^\s*/,"");if(0===e.indexOf(a))return Y(e.substring(a.length,e.length))}}catch(f){}return null}function g(c,f,g){if(b){var n="";g&&(n=new E,g*=864E5,n.setTime(n.getTime()+g),n="; expires="+n.toGMTString());try{A.cookie=la(c)+"="+la(f)+n+d+"; path="+e,A.cookie.length>a.COOKIE_MAX_SIZE&&a.log.warn("Cookie size of "+A.cookie.length+", limit is "+a.COOKIE_MAX_SIZE,a.ERROR_TYPE_COOKIE_LONG,{module:a.internal.getCurrentModule()})}catch(l){throw a.internal.createLogError(l,
a.ERROR_TYPE_STORAGE_EXCEPTION,{level:a.LOG_LEVEL_ERROR,module:a.internal.getCurrentModule()});}}}var d="",e="/",b=!0;return{check:function(){try{return 0<=A.cookie.split(";").length}catch(a){}return!1},exists:function(a){return null!==f(a)},get:f,isEnabled:function(){return b},remove:function(a){g(a,"",-1)},set:g,setCookieDomain:function(a){d=/\.[a-z]+$/.test(a)?";domain="+la(a):""},setCookiePath:function(b){if(0<arguments.length&&!a.utils.isString(b))throw new y('Invalid type for cookie "path" argument, got "'+
a.utils.getType(b)+'" for "'+b+'"');e=b||"/"},setEnabled:function(a){b=D(a)}}}();a.debug=function(){var f,g=[],d;return{addEntry:function(a,b){var c=E.now();d=d||c;c=[a,c-d,b];g.push(c);f&&f(c)},clear:function(){g=[]},getAll:function(){return a.utils.arrayFrom(g)},setCallback:function(a){f=a}}}();a.log=function(){function f(e,b,c){var f=a.api.getApiUrl("error"),r=a.api.getOrigin();if(f&&r){var n=e instanceof y;if(!a.utils.isString(e)&&!n)throw new y('Invalid type for logging "data" argument, got "'+
a.utils.getType(e)+'" for "'+e+'"');if(!a.utils.isNumber(b)&&!a.utils.isString(b))throw new y('Invalid type for logging "type" argument, got "'+a.utils.getType(b)+'" for "'+b+'"');if(!c||!c.level||!a.utils.isString(c.level))throw new y('Invalid type for logging "options" argument or "level" property, got "'+a.utils.getType(c)+'" for "'+c+'"');var l=d(c);if(n||void 0===c.trace)n=void 0!==e.stack?e.stack:(new y).stack,l.trace=a.internal.truncate(B(n),a.MAXIMUM_TRACE_LENGTH);c=g(r,e,b,c.level,l);n=a.utils.addQueryString(f,
c);n.length>a.MAXIMUM_URL_LENGTH&&(e="URL limit of "+a.MAXIMUM_URL_LENGTH+' exceeded. URL: "'+O(a.internal.truncate(n,1E3))+'"',b=a.ERROR_TYPE_URL_LONG,c=g(r,e,b,a.LOG_LEVEL_ERROR,l),n=a.utils.addQueryString(f,c));a.internal.send(n);f=a.console[c.level]||a.console.log;switch(c.level){case a.LOG_LEVEL_CRITICAL:f=a.console.error;break;case a.LOG_LEVEL_WARNING:f=a.console.warn}f("[log]","Data:",e,",","Type:",b,",","Info:",c)}else a.console.warn("[log]","easy.api has not been initialized")}function g(d,
b,c,f,g){d=a.utils.extend({},g,{message:B(b),errorType:c,level:f,url:a.main.getCurrentBrowserData().href||R.href,userAgent:P.userAgent,origin:d,cookieId:a.uid.get(),ver:a.getVersion()});a.CUSTOM_SCRIPT_UPDATED_AT&&(d.customScriptUpdatedAt=a.CUSTOM_SCRIPT_UPDATED_AT);b.name&&(d.name=b.name);b=a.internal.getWorkspaceId();0<b&&(d.workspaceId=b);return d}function d(d){var b={html:[a.utils.isString,B],trace:[a.utils.isString,B],module:[a.utils.isString,B],modules:[a.utils.isString,B],sharedCodeId:[a.utils.isNumeric,
M],messageId:[a.utils.isNumeric,M],revisionId:[a.utils.isNumeric,M],positionId:[a.utils.isNumeric,M],rendererName:[a.utils.isString,B],segmentId:[a.utils.isString,B],templateId:[a.utils.isString,B],triggerId:[a.utils.isNumeric,M],scriptId:[a.utils.isNumeric,M],debug:[a.utils.isString,B]},c=a.guard.current(),f={};a.utils.each(b,function(b,g){var l=void 0!==d[g]?d[g]:c[g];if(void 0!==l){if(!(0,b[0])(l))throw new y('Invalid type for logging "'+g+'" property, got "'+a.utils.getType(l)+'" for "'+l+'"');
f[g]=(0,b[1])(l)}});return f}return{error:function(d,b,c){return f(d,b,a.utils.extend({},c,{level:a.LOG_LEVEL_ERROR}))},info:function(d,b,c){return f(d,b,a.utils.extend({},c,{level:a.LOG_LEVEL_INFO}))},warn:function(d,b,c){return f(d,b,a.utils.extend({},c,{level:a.LOG_LEVEL_WARNING}))},send:f}}();a.evaluator=function(){function f(a){return null===a?null:""===a?"/":"/"!==a?a.replace(/\/$/,""):a}function g(a,b,c){c&&(a=a.toLowerCase(),b=b.toLowerCase());return b&&0<=b.toLowerCase().indexOf(a.toLowerCase())}
function d(a,b,c){var d="";c&&(d+="i");return(new Q(a,d)).test(b)}function e(a){return(a=A[a])?a:!1}function b(a){for(var b in A)if(A.hasOwnProperty(b)&&a===A[b])return b;return!1}function c(b){for(var c,d=0,e=0;e<b.length;e+=1)c=a.utils.getDateFromContextFormat(b[e]),c>=m&&(d+=1);return d}function h(b,c){function d(b){var e=[],g,h;g=c[b.keyType];if(g.hasOwnProperty(b.keyValue))for(f=a.evaluator.getMatcherFunction(b.match),h=g[b.keyValue],g=0;g<h.length;g+=1)e.push(f(b.content,h[g]));else e.push(!1);
return B.or.apply(this,e)}var e=!1,f,e=[],g=[];switch(b[0]){case "and":g=B.and;break;default:return!1}for(var h=1;h<b.length;h+=1)e.push(d(b[h]));return e=g.apply(this,e)}function r(b){if(!a.utils.isArray(b)||0===b.length)throw y("ruleEvaluator expects an array, given:"+b);var c=b[0];b=b.slice(1,b.length);var d=[];if(!B.hasOwnProperty(c)||!a.utils.isFunction(B[c]))throw y("Not a valid evaluate function: "+c);D=c;H=b;for(var e=0;e<b.length;e++)a.utils.isArray(b[e])?d[e]=r(b[e]):d[e]=b[e];return B[c].apply(window,
d)}var n={},l,k,u,w,v,t,z,G,C,N,q,F,m,p,ca,S,fa={},Z,A={matchExact:function(a,b,c){c&&(a=a.toLowerCase(),b=b.toLowerCase());return a.toLowerCase()===b.toLowerCase()},matchPartial:g,matchBegins:function(a,b,c){c&&(a=a.toLowerCase(),b=b.toLowerCase());return b&&0===b.toLowerCase().indexOf(a.toLowerCase())},matchRegex:d,matchContains:function(a,b,c){c&&(a=a.toLowerCase(),b=b.toLowerCase());return b&&0<=b.indexOf(a)}},B={and:function(){for(var a=0;a<arguments.length;a+=1)if(!arguments[a])return!1;return!0},
or:function(){for(var a=0;a<arguments.length;a+=1)if(arguments[a])return!0;return!1},sum:function(){for(var a=0,b=0;b<arguments.length;b+=1)a+=I(arguments[b],10);fa={};return a},gte:function(a,b){return a>=b},lte:function(a,b){return a<=b},gt:function(a,b){return a>b},ly:function(a,b){return a<b},eq:function(a,b){return a==b},not:function(a){return!a},matchReferer:function(b){var c=a.utils.parseUri(b),d=v.host===c.host;d||/^www\./.test(c.host)?d||!/^www\./.test(c.host)||/^www\./.test(v.host)||(d=
"www."+v.host===c.host):d=v.host==="www."+c.host;d&&(p.referer=p.referer||{},p.referer[b]=S);return!d&&p.referer&&p.referer[b]?a.utils.getDateFromContextFormat(p.referer[b])>=m:d},matchLandingpage:function(b){b=t[b];return"undefined"!==typeof b?(b=a.utils.getDateFromContextFormat(b),b>=m):!1},pathVisits:function(b){var d;a.config&&a.config.sharedPages&&(d=a.config.sharedPages[b]);if(d){if(fa[d])return 0;fa[d]=1;d=n[d]}else d=l[b];return"undefined"===typeof d||a.utils.isArray(d)?"undefined"===typeof d?
0:c(d):(a.log.error("pathVisits not an array for id:"+b+", typeof:"+typeof d+", stringified:"+x.JSON.stringify(d),a.ERROR_TYPE_ARG_INVALID),0)},inSegment:function(a){return"undefined"!==typeof w[a]},enterSegment:function(b){var c=Z&&Z.enterSegment&&a.utils.inArray(Z.enterSegment,b)?!0:!1;b=q&&q.enter?q.enter[b]:null;return c?!0:b?(b=a.utils.getDateFromContextFormat(b),b>=m):!1},leaveSegment:function(b){var c=Z&&Z.leaveSegment&&a.utils.inArray(Z.leaveSegment,b)?!0:!1;b=q&&q.leave?q.leave[b]:null;return c?
!0:b?(b=a.utils.getDateFromContextFormat(b),b>=m):!1},customAction:function(a,b){var d=C[a],e=0;if(!d)return!1;e=c(d);return e>=b},newUser:function(){return 1===k.length||u>=m},matchRefererUrl:function(c,d){var g=a.utils.parseUri(d),h=b(c)+"|"+d;a.utils.isFunction(c)||(c=e(c));g.path=f(g.path);v.path=f(v.path);if(g=c(g.host+"/"+g.path,v.host+"/"+v.path))p.refererUrl=p.refererUrl||{},p.refererUrl[h]=S;else if(p.refererUrl&&p.refererUrl[h])return a.utils.getDateFromContextFormat(p.refererUrl[h])>=m;
return g},matchForm:function(b,c){a.utils.isFunction(b)||(b=e(b));return a.evaluateEvents.matchEvent("forms",Z,b,c,p,S,m)},matchLink:function(b,c){a.utils.isFunction(b)||(b=e(b));return a.evaluateEvents.matchEvent("links",Z,b,c,p,S,m)},matchSearchengine:function(b,c){var d=!1,e=!1,f=[],h,t=b+"|"+c;if(v.queryVariables){switch(b){case "bing":d="bing.com";h="q";break;case "yahoo":d="yahoo.com";h="p";break;case "askcom":d="ask.com";h="q";break;case "google":d="google.";h="q";break;default:return!1}v.queryVariables[h]&&
(f=da(v.queryVariables[h]).split(/\+| |%20/));d=d&&g(d,v.host);if(""!==c)for(c=c.split(","),h=0;h<f.length;h+=1)for(var z=0;z<c.length;z+=1){if(f[h]===c[z]){e=!0;break}}else e=!0;e=d&&e}else e=!1;e?(p.searchEngine=p.searchEngine||{},p.searchEngine[t]=S):p.searchEngine&&p.searchEngine[t]&&(e=a.utils.getDateFromContextFormat(p.searchEngine[t])>=m);return e},matchMetaRules:h,matchMetaTag:function(b,c){function d(a){a===c[e]&&(g=!0)}var e,f=b+"|"+c,g=!1,h=!1;if(!c)return!1;c=c.split(",");if("keyword"===
b&&z.keywords&&0<z.keywords.length){"object"!==typeof c&&(c=[c]);for(e=0;e<c.length;e+=1)a.utils.each(z.keywords,d);h=g}else if("description"===b&&z.description)for(h=!0,e=0;e<c.length;e+=1){if(-1===z.description.indexOf(c[e])){h=!1;break}}else if("ogtitle"===b&&z.ogtitle)for(h=!0,e=0;e<c.length;e+=1){if(-1===z.ogtitle.indexOf(c[e])){h=!1;break}}else if("ogdescription"===b&&z.ogdescription)for(h=!0,e=0;e<c.length;e+=1)if(-1===z.ogdescription.indexOf(c[e])){h=!1;break}h?(p.metaData=p.metaData||{},
p.metaData[f]=S):p.metaData&&p.metaData[f]&&(h=a.utils.getDateFromContextFormat(p.metaData[f])>=m);return h},matchCountry:function(b){var c=""!==b&&b===G.country;c?(p.country=p.country||{},p.country[b]=S):p.country&&p.country[b]&&(c=a.utils.getDateFromContextFormat(p.country[b])>=m);return c},matchDevice:function(b){var c=a.utils.isDevice(b);c?(p.device=p.device||{},p.device[b]=S):p.device&&p.device[b]&&(c=a.utils.getDateFromContextFormat(p.device[b])>=m);return c},parse:function(b){switch(b.method){case "conversion":var d=
b.conversionType;(b=b.conversionId)&&(d=a.visitsHistory.getConversionIdKey(d,b));return 1<=c(N[d]||[])?!0:!1;default:return!1}},siteVisitCount:function(){return c(k)},metaCount:function(a){return F.hasOwnProperty(a)?c(F[a]):0}},D=null,H=null;return{evaluate:function(b,c,d){"undefined"===typeof d&&(d=0);m=new E(ca.toString());m.setDate(m.getDate()-d);m.setHours(0);m.setMinutes(0);m.setSeconds(0);S=a.utils.getDateInContextFormat(ca);fa={};try{return Z=c,r(b)}catch(e){if(a.isDev())throw e;a.log.error(e,
a.ERROR_TYPE_EXCEPTION,{debug:"Last fn: "+D+", last part: "+x.JSON.stringify(H)+", rule: "+x.JSON.stringify(b)});return null}},setContext:function(a){l=a.pageVisits;k=a.siteVisits;w=a.segments;v=a.referer;t=a.landingPages;F=a.metaCount;z=a.metaData;G=a.country;u=new E(a.firstVisit);C=a.customActions;N=a.conversions;q=a.segmentEvents;ca=a.evaluationTime;p=a.evaluatedEvents||{}},setSharedContext:function(a){n=a.pageVisits||{}},getContext:function(){return{evaluatedEvents:p}},matchUrl:function(b,c,g,
h,t){var z=null,v;a.utils.isFunction(b)||(b=e(b));if(b===d){if(!b(c,t.path))return!1}else if(c=a.utils.parseUri(c),c.path=f(c.path),t.path=f(t.path),!b(c.path,t.path))return!1;for(z in g)if(g.hasOwnProperty(z)&&(b=e(g[z][0]),c=g[z][1].toString(),v=t.params[z],"undefined"===typeof v||!b(c,v,!0)))return!1;return h.anchor&&(g=e(h.matcher),!g(h.anchor,t.anchor))?!1:!0},matchMetaRules:h,getMatcherFunction:e,getMatcherName:b,canonizePathSlashes:f}}();a.evaluateEvents=function(){return{matchEvent:function(f,
g,d,e,b,c,h){var r=a.evaluator.getMatcherName(d)+"|"+e;g[f]&&g[f][0]&&a.utils.matchStringUrls(d,e,g[f][0])&&(b[f]=b[f]||{},b[f][r]=c);return b[f]&&b[f][r]?a.utils.getDateFromContextFormat(b[f][r])>=h:!1}}}();(function(){function f(d,e,b){return a.runGuarded(d,[e],a.utils.extend({},b._logOptions,{context:b,errorReturn:null}))}function g(a){try{return x.JSON.stringify(a)}catch(e){}return""}a.baseEvaluator=function(){this._isTraceEnabled=a.console.isEnabled();this._logOptions=void 0;this._clearTrace();
this.values={document:function(){return A},location:function(){return a.main.getCurrentBrowserData().href},referrer:function(){return a.main.getCurrentBrowserData().referer},segments:function(){return a.context.segments}}};a.baseEvaluator.prototype.evaluatorFunctions={and:function(){return a.utils.every(arguments,function(a){return a})},or:function(){return a.utils.some(arguments,function(a){return a})},"+":function(){return a.utils.reduce(arguments,function(a,e){return a+L(e)},0)},">=":function(a,
e){return L(a)>=L(e)},"<=":function(a,e){return L(a)<=L(e)},">":function(a,e){return L(a)>L(e)},"<":function(a,e){return L(a)<L(e)},"eq?":function(a,e){return!0===a&&"true"===e||!1===a&&"false"===e||"true"===a&&!0===e||"false"===a&&!1===e?!0:a==e},"eq??":function(a,e){return a===e},not:function(a){return!a},begins:function(d,e){return a.utils.isString(d)&&0===d.indexOf(e)},contains:function(d,e){return a.utils.isString(d)&&-1<d.indexOf(e)},ends:function(d,e){return a.utils.isString(d)&&a.utils.isString(e)&&
-1!==d.indexOf(e,d.length-e.length)},in:function(d,e){return a.utils.inArray(e,d)},"regex?":function(d,e,b){a.utils.isNil(d)&&(d="");return(new Q(e,b)).test(d)},array:function(){return a.utils.arrayFrom(arguments)},location:function(a,e){return this._url(this.getEvaluatorValue("location"),a,e)},referrer:function(a,e){return this._url(this.getEvaluatorValue("referrer"),a,e)},url:function(){return this._url.apply(this,arguments)},domelem:function(d,e){var b=this.getEvaluatorValue("document"),b=a.domElements.selector(d,
b)[0];if(!b)return null;if(!e)return b;var c=/^attr:/,f=/^prop:/;return"html"===e?b.innerHTML:"text"===e?b.textContent||b.innerText||null:f.test(e)?(c=e.replace(f,""),c in b?b[c]:null):c.test(e)?b.getAttribute(e.replace(c,"")):b.getAttribute(e)||b[e]},cookie:function(d){return a.cookies.get(d)},localstorage:function(a){return na.getItem(a)},js_var:function(d){return a.utils.getByDotString(d,window,{empty:!1,nonObjects:!1,self:!1})},pluck:function(d,e){return a.utils.reduce(e,function(b,c){return a.utils.isNil(b)?
void 0:b[c]},d)},js:function(d){a.__evaluatorScope__=this;d=d.replace(/\{\{(.+)\}\}/g,'easy.__evaluatorScope__.getEvaluatorValue("$1")');d=a.internal.eval(d,{easy:x.easy,site:x.site});a.__evaluatorScope__=null;return d},var:function(a){return this.getEvaluatorValue(a)},inSegment:function(a){return void 0!==this.getEvaluatorValue("segments")[a]}};a.baseEvaluator.prototype.evaluate=function(d){this._clearTrace();if(!a.utils.isArray(d))throw new y('Invalid type for evaluator "rules" argument, got "'+
a.utils.getType(d)+'"');return 0===d.length?!0:f(function(){return this._ruleEvaluator(d)},d,this)};a.baseEvaluator.prototype.addEvaluatorFunction=function(d,e){a.utils.isFunction(e)?this.evaluatorFunctions[d]=e:a.log.error('Invalid type for evaluator "fn" argument, got "'+a.utils.getType(e)+'" for "'+d+'"',a.ERROR_TYPE_ARG_INVALID)};a.baseEvaluator.prototype.getEvaluatorValue=function(d){if(!this.values.hasOwnProperty(d))return null;d=this.values[d];return a.utils.isFunction(d)?d.call(this):d};a.baseEvaluator.prototype.removeEvaluatorValue=
function(a){delete this.values[a]};a.baseEvaluator.prototype.setEvaluatorValue=function(d,e){this.values[d]=a.utils.isFunction(e)?e:function(){return e}};a.baseEvaluator.prototype._ruleEvaluator=function(d){if(!a.utils.isArray(d)||0===d.length)throw new y('Invalid type for evaluator "rules" argument, got "'+a.utils.getType(d)+'"');this._isTraceEnabled&&this._addRulesTrace(d);var e=d[0];if(!this.evaluatorFunctions.hasOwnProperty(e)||!a.utils.isFunction(this.evaluatorFunctions[e]))throw new y('Invalid evaluator function type, got "'+
a.utils.getType(e)+'" for "'+e+'"');var b=d.slice(1),c=a.utils.reduce(b,function(b,c,d){a.utils.isArray(c)?b[d]=this._ruleEvaluator(c):b[d]=c;return b},[],this);return f(function(){var a=this.evaluatorFunctions[e].apply(this,c);this._isTraceEnabled&&this._addResultTrace(e,c,a);return a},d,this)};a.baseEvaluator.prototype._url=function(d,e,b){if(!a.utils.inArray("anchor host href path protocol query".split(" "),e))return"";var c=a.utils.parseUri(d);switch(e){case "href":return d;case "query":return b?
c.queryKey[b]:c.query;default:return c[e]}};a.baseEvaluator.prototype.setErrorOptions=function(a){this._logOptions=a};a.baseEvaluator.prototype.getTrace=function(){return a.utils.clone(this._trace)};a.baseEvaluator.prototype.printTrace=function(d){if(this._isTraceEnabled&&a.console.isActiveLevel(a.LOG_LEVEL_DEBUG)){a.console.groupCollapsed('Start [baseEvaluator]: "'+d+'"');a.console.debug("[baseEvaluator]",'Start [baseEvaluator]: "'+d+'" trace ----------------');var e=this.getTrace();a.utils.each(e,
function(b){a.console.debug("[baseEvaluator]",d,"Trace: "+b.text,"Count: "+b.count,"Depth: "+b.depth)});a.console.debug("[baseEvaluator]",'---------------- End [baseEvaluator]: "'+d+'" trace');a.console.groupEnd()}};a.baseEvaluator.prototype._addTrace=function(a){this._trace.push({count:this._count,depth:this._depth,text:a})};a.baseEvaluator.prototype._addRulesTrace=function(a){this._count+=1;this._depth+=1;this._addTrace(g(a))};a.baseEvaluator.prototype._addResultTrace=function(a,e,b){e=g(e).replace(/(^\[|\]$)/g,
"");this._addTrace('["'+a+'",'+e+"] = "+g(b));--this._depth};a.baseEvaluator.prototype._clearTrace=function(){this._depth=this._count=0;this._trace=[]}})();a.triggers=function(){function f(b){return a.utils.extend({eventName:b.type},b)}function g(c){switch(c.type){case a.EVENT_DOM_EVENT:return c.type+", "+c.eventName+", "+c.selector;case a.EVENT_DOM_WAIT:return c.type+", "+c.selector+", "+B(b(c.timeout));case a.EVENT_EASY_EVENT:return c.type+", "+c.eventName;case a.EVENT_JSVAR_WAIT:return c.type+
", "+c.js_var+", "+B(b(c.timeout));default:return c.type}}function d(b,c){return a.utils.filter(v,function(d){return g(d.on_event)===g(b)&&a.triggers.evaluateTrigger(d,c)})}function e(b){switch(b.eventName){case a.EVENT_MESSAGE_SHOW:case a.EVENT_MESSAGE_CLICK:case a.EVENT_MESSAGE_TRUE_DISPLAY:return t.message;case a.EVENT_CUSTOMACTION:return t.customAction;case a.EVENT_PRODUCT_PURCHASE:return t.productPurchase;case a.EVENT_CONVERSION:return t.conversion;case a.EVENT_LOCATION:return t.location;case a.EVENT_VISIT:break;
default:return t.firstArg}}function b(a){a=1E3*I(a,10);return 0<=a?a:0}function c(b,c,d){return a.guard(function(){var c=d?d.apply(null,arguments):void 0;a.triggers.fireEvent(b,c)},{html:"Trigger event: "+c})}function h(d){var h=d.on_event,v=g(h);if(!w[v])switch(h.type){case a.EVENT_DOM_EVENT:if(!a.utils.inArray(["click","keypress","keydown","keyup","submit"],h.eventName))throw new y("Invalid trigger DOM event for "+d.id+', got "'+h.eventName+'"');d=c(h,v,t.eventElement);a.domEvents.on(A,h.eventName,
h.selector,d);l(h,v,d);break;case a.EVENT_DOM_WAIT:d=c(h,v,t.firstElement);var u=a.domElements.waitFor({selector:h.selector,timeout:b(h.timeout),success:d});u.catch(K.bind(k,null,h,v,u));l(h,v,d,u);break;case a.EVENT_EASY_EVENT:r(h,v,e(h));break;case a.EVENT_JSVAR_WAIT:n(h,v);break;case a.EVENT_SCRIPT_LOAD:case a.EVENT_EASY_READY:case a.EVENT_DOM_READY:r(f(h),v,t.empty);break;case a.EVENT_DATALAYER:r(f(h),v,t.firstArg);break;case a.EVENT_URL_CHANGED:r(f(h),v,t.urlChanged);break;default:throw new y("Invalid trigger event for "+
d.id+', got "'+h.type+'"');}}function r(b,d,e){e=c(b,d,e);a.events.on(b.eventName,e);l(b,d,e)}function n(d,e){var f=c(d,e),g=a.utils.waitFor(100,b(d.timeout),function(){return void 0!==a.utils.getByDotString(d.js_var,window,{empty:!1,nonObjects:!1,self:!1})});g.then(f).catch(K.bind(k,null,d,e,g));l(d,e,f,g)}function l(b,c,d,e){b=a.utils.clone(b);b.fn=d;b.options=e;w[c]=b}function k(b,c,d,e){var f=a.utils.filter(v,function(a){return c===g(a.on_event)}),f=a.utils.map(f,function(a){return a.id}),h=", trigger ids: "+
f.join(",");d.isCancelled()?a.console.info(a.MODULE_TRIGGER,'Trigger event "'+c+'" was cancelled'+h,b,e):a.console.warn(a.MODULE_TRIGGER,'An error occurred with the trigger event "'+c+'"'+h,b,e);a.debug.addEntry("errors_trigger_events",{error:e,triggerIds:f})}var u,w={},v,t={empty:function(){return{}},conversion:function(b){return a.utils.clone(b)},eventElement:function(a,b){return{element:b}},firstArg:function(a){return a},firstElement:function(a){return{element:a[0]}},urlChanged:function(a,b){return{url:a,
previousUrl:b}},message:function(b){return a.utils.clone(b)},customAction:function(a,b){return{name:a,value:b}},productPurchase:function(b){return a.utils.clone(b)},location:function(b){return a.utils.clone(b)}};return{init:function(b){b&&0!==b.length&&(u=new a.baseEvaluator,v=a.utils.clone(b),a.utils.each(v,a.guard(h,{module:a.MODULE_TRIGGER})))},clear:function(){a.utils.each(w,function(b){switch(b.type){case a.EVENT_DOM_EVENT:a.domEvents.off(A,b.eventName,b.selector,b.fn);break;case a.EVENT_DOM_WAIT:case a.EVENT_JSVAR_WAIT:b.options.cancel();
break;default:a.events.off(b.eventName,b.fn)}});w={};a.events.clearEvent(a.EVENT_TRIGGER_EVENT);a.events.clearEvent(a.EVENT_TRIGGER_FIRE)},evaluateTrigger:function(b,c){if(!u)return a.log.error("Evaluator not initialized",a.ERROR_TYPE_INIT,{tiggerId:b.id}),!1;a.utils.each(c,function(a,b){u.setEvaluatorValue(b,a)});u.setErrorOptions({type:a.ERROR_TYPE_TRIGGER_EXCEPTION,level:a.LOG_LEVEL_ERROR,module:a.MODULE_TRIGGER,triggerId:b.id});var d=u.evaluate(b.rules);a.utils.each(c,function(a,b){u.removeEvaluatorValue(b,
a)});!d&&a.console.isEnabled()&&u.printTrace("easy.triggers - "+b.id);d&&(a.events.trigger(a.EVENT_TRIGGER_FIRE,b,c),b.alias&&a.events.trigger(b.alias,b,c));return d},fireEvent:function(b,c){u&&v?a.events.trigger(a.EVENT_TRIGGER_EVENT,{data:c,event:b,triggers:d(b,c)}):a.log.error("Evaluator or triggers not initialized",a.ERROR_TYPE_INIT)},getEvaluator:function(){return u}}}();a.events=function(){function f(b,c,f,r,n){f=a.guard(c,{context:f});var l={origFn:c,fn:f,handled:!1,type:n};d[b]=d[b]||[];d[b].push(l);
r=a.utils.extend({ignoreTriggered:!1},r);r.ignoreTriggered||a.utils.each(e[b],function(a){g(l,a)})}function g(a,c){a.handled&&"once"===a.type||(a.handled=!0,a.fn.apply(null,c))}var d={},e={};return{clear:function(){d={};e={}},clearEvent:function(a){delete e[a]},getEventDataObject:function(b,c){switch(b){case a.EVENT_CUSTOMACTION:return{name:c[0],value:c[1]};case a.EVENT_STATE_REMOVE:return{name:c[0]};case a.EVENT_STATE_SET:return{name:c[0],value:c[1],type:c[2]};case a.EVENT_ERROR_SENT:return{error:c[0],
code:c[1]};default:return c[0]}},isTriggered:function(a){return D(e[a])},off:function(b,c){var e=a.utils.isFunction(c);d[b]=a.utils.filter(d[b],function(a){return e&&c!==a.origFn})},on:function(a,c,d,e){f(a,c,d,e,"on")},once:function(a,c,d,e){f(a,c,d,e,"once")},trigger:function(b){var c=a.utils.arrayFrom(arguments).slice(1);a.console.info("[events]",b,c);a.debug.addEntry("event",{name:b,args:c});e[b]=e[b]||[];e[b].push(c);a.utils.each(d[b],function(a){g(a,c)})}}}();var aa={previous:void 0,zone:{type:a.ERROR_TYPE_EXCEPTION,
module:a.MODULE_SITE,modules:a.MODULE_SITE}};a.guard=function(f,g){function d(){aa={previous:aa,zone:e};try{return f.apply(g.context||this,arguments)}catch(d){d instanceof y||(d=B(d));if(g.onError)return g.onError(d,e.type,e),g.errorReturn;var b=d.type||e.type,c=a.internal.createLogOptions(d.options,g.level);try{a.log.send(d,B(b),a.utils.extend({level:a.LOG_LEVEL_ERROR},e,c))}catch(n){aa.zone={};var h=B(a.MODULE_SITE);a.log.send(n,"guard_"+a.ERROR_TYPE_ARG_INVALID,{level:B(a.LOG_LEVEL_ERROR),module:h,
modules:h,debug:d+", Type: "+b})}}finally{aa=aa.previous}return g.errorReturn}if(f.hasExceptionHandling)return f;var e=a.utils.extend({},aa.zone);a.utils.isObject(g)?a.utils.each(g,function(a,c){void 0!==a&&(e[c]=a)}):g={};aa.zone.module!==e.module&&(e.modules=aa.zone.modules+" "+e.module);a.utils.isNumber(e.type)||a.utils.isString(e.type)||(e.type=a.ERROR_TYPE_EXCEPTION);delete e.level;delete e.context;delete e.errorReturn;delete e.onError;d.origFn=f;d.hasExceptionHandling=!0;return d};a.guard.current=
function(){return aa.zone};a.runGuarded=function(f,g,d){return a.guard(f,d).apply(null,a.utils.isArray(g)?g:[])};a.uid=function(){function f(){return null!==b}function g(a){e(a,"uid");b=a}function d(b){var d,e=a.utils.find({"bingbot|adidxbot|BingPreview":function(){return"bingbot.00000000"},"Google Web Preview|Googlebot|Mediapartners-Google|AdsBot-Google":function(){return"webpreview.00000000"},HeadlessChrome:function(){return"headless.00000000"},"AdobeAIR/(\\d+(\\.\\d+)*)":function(a){return"adobeair_"+
a[1].replace(/\./g,"")+".00000000"}},function(a,e){return d=b.match(new Q(e))});return e&&d?e(d):void 0}function e(b,d){if(!a.utils.isString(b)||0===b.length)throw new y("Invalid type for "+d+' argument, got "'+a.utils.getType(b)+'" for "'+x.JSON.stringify(b)+'"');}var b=null;return{get:function(){return b},getDecilForUid:function(b){e(b,"uid");b=I(a.md5(b+"randomized decil").substr(0,8),16)/H.pow(2,32);return I(10*b,10)+1},isDefined:f,isInComparisonGroup:function(b){e(b,"uid");return.1>I(a.md5(b).substr(0,
8),16)/H.pow(2,32)},newUid:function(a){e(a,"userAgent");if(!f()){var h;if(!(h=d(a))){h=2166136261;for(var r=0;r<a.length;r++)h+=(h<<1)+(h<<4)+(h<<7)+(h<<8)+(h<<24),h^=a.charCodeAt(r);h=(h&2147483647).toString(36)+"."+E.now().toString(36)}g(h)}return b},set:g,_testResetUID:function(){b=null}}}();a.segmentchange=function(){function f(b){return 1===a.context.segments[b]}function g(){var b=[],c;for(c in a.context.targetgroups)a.context.targetgroups.hasOwnProperty(c)&&b.push(a.context.targetgroups[c]);
0===b.length?a.cookies.remove("frosmo_keywords"):(b="."+b.join("."),a.cookies.set("frosmo_keywords",b,30))}function d(b,c){var d;d=new E;d.setSeconds(d.getSeconds()+3);d=d.valueOf();var e=a.utils.getDateInContextFormat(p);"enter"===c?(a.context.segmentEvents.enter[b]=e,delete a.context.segmentEvents.leave[b]):"leave"===c&&(a.context.segmentEvents.leave[b]=e,delete a.context.segmentEvents.enter[b]);a.context.segmentChanged=d;a.context.save();t()}function e(b,c){C=C||{};N=N||{};C[b]=C[b]||[];N[b]=N[b]||
[];a.utils.inArray(N[b],c)||N[b].push(c);a.utils.inArray(C[b],c)||C[b].push(c)}function b(a,b){var c=[],d=C[a];if(d){for(var e=0;e<d.length;e+=1)d[e]!==b&&c.push(d[e]);C[a]=c}}function c(a,c){var d=q[a];q[a]=c;d!==c&&(0===c?(e("leaveSegment",a),b("enterSegment",a)):1===c&&(e("enterSegment",a),b("leaveSegment",a)),q[a]=c)}function h(b,c){if(f(b))return!1;if(c)a.context.segments[b]=1,a.context.save(),a.context.lastConnectSegments.status&&"queued"!==a.context.lastConnectSegments.status||(a.internal.connectSegments(a.uid.get()),
a.context.lastConnectSegments.status="in_queue",a.context.save()),a.api.setUserSegment(null,b,"value1"),d(b,"enter"),a.events.trigger(a.EVENT_SEGMENT_ENTER,b);else{var e=a.utils.clone(a.context.segments);e[b]=1;l({enterSegment:[b]},new E,e)}return!0}function r(b,c){if(!f(b))return!1;if(c)delete a.context.segments[b],a.context.save(),a.api.setUserSegment(null,b,"value0"),d(b,"leave"),a.events.trigger(a.EVENT_SEGMENT_LEAVE,b);else{var e=a.utils.clone(a.context.segments);e[b]=0;l({leaveSegment:[b]},
new E,e)}return!0}function n(b,c,d){return""===b||null===b||"undefined"===typeof b?!1:a.evaluator.evaluate(b,c,d)}function l(b,c,d){var e={};q=d||a.utils.clone(a.context.segments);N=b;for(d=0;10>d;d+=1){C={};a.segmentchange.evaluateSegments(b,c);a.segmentchange.evaluateSegmentGroups(b);var f=[];a.utils.each(C.enterSegment,function(a){f.push(a)});a.utils.each(C.leaveSegment,function(a){f.push(a)});if(0===f.length)break;a.utils.each(f,function(a){e[a]=e[a]?e[a]+1:1})}10===d&&(b="segmentchange.evaluate(): max evaluation rounds:10 reached\n"+
x.JSON.stringify(e),a.log.error(b,a.ERROR_TYPE_ARG_INVALID,{module:a.MODULE_SEGMENT}),a.console.log("[segmentchange]",b));k(q)&&a.segmentchange.updateTargetGroups();q={};return{evaluationRounds:d,changesBySegment:e}}function k(b){var c=0;a.utils.each(b,function(b,d){var e=a.context.segments.hasOwnProperty(d);0===b&&e?(r(d,!0),c+=1):1!==b||e||(h(d,!0),c+=1)});return c}function u(b,c){var d={},e={},f={};a.utils.each(b,function(a){e[a]=1;d[a]=1});a.utils.each(c,function(a){f[a]=1;d[a]=1});a.utils.each(a.utils.keys(d),
function(b){var c=1===e[b],d=1===f[b];c&&!d?a.events.trigger(a.EVENT_TARGETGROUP_LEAVE,b):!c&&d&&a.events.trigger(a.EVENT_TARGETGROUP_ENTER,b)})}function w(b){u(a.context.targetgroups,b);a.context.targetgroups=b;g();a.campaign.stampUser(new E);a.context.save()}function v(){if(!z&&!a.noAsyncApi){z=!0;var b=a.api.getApiUrl("keywords"),c={origin:a.config.api.origin,cookieId:a.uid.get(),ver:a.getVersion(),ts:E.now()};a.fetch.get(b,{params:c,success:function(b){b&&"ok"===b.status&&(w(b.result.keywords),
b.result.globalId&&b.result.globalId!==a.context.globalId&&(a.context.globalId=b.result.globalId,a.context.save()));z=!1},error:function(){z=!1}})}}function t(b){var c=[3,5,7,10,30,60,120,240];if(!a.noAsyncApi)if(!a.config.targetGroups)w([]);else if(b)v();else if(0!==a.context.segmentChanged){for(b=0;b<G.length;b+=1)X(G[b]);G=[];var d=((new E).getTime()-a.context.segmentChanged)/1E3;for(b=0;b<c.length;b+=1)if(c[b]>=d){var e=a.utils.setTimeout(v,1E3*(c[b]-d));G.push(e)}}}var z=!1,G=[],C={},N={},q=
{},F=[],m,p;return{init:function(a,b){N={};F=a.segments;m=a.segmentGroups||{};p=b},evaluate:l,evaluateSegments:function(b,d){a.context.evaluationTime=d;a.evaluator.setContext(a.context);a.sharedContext&&a.evaluator.setSharedContext(a.sharedContext);for(var e=0;e<F.length;e+=1){var f=F[e],g="sggp_"+f.group;m.hasOwnProperty(g)&&(m[g].rules||(m[g].rules={}),m[g].rules[f.name]=f);b.rule=f;var g=n(f.leave,b,f.timelimit),h=n(f.enter,b,f.timelimit);null!==h&&null!==g&&(h&&g&&(h=!1),q.hasOwnProperty(f.name)?
(g||!h&&f.autoexit)&&c(f.name,0):h&&c(f.name,1))}a.context.evaluatedEvents=a.evaluator.getContext().evaluatedEvents},evaluateSegmentGroups:function(b){function d(b,e,f){function g(a){a=x.JSON.stringify(a);return a=a.replace(/conversionType":"([^"]+)","conversionId":"([^"]+)"/g,function(a,b,c){return'conversionType":"'+b+" "+c+'"'})}function h(b,c){var d=!1,e=g(b.enter),f;for(f in c)if(c.hasOwnProperty(f)){var t=c[f];if(d)break;if(a.utils.isArray(t))for(var v=0;v<t.length;v+=1)if(-1<e.indexOf('"'+
t[v]+'"')){d=!0;break}}return d}var t=[],v=[],w=[],z=[],u;for(u=0;u<b.length;u+=1){var C=b[u];1===q[C]&&h(e[C],f)&&w.push(C);a.context.segments.hasOwnProperty(C)&&1===q[C]?t.push(C):1===q[C]&&v.push(C)}(e=w.pop())||(e=0<t.length?t.pop():v.pop());for(u=0;u<b.length;u+=1)b[u]===e?c(b[u],1):1===q[b[u]]&&(c(b[u],0),z.push(b[u]))}a.utils.each(m,function(a){if("funnel"===a.mode){a=a.segments;var e=-1,f;for(f=0;f<a.length;f+=1)1===q[a[f]]&&(e=f);for(f=0;f<e;f+=1)1===q[a[f]]&&c(a[f],0)}else"radio"===a.mode&&
d(a.segments,a.rules,b)})},expireSegments:function(){var b=!1,c=new E(p);c.setHours(0);c.setMinutes(0);c.setSeconds(0);c.setMilliseconds(0);for(var d=0;d<F.length;d+=1)if(a.context.lastVisit.time&&F[d].timelimit&&F[d].autoexit&&a.context.segmentEvents.enter[F[d].name]){var e=new E(a.context.lastVisit.time);e.setDate(e.getDate()+F[d].timelimit);e.setHours(0);e.setMinutes(0);e.setSeconds(0);e.setMilliseconds(0);e<c&&(delete a.context.segments[F[d].name],b=!0)}b&&a.context.save()},updateKeywordsCookie:g,
updateTargetGroups:t,segmentChanged:d,updateTargetGroup:w,setSegment:h,removeSegment:r,isSegmented:function(){for(var b in a.context.segments)if(a.context.segments.hasOwnProperty(b)&&f(b))return!0;return!1},inSegment:f}}();a.uihooks=function(){function f(b,c){return function(d,e){var f={};f[b]=[e[c]];a.segmentchange.evaluate(f,new E)}}function g(b,c,d){for(var e=0;e<c.length;e++)if(a.utils.matchStringUrls(c[e][0],c[e][1],b)){d();break}}var d=[],e=[];return{initForms:function(b){a.utils.each(a.domElements.selector("form"),
function(c){a.utils.isString(c.action)&&g(c.action,b,function(){a.utils.inArray(d,c)||(a.domEvents.on(c,"submit."+a.DOM_EVENT_NAMESPACE,f("forms","action")),d.push(c))})})},initLinks:function(b){a.utils.each(a.domElements.selector("a"),function(c){g(c.getAttribute("href"),b,function(){a.utils.inArray(e,c)||(a.domEvents.on(c,"mousedown."+a.DOM_EVENT_NAMESPACE,f("links","href")),e.push(c))})})},forms:d,links:e}}();a.main=function(){function f(b,c,d){"success"===u?a.log.warn('initFailure function called, when the state was "success"',
a.ERROR_TYPE_CORE_INIT):(a.events.trigger(a.EVENT_INIT_FAILURE),u="failure",void 0!==b&&a.log.send(b instanceof y?b:B(b),B(c),a.internal.createLogOptions(d)))}function g(b,c){a.utils.isString(b)&&(k.href=b);a.utils.isString(c)&&(k.referer=c)}function d(b,d,e){a.utils.isString(d)||(a.log.error('Invalid "referer" argument, got "'+d+'"',a.ERROR_TYPE_CORE_INIT),d="");a.utils.isString(b.href)||a.log.error('Invalid type for "href" property, got "'+a.utils.getType(b.href)+'"',a.ERROR_TYPE_CORE_INIT);a.utils.isString(b.search)||
a.log.warn('Invalid type for "search" property, got "'+a.utils.getType(b.search)+'"',a.ERROR_TYPE_CORE_INIT);g(b.href,d);n(b,d);c(b,d,l.landingPages);a.campaign.init(l,P.userAgent);a.visitsHistory.addPageVisit(b,l.pages,w,a.guard(function(b){a.segmentchange.evaluate({forms:[],links:[],pageVisits:b||[]},w);a.context.save();a.utils.isFunction(e)&&a.runGuarded(e)}))}function e(){"failure"===u?a.log.warn('_initEnd function called, when the state was "failure"',a.ERROR_TYPE_CORE_INIT):b()}function b(){a.handleCurrentPage();
a.segments.init(l.segmentsV2,l.segmentGroupsV2,l.segmentCountersV2);a.events.trigger(a.EVENT_EASY_READY);a.internal.dispatchEvent("frosmo.ready");a.events.trigger(a.EVENT_INIT_SUCCESS);u="success";a.contextLoader.useServerApi(a.context.userAgent)&&a.utils.setInterval(function(){a.context.save(!0)},1E3)}function c(b,c,d){var e=a.context.referer,f=a.utils.getLocationFromUrl(b.href);c=a.utils.getLocationFromUrl(c);if(c.host===f.host)a.context.referer=c;else if(c.host!==e.host||c.path!==e.path||c.queryVariables!==
e.queryVariables)a.context.referer=c,b.href&&a.utils.each(d,function(b,c){var d=a.evaluator.getMatcherFunction(b[0]);a.evaluator.matchUrl(d,b[1],b[2],{},f)&&(a.context.landingPages[c]=a.utils.getDateInContextFormat(w))}),a.context.landingpage=a.utils.getLocationFromUrl(b.href),a.context.save()}function h(b){var c={name:{},property:{}};a.utils.each(a.domElements.selector("meta",b),function(a){var b=a.getAttribute("name"),d=c.name;b||(b=a.getAttribute("property"),d=c.property);b&&(d[b]=d[b]||[],d[b].push(a.getAttribute("content")))});
var d=[];a.utils.each(l.meta,function(b,e){a.evaluator.matchMetaRules(b,c)&&(a.visitsHistory.addMetaCount(e,w),d.push(e))});0<d.length&&a.segmentchange.evaluate({events:d},w)}function r(){a.utils.isMobile()||a.location.get(function(b){b.country2&&a.context.country.country!==b.country2&&a.segmentchange.evaluate({forms:[],links:[]},w);a.context.country.country=b.country2;a.context.country.latitude=b.latitude;a.context.country.longitude=b.longitude;a.context.country.city=b.city;a.context.country.time=
w.getTime();a.context.save()})}function n(b,c){var d=w.getTime();if(18E5<=d-a.context.lastPageView.time){var e=w,f;f=a.utils.getLocationFromUrl(b.href);var g=a.utils.getLocationFromUrl(c);f=""===c||g.host===f.host?"direct":g.host;a.api.setSessionStartTime(e.getTime());a.segmentchange.expireSegments();"connected"===a.context.lastConnectSegments.status&&a.internal.connectSegments(a.uid.get());a.context.lastVisit.time=e.getTime();a.context.lastVisit.source=f;a.context.referer=a.utils.clone(a.defaultContext.referer);
a.context.landingpage=a.utils.clone(a.defaultContext.landingpage);r();0!==a.context.siteVisits.length||a.context.firstVisit||(a.context.firstVisit=e.toString());a.visitsHistory.addSiteVisit(e);a.context.sessionPathVisits={};a.context.save();a.api.visit(null,f,a.states.get(a.STATE_DEVICE));a.segmentchange.updateTargetGroups(!0);a.events.trigger(a.EVENT_VISIT)}a.context.lastPageView.time=d;a.context.save()}var l=null,k={href:null,referer:null},u,w;return{init:function(b,c,d){a.events.clearEvent(a.EVENT_EASY_READY);
a.events.clearEvent(a.EVENT_INIT_SUCCESS);l=c||{};w=d||new E;a.context=b;a.api.setRequestEnabled(!0);a.sharedContext={};a.context.lastConnectSegments&&(a.api.isConnected=!0);if(void 0===l.segments||null===l.segments)return f("Segments were not found",a.ERROR_TYPE_CORE_INIT,{level:a.LOG_LEVEL_ERROR}),!1;a.api.setSessionStartTime(a.context.lastVisit.time);a.segmentchange.init(l,w);l.customActions&&a.customAction.init(l.customActions);l.conversions&&a.conversion.init(l.conversions);l.googleAnalytics&&
a.googleAnalytics.init(l.googleAnalytics);a.user.init();a.domEvents.ready(function(){a.uihooks.initForms(l.forms);a.uihooks.initLinks(l.links)});a.preview.init();a.segmentchange.updateTargetGroups();if(!l.sharedPages)return e(),!0;a.sharedPagesRpc=new a.xdmLocal({remote:"https://otavamedia.inpref.com/frosmo.xdm.html"});a.sharedPagesRpc.init().then(function(){return a.sharedPagesRpc.get("sharedPages")}).then(function(b){a.sharedContext.pageVisits=a.utils.clone(b);e()}).catch(function(b){a.log.send(b,
"shared_pages_"+(b.type||a.ERROR_TYPE_CONTEXT_INIT),a.internal.createLogOptions(b&&b.options))});return!0},VISIT_TIMEOUT:18E5,getCurrentBrowserData:function(){return a.utils.clone(k)},getState:function(){return u},initFailure:f,initStart:function(){a.events.trigger(a.EVENT_INIT_START);u="initializing"},setCurrentBrowserData:g,updateBrowserData:function(b,c,e,f){e=e||b.location;f=f||b.document.referrer;a.context.userAgent=b.navigator.userAgent||a.context.userAgent;h(b.document.head);d(e,f,c);a.events.isTriggered(a.EVENT_EASY_READY)&&
a.messageTrueDisplay.clear();a.context.save()},updateLocation:d}}();a.internal=function(){function f(d){if(!(d instanceof a.Promise))throw new y('Invalid type for "promise" argument, got "'+a.utils.getType(d)+'"');return d._hasRejectionHandler||a.utils.some(d._chains,function(a){return f(a.promise)})}var g=0;return{connectSegments:function(d){a.api.connectSegments(d)},createLogError:function(a,e,b){var c=a instanceof y?a:new y(a);c.type=a.type?a.type:e;c.options=a.options?a.options:b;return c},createLogOptions:function(d,
e){d&&d.level&&a.utils.isString(d.level)||(d=d||{},d.level=e&&a.utils.isString(e)?e:a.LOG_LEVEL_ERROR);return d},debug:function(d){d=a.utils.parseUri(d).queryKey;"on"===d.frosmodebug?a.console.setEnabled(!0):"off"===d.frosmodebug&&a.console.setEnabled(!1);d.frosmodebuglevel&&a.console.setLevel(d.frosmodebuglevel)},dispatchEvent:function(a){try{var e=new va(a);window.dispatchEvent(e)}catch(b){}},eval:function(d,e){var b=a.utils.map(e,function(a,b){return b+" = this."+b}).join(",");return function(){return eval((b?
"var "+b+";\n":"")+d)}.call(e)},getCurrentModule:function(d){var e=a.guard.current().module;return!0!==d&&e===a.MODULE_CORE?a.MODULE_SITE:e},getProfile:function(){return a.profile?a.profile.get?a.profile.get():a.context?a.context.profile:void 0:void 0},getSegmentIds:function(d){var e=[];a.utils.each(d,function(a,c){1===a&&e.push(c)});return e.join(".").replace(/sgmt_/g,"")},getWorkspaceId:function(){if(!a.workspaces)return 0;var d=a.workspaces.getId();return 0<d?d:0},hasRejectionHandler:f,isMessage:function(d){return D(d)&&
a.utils.every(["id","revision","revisionType"],function(a){return void 0!==d[a]})},safeEval:function(d,e,b){b=0<=b?b:0;a.isDev()&&(d='\n"use strict";\n'+d);e.scriptNamespace&&(d+="\n//# sourceURL="+e.scriptNamespace+"_"+b);var c=a.utils.extend({},e.guardOptions,{level:a.LOG_LEVEL_CRITICAL,scriptId:b});return a.runGuarded(function(){var c=a.utils.keys(e.args);c.push(d);var c=ma.apply(null,c),f=a.utils.values(e.args),g=a.utils.extend({},e.guardOptions,{scriptId:b});return a.runGuarded(c,f,g)},void 0,
c)},send:function(d,e){a.debug.addEntry("send_api",{url:d,method:"IMAGE"});var b=new xa;b.src=e?d:d+"&"+g++;return b},sendBeacon:function(d,e){d.length>a.MAXIMUM_URL_LENGTH&&a.log.warn("URL limit of "+a.MAXIMUM_URL_LENGTH+' exceeded. URL: "'+O(a.internal.truncate(d,300))+'"',a.ERROR_TYPE_URL_LONG,{module:"[internal]"});a.utils.isFunction(P.sendBeacon)?(a.debug.addEntry("send_api",{url:d,method:"BEACON"}),P.sendBeacon(e?d:d+"&"+g++)?a.console.info("[internal]",'Queued Beacon API call "'+d+'"'):a.log.error("Skipped Beacon API call",
a.ERROR_TYPE_QUEUE_LONG,{module:"[internal]",debug:O(a.internal.truncate(d,300))})):a.internal.send(d,e)},states:function(d){var e;a.utils.isMobile()?e="mobile":a.utils.isTablet()?e="tablet":a.utils.isDesktop()&&(e="desktop");a.states.set(a.STATE_DEVICE,e);d=a.utils.parseUri(d).queryKey.frosmotest;"on"===d?a.states.set(a.STATE_MODE,a.STATE_MODE_TEST,a.STATE_TYPE_SESSION):"off"===d&&a.states.remove(a.STATE_MODE)},truncate:function(a,e){a=B(a);return a.length>e?a.substr(0,e)+"...{"+(a.length-e)+"}":
a}}}();a.api=function(){function f(b){b=b||new E;var c=r?b.getTime()-r.getTime():0;return a.utils.pad(b.getUTCDate(),0,2)+a.utils.pad(b.getUTCHours(),0,2)+a.utils.pad(b.getUTCMinutes(),0,2)+c}function g(){return r?r.getUTCFullYear()+a.utils.pad(r.getUTCMonth()+1,0,2)+a.utils.pad(r.getUTCDate(),0,2)+a.utils.pad(r.getUTCHours(),0,2)+a.utils.pad(r.getUTCMinutes(),0,2)+a.utils.pad(r.getUTCSeconds(),0,2):""}function d(a){return b&&n[a]?"https:"+b.replace(/^https?:?/,"")+n[a]:null}function e(b){var d={cookieId:a.uid.get(),
origin:c,ver:a.getVersion()};if("optimizer"===b||"tracking"===b)d.segments=a.context?a.internal.getSegmentIds(a.context.segments):"";return d}var b,c,h=!1,r=null,n={contextApi:"contextApi",error:"errorApi",event:"eventsApi",keywords:"keywordsApi",location:"location",message:"messageApi",optimizer:"optimizerApi",pageload:"pageloadApi",preview:"previewDataApi",product:"productApi",reco:"recoApi",segment:"segmentApi",tracking:"trackingApi"},l=function(b,c){var f=a.utils.reduce(c,function(b,c,d){a.utils.isObject(c)?
b=a.utils.extend(b,c):b[d]=c;return b},{});a.utils.each(f,function(a,b){!1===a||null===a||void 0===a?f[b]="":!0===a&&(f[b]="1")});a.utils.extend(f,e(b));return a.utils.addQueryString(d(b),f)},k=function(b,c,d){if(b){if(!h)throw new y('API called before context initialized for "'+b+'"');c=f();b=b+"&"+c;switch(d){case "optimizer":a.internal.sendBeacon(b,!0);break;case "segment":a.internal.sendBeacon(b,!0);a.context.lastConnectSegments.time=E.now();a.context.lastConnectSegments.status="connected";a.context.save();
break;default:a.internal.send(b,!0),a.log.error('Deprecated using "easy.internal.send" for API calls, use "easy.internal.sendBeacon" i.e. Beacon API',a.ERROR_TYPE_DEPRECATED+".removed",{debug:B(b),module:a.internal.getCurrentModule()})}}};return{init:function(a,d){b=a;c=d},getOrigin:function(){return c},isInitialized:function(){return void 0!==c&&void 0!==b},setRequestEnabled:function(a){h=D(a)},setSessionStartTime:function(a){r=a?new E(a):null},login:function(a,b){var c=l("optimizer",{event:"login",
userId:a,source:b,sessionStart:g()});k(c,void 0,"optimizer")},buyProduct:function(a,b,c,d,e,f,h,r,q,F){a=l("optimizer",{event:"buyProduct",productType:b,productId:c,netValue:d,fee:e,tax:f,paymentChannel:h,customId:r,transactionId:q,quantity:F,sessionStart:g(),userId:a});k(a,void 0,"optimizer")},transaction:function(a,b,c,d,e){a=l("optimizer",{event:"transaction",conversionType:b,transactionId:c,value:d,products:x.JSON.stringify(e),sessionStart:g(),userId:a});k(a,void 0,"optimizer")},showMessage:function(a,
b,c){a=l("optimizer",{event:"showMessage",userId:a,messageId:b,revision:c,sessionStart:g()});k(a,void 0,"optimizer")},clickMessage:function(a,b,c){a=l("optimizer",{event:"clickMessage",userId:a,messageId:b,revision:c,sessionStart:g()});k(a,void 0,"optimizer")},trueDisplay:function(a,b,c){a=l("optimizer",{event:"trueDisplay",userId:a,messageId:b,revision:c,sessionStart:g()});k(a,void 0,"optimizer")},visit:function(a,b,c){a=l("optimizer",{event:"visit",userId:a,source:b,device:c,sessionStart:g()});
k(a,void 0,"optimizer")},setProductData:function(a,b,c){a=l("optimizer",{event:"setProductData",productId:a,userId:c,productAttributes:b,sessionStart:g()});k(a,void 0,"optimizer")},setProductDataPayload:function(a,b){var c=l("optimizer",{event:"setProductData",userId:b,payload:x.JSON.stringify(a),sessionStart:g()});k(c,void 0,"optimizer")},setConversionData:function(a,b,c){b.productConversion=1;a=l("optimizer",{event:"setProductData",productId:a,userId:c,productAttributes:b,sessionStart:g()});k(a,
void 0,"optimizer")},setUserSegment:function(a,b,c){a=l("optimizer",{event:"setUserSegment",userId:a,segmentName:b,segmentValue:c,sessionStart:g()});k(a,void 0,"optimizer")},custom:function(b){a.utils.extend(b,e("optimizer"),{event:"custom",sessionStart:g()});b=l("optimizer",b);k(b,void 0,"optimizer")},connectSegments:function(a){a=d("segment")+"?origin="+c+"&cookieId="+a;k(a,void 0,"segment")},sendCustomAction:function(b,c,d){b=l("event",{method:"customAction",name:b,value:c,title:d});a.internal.sendBeacon(b,
!1)},getCallUrl:l,getApiUrl:d,getSessionStart:g,getCallId:f,_testSetGetUrl:function(a){var b=l;l=a;return b},_testSetCallUrl:function(a){var b=k;k=a;return b}}}();a.contextLoader=function(){function f(b,c){var d=a.defaultContext.clone();if(!b)return a.utils.extend(d,{origin:c.api.origin});b=a.utils.extend(d,b);b=a.convert.convert(b);b.origin||(b.origin=c.api.origin);return b}function g(b,d,e){function g(){b.getContext(function(b){a.events.trigger(a.EVENT_INIT_CONTEXT,f(b,d))},c)}b.getUid(function(d){d?
(a.uid.set(d),g()):(d=a.uid.newUid(e),b.setUid(d,g,c),a.events.trigger(a.EVENT_UID_CREATED,d));a.events.trigger(a.EVENT_INIT_UID,d)},c)}function d(d){a.events.trigger(a.EVENT_XDM_REQUEST);var f=d.api.origin.replace(/_/g,""),f=d.api.domain.replace("//","https://"+f+"."),g=d.xdmUrl||f+"frosmo.xdm.html";return e(g).then(function(a){return d.xdmPreviousUrl&&d.xdmPreviousUrl!==g?b(a,d.xdmPreviousUrl,g):a}).then(function(b){a.sharedContextRpc=b;a.events.trigger(a.EVENT_XDM_READY)}).catch(c)}function e(b){return(new a.xdmLocal({remote:b,
timeout:a.XDM_INIT_TIMEOUT})).init()}function b(b,c,d){var f;return b.get("UID").then(function(g){if(g)return b;a.console.info("[contextLoader]",'Started migrating the UID and context from "'+c+'" to "'+d+'"');return e(c).then(function(a){f=a}).then(function(){return f.get("UID")}).then(function(a){if(!a)throw new y("Previous UID not set");return b.set("UID",a)}).then(function(){return f.get("context")}).then(function(a){if(!a)throw new y("Previous context not set");return b.set("context",a)}).then(function(){a.console.info("[contextLoader]",
'Successfully migrated the UID and context from "'+c+'" to "'+d+'"');return b}).catch(function(c){a.console.warn("[contextLoader]",c);return b})})}function c(b){b||(b="Unexpected error with initializing context (default)");switch(b.type){case "context_"+a.ERROR_TYPE_ARG_INVALID:b.type="context_init_"+a.ERROR_TYPE_ARG_INVALID;break;case "context_"+a.ERROR_TYPE_AJAX_TIMEOUT:b.type=a.ERROR_TYPE_CONTEXT_INIT_TIMEOUT;break;case "context_"+a.ERROR_TYPE_STORAGE_EXCEPTION:b.type=a.ERROR_TYPE_CONTEXT_INIT_STORAGE,
b.options=b.options||{},b.options.level=a.LOG_LEVEL_WARNING,b.options.module=a.MODULE_CORE}a.main.initFailure(b,b.type||a.ERROR_TYPE_CONTEXT_INIT,b.options)}function h(b){var c=P.vendor&&-1<P.vendor.indexOf("Apple");b=/(ipad|iphone|ipod)/i.test(b||k);return(c||b)&&a.config.contextApi}function r(b,c){b=a.internal.createLogError(b,"context_"+b.type);a.utils.isFunction(c)&&c(b);throw b;}function n(b){return function(c,d,e,f){c=a.internal.createLogError(e.text,"context_"+e.type,{level:e.type===a.ERROR_TYPE_AJAX_TIMEOUT?
a.LOG_LEVEL_WARNING:a.LOG_LEVEL_ERROR,debug:f});a.utils.isFunction(b)&&b(c)}}var l,k="",u={getUid:function(b){b(a.store.get("UID"))},setUid:function(b,c,d){try{a.store.set("UID",b),a.utils.isFunction(c)&&c()}catch(e){r(e,d)}},getContext:function(b){b(a.store.get("context"))},setContext:function(b,c,d){try{a.store.set("context",b),a.utils.isFunction(c)&&c()}catch(e){r(e,d)}}},w={getUid:function(b){b(a.cookies.get("frosmo_uid"))},setUid:function(b,c){a.cookies.set("frosmo_uid",b,365);a.utils.isFunction(c)&&
c()},getContext:function(b,c){if(!a.uid.get())throw new y("UID not set");a.contextApi.get("context",b,n(c))},setContext:function(b,c,d){if(!a.uid.get())throw new y("UID not set");a.contextApi.set("context",b,c,n(d))}},v={getUid:function(b,c){a.sharedContextRpc.get("UID").then(b).catch(c)},setUid:function(b,c,d){a.sharedContextRpc.set("UID",b).then(c).catch(d)},getContext:function(b,c){a.sharedContextRpc.get("context").then(b).catch(c)},setContext:function(b,c,d){a.sharedContextRpc.set("context",b).then(c).catch(d)}};
return{init:function(b,c){k=c;a.events.isTriggered(a.EVENT_INIT_CONTEXT)?a.main.initFailure("Context has already initialized",a.ERROR_TYPE_CONTEXT_INIT,{level:a.LOG_LEVEL_ERROR}):b.sharedContext&&h(c)?(l=a.CONTEXT_TYPE_SERVER,a.convert.toSharedContext(w,function(){g(w,b,c)}),a.events.once(a.EVENT_VISIT,function(){w.getUid(function(a){w.setUid(a)})})):b.sharedContext?(l=a.CONTEXT_TYPE_XDM,d(b).then(function(){a.convert.toSharedContext(v,function(){g(v,b,c)})})):(l=a.CONTEXT_TYPE_STORAGE,g(u,b,c))},
getContextAccessor:function(){return a.config.sharedContext?h()?w:v:u},getType:function(){return l},getValidContext:f,initUidAndContext:g,useServerApi:h,_testSetUserAgent:function(a){k=a}}}();a.checkRequirements=function(f){return a.utils.isString(f)&&0!==f.length?-1!==a.utils.getIEVersion(f)?(a.console.error("[checkRequirements]","Unsupported browser"),!1):a.store.check()?a.cookies.isEnabled()&&!a.cookies.check()?(a.log.info("cookies not accessible",a.ERROR_TYPE_STORAGE_MISSING),!1):!0:(a.log.info("localStorage not found",
a.ERROR_TYPE_STORAGE_MISSING),!1):(a.log.info('Invalid "userAgent" argument, got "'+f+'"',a.ERROR_TYPE_ARG_INVALID),!1)};a.preview=function(){function f(){if(a.domElements.selector("#frosmo-debug")[0])a.console.warn("[preview]",'Frosmo Preview iFrame "#frosmo-debug" already exists in the DOM');else{var c=A.createElement("iframe");c.id="frosmo-debug";c.src="about:blank";c.style.display="none";c.onload=function(){b=!0;var d;(d=a.store.get("frosmo_preview_base_url"))?(d=a.utils.parseUri(d),d=d.host?
"//"+d.host+d.path:a.config.baseUrl):d=a.config.baseUrl;var e=A.createElement("script");e.src=d+"preview/PreviewApp.js?ts="+(new E).toISOString().slice(0,13).replace(/[T-]+/g,"");c.contentDocument.head.appendChild(e);c.contentWindow.baseURL=d;c.contentWindow.frosmo=x;a.cookies.set("frosmo_preview_tool",1);a.events.trigger(a.EVENT_PREVIEW_TOOL_ENABLE)};a.domElements.waitFor({selector:"body",timeout:2E4}).then(function(){A.body.appendChild(c)}).catch(function(b){a.console.warn("[preview]",b)})}}function g(b){var d=
b.split(":");if(3===d.length&&a.utils.every(d,a.utils.isPositiveInteger))return{positionId:M(d[0]),messageId:M(d[1]),revisionId:M(d[2])};a.console.error("[preview]",'Invalid preview params string, for "'+b+'"')}function d(b,d){return a.utils.addQueryString(a.api.getApiUrl(b),a.utils.extend({origin:a.config.api.origin,ws:a.internal.getWorkspaceId(),ts:E.now()},d)).replace(/^([a-z]{3,5}:)?\/\//,"https://admin.")}function e(b,e){return new a.Promise(function(f,g){var l=d(b,e);a._jsonp.request(l,function(b){if(b.error){switch(b.error){case "Not logged in":case "Invalid site":b=
a.internal.createLogError('Select the site origin "'+a.config.api.origin+'" in the Frosmo Platform, to allow previewing',a.ERROR_TYPE_INIT,b);break;case "Revision not found":var c=a.utils.parseUri(l);b=a.internal.createLogError('Invalid previewing "revision id" of "'+c.queryKey.revisionId+'"',a.ERROR_TYPE_ARG_INVALID,b);break;default:b=a.internal.createLogError(b.error,a.ERROR_TYPE_EXCEPTION,b)}g(b)}else f(b)})})}var b=!1;return{init:function(){var b=a.utils.parseUri(a.main.getCurrentBrowserData().href);
("on"===b.queryKey.frosmo_preview_tool||b.anchor.match("frosmo_preview_tool=on")||a.cookies.get("frosmo_preview_tool"))&&f()},enable:f,disable:function(){e("preview",{method:"disable"}).finally(function(){b=!1;a.events.trigger(a.EVENT_PREVIEW_TOOL_DISABLE);a.cookies.remove("frosmo_preview_tool");var c=a.domElements.selector("#frosmo-debug")[0];c&&c.parentElement&&c.parentElement.removeChild(c)})},isEnabled:function(){return b},createParams:g,getParams:function(){var b=a.main.getCurrentBrowserData().href,
b=a.utils.parseUri(b);return b.queryKey.frosmo_preview&&a.utils.isString(b.queryKey.frosmo_preview)?g(da(b.queryKey.frosmo_preview)):void 0},requestMessage:function(b){return e("message",a.utils.extend({method:"preview"},b))},requestPreviewData:function(){return e("preview",{method:"previewData",enable:"1"})}}}();a.convert=function(){return{convert:function(f){return!a.versionAtLeast("1.0",f.VERSION)||f.lastVisit&&f.lastVisit.time&&31536E6<E.now()-f.lastVisit.time?a.defaultContext.clone():f},toSharedContext:function(f,
g){function d(){a.store.remove("UID");a.store.remove("context");g()}var e=a.store.get("context"),b=a.store.get("UID");e&&b?e.origin!==a.config.api.origin?g():(a.uid.set(b),f.setUid(b,function(){f.setContext(e,d)})):d()}}}();(function(){var f=0;a.defaultContext={VERSION:"1.0",UID:null,origin:null,firstVisit:null,lastPageView:{time:0},lastVisit:{source:"",time:0},pageVisits:{},siteVisits:[],segments:{},states:{session:{}},referer:{host:null,path:null},landingpage:{host:null,path:null},landingPages:{},
linkClicks:{},lastConnectSegments:{time:0},metaCount:{},metaData:{keywords:null,description:null,ogtitle:null,ogdescription:null},country:{country:"",country2:"",latitude:0,longitude:0,city:"",time:0},targetgroups:[],userAgent:"",segmentChanged:0,lastRuleActions:{},site:{},counts:{},removeFunctions:function(a){delete a.save;delete a.clone;delete a.removeFunctions;delete a.addFunctions},addFunctions:function(a){a.save=this.save;a.clone=this.clone;a.removeFunctions=this.removeFunctions;a.addFunctions=
this.addFunctions},save:function(g,d,e){d=a.utils.isFunction(d)?d:function(){};if(a.contextLoader.useServerApi()){if(g&&0===f){d();return}if(!g){f++;return}f=0}g=a.utils.clone(this);this.removeFunctions(g);a.contextLoader.getContextAccessor().setContext(g,d,e)},clone:function(){var f=a.utils.clone(this);this.addFunctions(f);return f},customActions:{},segmentEvents:{enter:{},leave:{}},conversions:{},loginId:null,sessionPathVisits:{},messageDisplayTimes:{},stampedCampaigns:{},removedCampaigns:{},profile:void 0}})();
a.conversion=function(){function f(b,c,d){d=0<=d?d:0;c||a.log.warn("easy.conversion.evaluateDefinitions",a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),debug:x.JSON.stringify({conversionsCount:a.conversions.length,productsCount:a.products.length,expectedCount:d,callerModuleName:"direct",triggerId:a.utils.isObject(b)?b.id:0})});a.utils.each(v,function(c){if(a.conversionEvaluator.evaluateDefinition(c)||a.conversionEvaluator.evaluateTrigger(c,b))d+=1,a.conversions.push({conversion_id:c.conversionId,
conversion_type:c.conversionType,conversion_value:c.conversionValue,conversion_name:c.conversionId})});a.conversion.handleConversionArray(c,d)}function g(c,d){var e=[];d=0<=d?d:0;a.conversions.length>d&&a.log.warn("easy.conversion.handleConversionArray (global array contains conversions)",a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),debug:x.JSON.stringify({conversionsCount:a.conversions.length,productsCount:a.products.length,expectedCount:d,callerModuleName:c||
"direct"})});var f=r(a.conversions,t.conversion);a.conversions=[];c||a.log.warn("easy.conversion.handleConversionArray (external call)",a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),debug:x.JSON.stringify({conversionsCount:a.conversions.length,productsCount:a.products.length,expectedCount:d,callerModuleName:"direct"})});a.utils.each(f,function(c){var d={productType:c.conversion_type,productName:c.conversion_name};a.api.setConversionData(c.conversion_id,d,null);
a.api.buyProduct(null,c.conversion_type,c.conversion_id,c.conversion_value,null,null,c.payment_channel,c.custom_id,c.transaction_id,c.conversion_quantity);a.console.log("[conversion]",'Conversion sent with the product type "'+d.productType+'" and product name "'+d.productName+'"');d=c.conversion_type||"undefined";a.visitsHistory.addConversion(d,c.conversion_id,new E);e.push(d);e.push(d+" "+c.conversion_id);a.events.trigger(a.EVENT_CONVERSION,b(c))});0<f.length&&(a.context.save(),a.segmentchange.evaluate({conversion:e},
new E))}function d(b,d){d=0<=d?d:0;a.products.length>d&&a.log.warn("easy.conversion.handleProductArray (global array contains products)",a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),debug:x.JSON.stringify({conversionsCount:a.conversions.length,productsCount:a.products.length,expectedCount:d,callerModuleName:b||"direct"})});var e=r(a.products,t.product);a.products=[];b||a.log.warn("easy.conversion.handleProductArray (external call)",a.ERROR_TYPE_DEPRECATED+".conversion_module",
{module:a.internal.getCurrentModule(),debug:x.JSON.stringify({conversionsCount:a.conversions.length,productsCount:a.products.length,expectedCount:d,callerModuleName:"direct"})});a.utils.each(e,function(b){var d=c(b);a.api.setProductData(b.product_id,d,null);a.console.log("[conversion]",'Product sent with the product type "'+d.productType+'" and product name "'+d.productName+'"');a.events.trigger(a.EVENT_PRODUCT_DATA,h(b))})}function e(b){var c=a.domElements.selector("div.frosmo-conversion",b),d;d=
a.utils.map(c,l);d=r(d,t.conversion);a.utils.isEmpty(c)||a.log.warn("easy.conversion.parseHtml -> _parseConversions",a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),count:d.length,elements:c.length});ha.prototype.push.apply(a.conversions,d);b=a.domElements.selector("div.frosmo-product",b);c=a.utils.map(b,k);c=r(c,t.product);a.utils.isEmpty(b)||a.log.warn("easy.conversion.parseHtml -> _parseProducts",a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),
count:c.length,elements:b.length});ha.prototype.push.apply(a.products,c)}function b(b){var c={};a.utils.each(b,function(a,b){c[b.replace(/^conversion_/,"")]=a});c.products=[{id:c.id,value:c.value,quantity:c.quantity}];return c}function c(b){var c="product_categories product_colors product_custom_images product_data product_ids product_multi_prices".split(" ");return a.utils.reduce({productName:"product_name",productImage:"product_image",productPrice:"product_price",productType:"product_type",productUrl:"product_url",
productArea:"product_area",productCampaign:"product_campaign",productCategories:"product_categories",productCategory:"product_category",productCity:"product_city",productColors:"product_colors",productCompany:"product_company",productConversion:"product_conversion",productCountry:"product_country",productCustomImages:"product_custom_images",productData:"product_data",productDescription:"product_description",productDiscountPrice:"product_discount_price",productIds:"product_ids",productManufacturer:"product_manufacturer",
productModel:"product_model",productMultiPrices:"product_multi_prices",productPromotionLabel:"product_promotion_label",productRating:"product_rating",productStock:"product_stock",productSubCategory:"product_sub_category",productUrn:"product_urn",productVenue:"product_venue"},function(d,e,f){void 0!==b[e]&&(d[f]=!a.utils.isString(b[e])&&a.utils.inArray(c,e)?x.JSON.stringify(b[e]):b[e]);return d},{})}function h(b){var c=/^product_/,d={};a.utils.each(b,function(a,b){d[b.replace(c,"")]=d[b]=a});return d}
function r(b,c){return a.utils.filter(b,function(a){return w(a,c)})}function n(b,c){return a.utils.every(c,function(a){return J.prototype.hasOwnProperty.call(b,a)})}function l(a){return u(a,t.conversion)}function k(a){return u(a,t.product)}function u(b,c){var d={};a.utils.each(a.domElements.selector("span",b),function(b){var e=b.getAttribute("class");(a.utils.inArray(c.required,e)||a.utils.inArray(c.optional,e))&&(b=a.utils.trim(b.innerHTML))&&(d[e]=b)});return n(d,c.required)?d:null}function w(b,
c){if(!b||!n(b,c.required))return null;a.utils.each(b,function(d,e){a.utils.inArray(c.optional,e)||a.utils.inArray(c.required,e)||delete b[e]});return b}a.conversions=a.conversions||[];a.products=a.products||[];var v=[],t={product:{required:"product_id product_name product_image product_price product_type product_url".split(" "),optional:"product_area product_campaign product_categories product_category product_city product_colors product_company product_conversion product_country product_custom_images product_data product_description product_discount_price product_ids product_manufacturer product_model product_multi_prices product_part_payment product_promotion_label product_rating product_stock product_sub_category product_urn product_venue".split(" ")},
conversion:{required:["conversion_id","conversion_name","conversion_type","conversion_value"],optional:["payment_channel","custom_id","transaction_id","conversion_quantity"]}};return{init:function(b){if(!a.utils.isArray(b)||0===b.length)return!1;v=b;a.events.on(a.EVENT_TRIGGER_FIRE,function(a){f(a,"conversion_module",0)});return!0},evaluateDefinitions:f,handle:function(b,c,h){h=0<=h?h:0;c||a.log.warn("easy.conversion.handle",a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),
debug:x.JSON.stringify({conversionsCount:a.conversions.length,productsCount:a.products.length,expectedCount:h,callerModuleName:"direct"})});a.domEvents.ready(function(){f(void 0,c,h);e(b);d(c,h);g(c,h)})},handleConversionArray:g,handleProductArray:d,parseHtml:e}}();a.conversionEvaluator=function(){function f(d){var e=a.visitsHistory.getConversionLastTime(d.conversionType,d.conversionId);return e?e+d.interval<=a.utils.getTimestamp():!0}var g={matchUrl:function(d,e,b,c){var f=a.main.getCurrentBrowserData().href,
f=a.utils.getLocationFromUrl(f);return a.evaluator.matchUrl(d,e,b,c,f)},matchRefererUrl:function(d,e,b){var c=a.main.getCurrentBrowserData().referer,c=a.utils.getLocationFromUrl(c);return a.evaluator.matchUrl(d,e,b,{},c)},matchHtmlElement:function(d,e){e=e||A;return D(a.domElements.selector(d,e)[0])}};return{evaluateDefinition:function(d){if(d.rules&&f(d)){var e=new a.baseEvaluator;a.utils.each(g,function(a,c){e.addEvaluatorFunction(c,a)});return e.evaluate(d.rules)}return!1},evaluateTrigger:function(a,
e){return a&&e&&a.triggerId===e.id&&f(a)}}}();a.campaign=function(){function f(){a.context.stampedCampaigns={};a.context.save()}function g(b,c){a.api.custom({name:"campaign",campaign:c.name,type:c.adserver,action:b});a.console.log("[campaign]","campaign stamping, event:"+b+", campaign:"+c.name)}function d(a){return new E(I(a.substr(0,4),10),I(a.substr(5,2),10)-1,I(a.substr(8,2),10),0,0,0)}function e(b,c){var e,f;e=new Q(/(ipad|iphone|ipod)/i);if(w&&e.test(w))return!1;if(!b.name)throw new y("No campaign name defined");
if(!a.utils.inArray("adtech emediate adwords adform asx doubleclick facebook".split(" "),b.adserver))throw new y('Invalid campaign type "'+b.adserver+'" in '+b.name);if(!b.startDate||!b.endDate)throw new y("No start or end date defined for campaign ("+b.name+")");if(!b.url)throw new y("No api url defined for campaign ("+b.name+")");if(!b.targetGroups||0===b.targetGroups.length)return!1;e=d(b.startDate);f=d(b.endDate);f.setHours(23);f.setMinutes(59);f.setSeconds(59);return e<=c&&c<=f}function b(b,
c){c?(a.context.stampedCampaigns[b]=1,delete a.context.removedCampaigns[b]):(delete a.context.stampedCampaigns[b],a.context.removedCampaigns[b]=1)}function c(b,c){var d;switch(b.adserver){case "adform":case "doubleclick":case "emediate":a.internal.send(b.url,!0);break;case "adtech":d="https://secserv.adtech.de/"+b.url.replace(/^\//g,"");a.internal.send(d,!0);break;case "adwords":d="tggp="+c.join(",")+";frma="+b.name;d=b.url+O(d);a.internal.send(d,!0);break;case "facebook":d=b.url+"&cd[frma]="+b.name;
a.internal.send(d,!0);break;case "asx":a.internal.send(h(b.url),!0);break;default:throw new y("Invalid campaign.adserver:"+b.adserver);}}function h(a){var b=O(R.href),c=H.random().toString().substring(2,11);return a+"&rnd="+c+"&ref="+b}function r(b){if(!b.removeUrl)return!1;b=h(b.removeUrl);a.internal.send(b,!0);return!0}function n(b){a.api.clickMessage(null,b,1);a.console.log("[campaign]","External campaign logged (messageId: "+b+")");a.events.trigger(a.EVENT_CAMPAIGN_CLICK,b)}function l(b,c){function d(){return!0}
var e=a.utils.getLocationFromUrl(c);a.utils.each(b,function(b,c){a.evaluator.matchUrl(d,"",b,{},e)&&n(c)})}function k(b){b=a.utils.getLocationFromUrl(b);b=I(b.queryVariables.ftid,10);0<b&&n(b)}var u=[],w=null;return{init:function(b,c){var d=R.href;a.events.on(a.EVENT_VISIT,f);c||(c=P.userAgent);w=c;u=b.campaigns||[];l(b.campaignElements||{},d);k(d)},clear:function(){a.events.off(a.EVENT_VISIT,f)},clearStampedList:f,stampUser:function(d){var f=a.context.stampedCampaigns,h=a.context.removedCampaigns;
a.utils.each(u,function(w){var l=!1,n=[],q;if(e(w,d)&&(n=a.utils.filter(w.targetGroups,function(b){return a.utils.inArray(a.context.targetgroups,b)}),l=0<n.length,q=D(f[w.name]),l!==q))if(l)c(w,n),g(h[w.name]?"reenter":"enter",w),b(w.name,!0),a.events.trigger(a.EVENT_CAMPAIGN_STAMP,w);else{a:switch(w.adserver){case "asx":l=r(w);break a;default:l=!1}l&&(g("leave",w),b(w.name,!1),a.events.trigger(a.EVENT_CAMPAIGN_UNSTAMP,w))}});a.context.save()},trackCampaignElements:l,trackFtidParam:k}}();a.sharedCode=
function(){function f(d,b){a.utils.each(d,function(c){var d={args:a.utils.extend({easy:x.easy,site:x.site,sharedCode:{id:c.id},triggerEventData:void 0},b),guardOptions:{type:a.ERROR_TYPE_SHARED_CODE_EXCEPTION,level:a.LOG_LEVEL_ERROR,module:a.MODULE_SHARED_CODE,sharedCodeId:c.id},scriptNamespace:a.SHARED_CODE_ID+c.id};a.internal.safeEval(c.content,d)})}function g(e){a.utils.each(e.triggers,function(a){(a=d[a.id])&&f(a,{triggerEventData:e.data})})}var d={};return{init:function(e){a.utils.each(e,function(a){var c=
a.triggerId||0;d[c]=d[c]||[];d[c].push(a)});(e=d[0])&&f(e);a.events.on(a.EVENT_TRIGGER_EVENT,g)},clear:function(){d={};a.events.off(a.EVENT_TRIGGER_EVENT,g)}}}();a.message=function(){function f(){return a.utils.map(v,g)}function g(a){return t[a]}function d(b,c){c=a.utils.extend({},c);c.restoreMessage=a.utils.isBoolean(c.restoreMessage)?c.restoreMessage:a.spa.isEnabled();c.trackMessage=a.utils.isBoolean(c.trackMessage)?c.trackMessage:!0;c.onRender=function(){c.trackMessage&&z.push(b)};b.isPopup()?
a.popup.render(b,c):b.render(c)}function e(){a.utils.each(w,function(a){a.cancel()});w=[]}function b(){a.utils.each(z,function(a){(a=a.getMessageInstance())&&a.clearTimers()})}function c(b,c){var d={};return[a.utils.map(b,function(b){d[b.position]=new a.positionData(a.utils.clone(b),c);return b.position}),d]}function h(b){var c,d=M.MAX_VALUE;a.utils.each(b,function(a){a.isPopup()&&a.priorityLevel<d&&(c=a,d=a.priorityLevel)});return a.utils.filter(b,function(a){var b=a.isPopup();return!b||b&&c===a})}
function r(b){b={method:"multifetch",origin:a.config.api.origin,cookieId:a.uid.get(),positions:b.join("."),states:x.JSON.stringify(a.states.getAll()),ver:a.getVersion(),version:"3.0",ts:E.now()};a.context.targetgroups&&(b.targetGroups=a.utils.map(a.context.targetgroups,function(a){return a.replace("tggp_","")}).join("."));a.context.segments&&(b.segments=a.internal.getSegmentIds(a.context.segments));var c=a.context.lastVisit.source;c&&(b.source=c);c=a.internal.getWorkspaceId();0<c&&(b.ws=c);if(c=a.internal.getProfile())b.profile=
c;b.debug=a.isDev();return b}function n(b){if(a.isReady())if(a.events.isTriggered(a.EVENT_SEGMENTS_READY)){b=b||{};a.events.trigger(a.EVENT_MESSAGE_REQUEST);var d=a.main.getCurrentBrowserData().href,f=v,g=t;if(b.positions)var h=c(b.positions,d),f=h[0],g=h[1];f=a.utils.filter(f,function(b){var c=t[b];return(c=c?c.getMessageInstance():void 0)&&c.getType()===a.MESSAGE_TYPE_CACHED?!1:d&&g[b].isMatchingUrl(d)});0===f.length?a.console.warn("[message]","Requesting of messages was skipped, due to no active positions"):
(h=a.utils.map(f,function(a){return g[a]}),b.cancelPending&&e(),f=a.fetch.get(a.api.getApiUrl("message"),{params:r(f),timeout:b.timeout||5E3,success:l(h,u),error:function(b,c,d,e){a.events.trigger(a.EVENT_MESSAGE_FAILURE);a.log.warn("Unexpected error occurred with requesting messages","message_"+d.type,{module:a.internal.getCurrentModule(),debug:e})}}),b.cancelPending&&w.push(f))}else a.events.once(a.EVENT_SEGMENTS_READY,function(){n(b)});else a.ready(function(){n(b)})}function l(b,c){return function(d){if(c&&
c!==u)a.log.warn("Initialization of messages is already in progress",a.ERROR_TYPE_MESSAGE_INIT);else{a.events.trigger(a.EVENT_MESSAGE_RECEIVE,b);b=a.utils.filter(b,function(b,c){var e=d.messages[c];if(a.internal.isMessage(e))return b.setMessage(e),!0;b.show();return!1});a.events.trigger(a.EVENT_MESSAGE_SUCCESS,b);b=h(b);var e=b.reverse(),f=a.guard(a.message.show,{module:a.MODULE_MESSAGE});a.utils.each(e,f)}}}function k(){a.utils.each(v,function(a){t[a].show()})}var u=0,w=[],v=[],t={},z=[],G={};return{init:function(b){u+=
1;b=b&&b.positions?b.positions:a.config.positions;var d=a.main.getCurrentBrowserData().href;b=c(b,d);v=b[0];t=b[1];a.events.trigger(a.EVENT_MESSAGE_INIT);a.events.once(a.EVENT_INIT_FAILURE,k);a.events.on(a.EVENT_MESSAGE_FAILURE,k)},addCustomRenderer:function(b,c){if(G[b])return a.log.error('Renderer name "'+b+'" is already defined',a.ERROR_TYPE_RENDERER_INVALID),!1;if(!a.utils.isString(b))return a.log.error('Invalid type for renderer "name" argument, got "'+a.utils.getType(b)+'" for "'+b+'". Expected string type',
a.ERROR_TYPE_RENDERER_INVALID),!1;if(!a.utils.isFunction(c))return a.log.error('Invalid type for renderer "fn" argument, got "'+a.utils.getType(c)+'" for "'+c+'". Expected function type',a.ERROR_TYPE_RENDERER_INVALID),!1;G[b]=c;return!0},getCustomRenderer:function(a){return G[a]},clear:function(){e();a.utils.each(z.reverse(),function(a){a.clear()});z=[];a.utils.each([a.EVENT_MESSAGE_CLICK,a.EVENT_MESSAGE_SHOW,a.EVENT_MESSAGE_TRUE_DISPLAY,a.EVENT_MESSAGESHOW_COMPLETE,a.EVENT_MESSAGESHOW_FAILED],a.events.clearEvent);
a.events.off(a.EVENT_INIT_FAILURE,k)},getActivePositions:function(b){var c=a.main.getCurrentBrowserData().href;b=a.utils.filter(b||f(),function(a){return a.isMatchingUrl(c)});return a.utils.map(b,function(a){return{position:a.position}})},getPositions:f,getPosition:g,requestMessages:function(c){b();var d=a.preview.getParams();d?a.message.requestPreview(d):n(c)},requestPreview:function(b){b&&a.preview.requestMessage(b).then(function(c){var e=t[b.positionId];e?(e.setMessage(c.content),d(e,{excludeTrigger:!0,
trackMessage:!1})):a.console.error("[message]",'Invalid previewing "position id" of '+b.positionId)}).catch(function(b){a.console.error("[message]",b)})},show:d,updatePositions:function(b){a.utils.each(b,function(b){b instanceof a.positionData&&t[b.position]&&(t[b.position]=b)})}}}();(function(){function f(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function g(b,c){b.removeAttribute("class");c.cssClasses.length&&a.utils.addClassName(b,c.cssClasses);b.removeAttribute("style");c.cssText&&(b.style.cssText=
c.cssText);b.id=c.id;b.removeAttribute("data-frosmo-message-id");b.removeAttribute("data-frosmo-position-id")}var d=0,e={value:!0};a.messageInstance=function(b){if(!(this instanceof a.messageInstance))throw new y('"easy.messageInstance" cannot be called as a function. Use the "new" keyword to construct a new "Message" instance');if(!a.internal.isMessage(b.message))throw new y('Invalid type for "message" property, got "'+a.utils.getType(b.message)+'" for '+this.id);a.utils.extend(this,b.message);J.defineProperty(this,
"positionData",{configurable:!0,writable:!0,value:b});this._displayDelayIds=[];this._elementCount=a.utils.isNumber(a.config.messageMaxElements)&&0<a.config.messageMaxElements?a.config.messageMaxElements:50;this._origClickOrSubmitEvents=[];this._origElementsData=[];this._elements=[];this._trackableElements=[];this._middleButton=void 0;this._type=a.utils.some(a.config.quickMessages,function(a){return this.id===a.id},this)?a.MESSAGE_TYPE_CACHED:a.MESSAGE_TYPE_BASIC;this._uniqueId=++d;this._showRevision=
K.bind(this._showRevision,this);this._onClickEvent=K.bind(this._onClickEvent,this);this._onTrueDisplayEvent=K.bind(this._onTrueDisplayEvent,this);this._onClick=K.bind(this._onClick,this);this._onClickOrSubmit=K.bind(this._onClickOrSubmit,this);this._onMiddleClick=K.bind(this._onMiddleClick,this);this.startTracking=K.bind(this.startTracking,this);this.setRestorable(!1);this._clearFns=[];this.setTrackable(!0)};a.messageInstance.prototype.isShowable=function(){return!this._hasMaxDisplays()&&this._createElements()};
a.messageInstance.prototype.insertHtml=function(b,c){void 0===b&&(b=this.content);a.utils.each(this._elements,function(d,e){var f=this._createParams(a.utils.extend({messageWrapperIndex:e},c));a.domElements.html(d,b,f)},this)};a.messageInstance.prototype.isRendered=function(){return D(this._isRendered)};a.messageInstance.prototype.show=function(){if(this.isRendered()||!this.isShowable())return!1;var b=1E3*this.options.displayDelay||0;if(0<b){var c=a.guard(this._showRevision,this._createGuardOptions());
this._displayDelayIds.push(a.utils.setTimeout(c,b))}else this._showRevision();J.defineProperty(this,"_isRendered",e);return!0};a.messageInstance.prototype.trackingEvent=function(b){a.tracking?a.tracking.event(b,{modificationId:this.id,variationId:this.revision}):a.console.warn(a.MODULE_MESSAGE,"Enable the tracking module, so message_id."+this.id+' will be tracked as "'+b+'"')};a.messageInstance.prototype._showRevision=function(){this.isHidden()?this._showHiddenRevision():this._useTemplatePreRenderer()?
this._preRenderTemplate():(this._showNormalRevision(),a.uihooks.initLinks(a.config.links),a.uihooks.initForms(a.config.forms))};a.messageInstance.prototype._showHiddenRevision=function(){var b=this.positionData.getHiddenRenderer();b?this._callRenderer(b,this._elements[0]):this.startTracking();a.console.info("[messageRendered]","position_id."+this.positionData.position+", message_id."+this.id+", revision_id."+this.revision,this.positionData)};a.messageInstance.prototype._showNormalRevision=function(b){this.content=
this.positionData.message.content=this.getContent(b);var c=this.positionData.getRenderer();if(!a.utils.isEmpty(this.content)||c)this.isRestorable()&&(this._origElementsData=a.utils.map(this._origElementsData,this._backupElements,this)),a.utils.each(this._elements,function(b,d){this.positionData.method===this.positionData.METHOD_RENEW&&f(b.nextSibling);if(c)this._callRenderer(c,b);else{var e=this._createParams({messageWrapperIndex:d});a.domElements.html(b,this.content,e);this.positionData.show();this.startTracking()}},
this),a.console.info("[messageRendered]","position_id."+this.positionData.position+", message_id."+this.id+", revision_id."+this.revision,this.positionData)};a.messageInstance.prototype._preRenderTemplate=function(){var b=a.utils.isObject(this.template.defaults)?this.template.defaults:x.JSON.safeParse(this.template.defaults,null),c={name:this.template.variable,options:b,render:a.guard(this._showNormalRevision,this._createGuardOptions(!1,!0))},b=this._getTemplatePreRenderer(),c=this._createParams({templateInstance:c},
a.MESSAGE_PRE_RENDERER_SCRIPT_ID);a.internal.safeEval(b,c)};a.messageInstance.prototype.clear=function(){if(!this.isRestorable())return!1;a.utils.each(this._clearFns,function(a){a()});this._clearFns=[];this.clearTimers();var b=this._getTrackableElements();a.domEvents.off(b,"click."+a.DOM_EVENT_NAMESPACE,'a, area, button, input[type="button"], input[type="image"], input[type="submit"], .frosmo-click',this._onClick);a.domEvents.off(b,"click."+a.DOM_EVENT_NAMESPACE,this._onClick);a.domEvents.off(b,"mousedown."+
a.DOM_EVENT_NAMESPACE,"a, area",this._onMiddleClick);a.domEvents.off(b,"mouseup."+a.DOM_EVENT_NAMESPACE,"a, area",this._onMiddleClick);a.utils.each(this._origClickOrSubmitEvents,function(a){a[0][a[1]]=a[2]});a.events.off(a.EVENT_MESSAGE_CLICK,this._onClickEvent);a.events.off(a.EVENT_MESSAGE_TRUE_DISPLAY,this._onTrueDisplayEvent);a.messageTrueDisplay.clearId(this.positionData.message,this.positionData);a.utils.each(b,this._restoreElements,this);a.utils.each(a.domElements.selector("."+a.MESSAGE_SCRIPT_ID+
this.id),f);a.domElements.removeStyles(void 0,a.MESSAGE_STYLE_ID+this.id);this._origClickOrSubmitEvents=[];this._origElementsData=[];this._elements=[];this._trackableElements=[];return!0};a.messageInstance.prototype.onClear=function(b){if(a.utils.isFunction(b)){var c=this._createGuardOptions(!0,!0);this._clearFns.push(a.guard(b,c))}else this._logSend('Invalid type for "fn" argument, got "'+a.utils.getType(b)+'" for "'+b+'". Expected function type',a.ERROR_TYPE_ARG_INVALID,a.LOG_LEVEL_ERROR)};a.messageInstance.prototype.clearTimers=
function(){a.utils.each(this._displayDelayIds,X);this._displayDelayIds=[]};a.messageInstance.prototype._backupElements=function(a){switch(this.positionData.method){case this.positionData.METHOD_HIDE:case this.positionData.METHOD_REPLACE:for(var c=this._createElement();a.el.hasChildNodes();)c.appendChild(a.el.firstChild);a.el=c}return a};a.messageInstance.prototype._restoreElements=function(a,c){if(a){var d=this._origElementsData[c];switch(this.positionData.method){case this.positionData.METHOD_RENEW:if(!d)break;
if(this.isHidden()){g(a,d);break}a.parentNode&&a.parentNode.insertBefore(d.el,a);f(a);break;case this.positionData.METHOD_HIDE:case this.positionData.METHOD_REPLACE:if(!d)break;g(a,d);if(this.isHidden())break;for(;a.hasChildNodes();)a.removeChild(a.lastChild);for(;d.el.hasChildNodes();)a.appendChild(d.el.firstChild);break;default:f(a)}}};a.messageInstance.prototype._applyContainerStyles=function(b){var c=/;\s*$/;return a.utils.map(b,function(b){this.positionData.cssClasses&&a.utils.addClassName(b,
this.positionData.cssClasses);if(this.positionData.cssText){var d=b.style.cssText||"",e=d&&!c.test(d)?";":"";b.style.cssText=d+e+this.positionData.cssText}b.id=b.id||"frosmo_message_id_"+this._uniqueId;a.utils.addClassName(b,["frosmo_inline","frosmo_message_"+this.id,"frosmo_position_"+this.positionData.position]);b.setAttribute("data-frosmo-message-id",this.id);b.setAttribute("data-frosmo-position-id",this.positionData.position);return b},this)};a.messageInstance.prototype._createElements=function(){if(this._elements.length)return!0;
var b=this.positionData.getElements();if(0===b.length)return this._elements=[],!1;var c=this.isHidden(),d=this.positionData.method===this.positionData.METHOD_RENEW;this.positionData.method===this.positionData.METHOD_REPLACE||this.positionData.method===this.positionData.METHOD_HIDE?(c=b,this._origElementsData=this._getElementsData(b)):d?(c=c?b:this._createContainers(b),this._origElementsData=this._getElementsData(b)):c=c?[this._createElement()]:this._createContainers(b);this._elements=this._applyContainerStyles(c);
this._elements.length>this._elementCount&&(this._origElementsData=this._origElementsData.slice(0,this._elementCount),this._elements=this._elements.slice(0,this._elementCount),this._logSend("Selector matched "+this._elements.length+" elements",a.ERROR_TYPE_ELEMENTS_LONG,a.LOG_LEVEL_INFO));return 0<this._elements.length};a.messageInstance.prototype._createElement=function(b){var c="DIV LI P SPAN TD TH TR".split(" "),c=b&&b.tagName&&a.utils.inArray(c,b.tagName);return A.createElement(c?b.tagName:"DIV")};
a.messageInstance.prototype._createContainers=function(b){return a.utils.map(b,function(b){var d=this._getRelatedContainer(b,this.positionData),e="frosmo_position_"+this.positionData.position;return a.utils.inArray(a.utils.getClassNames(d),e)?d:this._createContainer(b,this.positionData)},this)};a.messageInstance.prototype._createContainer=function(a,c){var d;switch(c.method){case c.METHOD_RENEW:return d=this._createElement(a),a.parentNode.insertBefore(d,a),d;case c.METHOD_BEFORE:return d=this._createElement(a),
a.parentNode.insertBefore(d,a),d;case c.METHOD_AFTER:for(d=a.nextSibling;d&&d.nodeType!==V.ELEMENT_NODE;)d=d.nextSibling;d=this._createElement(d);a.parentNode.insertBefore(d,a.nextSibling);return d;case c.METHOD_PREPEND:for(d=a.firstChild;d&&d.nodeType!==V.ELEMENT_NODE;)d=d.nextSibling;d=this._createElement(d);a.insertBefore(d,a.firstChild);return d;case c.METHOD_APPEND:for(d=a.lastChild;d&&d.nodeType!==V.ELEMENT_NODE;)d=d.previousSibling;d=this._createElement(d);a.appendChild(d);return d;default:return d}};
a.messageInstance.prototype._getRelatedContainer=function(a,c){switch(c.method){case c.METHOD_BEFORE:return a.previousSibling;case c.METHOD_AFTER:return a.nextSibling;case c.METHOD_PREPEND:if(a.childNodes.length)return a.childNodes[0];break;case c.METHOD_APPEND:if(a.childNodes.length)return a.childNodes[a.childNodes.length-1]}};a.messageInstance.prototype._getElementsData=function(b){return a.utils.map(b,function(b){return{cssClasses:a.utils.getClassNames(b),cssText:b.style.cssText,el:b,id:b.id}})};
a.messageInstance.prototype.isClicked=function(){return D(this._isClicked)};a.messageInstance.prototype.startClickTracking=function(){if(this._hasClickTracking||!this.isTrackable()||this.isHidden()&&!this._isHiddenTrackable("click"))return!1;J.defineProperty(this,"_hasClickTracking",e);var b=this._getTrackableElements();a.utils.each(b,this._clickEventHandlers,this);a.events.on(a.EVENT_MESSAGE_CLICK,this._onClickEvent,this);return!0};a.messageInstance.prototype.setClicked=function(){if(this.isClicked()||
!this.isTrackable())return!1;J.defineProperty(this,"_isClicked",e);a.ready(function(){a.api.clickMessage(null,this.id,this.revision);a.events.trigger(a.EVENT_MESSAGE_CLICK,this.positionData.message);a.console.info("[messageClick]","position_id."+this.positionData.position+", message_id."+this.id+", revision_id."+this.revision,this.positionData)},this);this.setTrueDisplayed();return!0};a.messageInstance.prototype._isTrackingDisabled=function(a){return/(close|fb_button|frosmo-no-click)/i.test(a.className)};
a.messageInstance.prototype._clickEventHandlers=function(b){this._middleButton=void 0;a.domEvents.on(b,"click."+a.DOM_EVENT_NAMESPACE,'a, area, button, input[type="button"], input[type="image"], input[type="submit"], .frosmo-click',this._onClick);if(a.domElements.matches(b,'a, area, button, input[type="button"], input[type="image"], input[type="submit"], .frosmo-click'))a.domEvents.on(b,"click."+a.DOM_EVENT_NAMESPACE,this._onClick);a.domEvents.on(b,"mousedown."+a.DOM_EVENT_NAMESPACE,"a, area",this._onMiddleClick);
a.domEvents.on(b,"mouseup."+a.DOM_EVENT_NAMESPACE,"a, area",this._onMiddleClick);a.utils.each(a.domElements.selector("a, area, form",b),this._onClickOrSubmit)};a.messageInstance.prototype._onClick=function(a,c){this._isTrackingDisabled(c)||this.setClicked()};a.messageInstance.prototype._onClickEvent=function(a){this.id!==a.id||this.revision!==a.revision||this.isClicked()||J.defineProperty(this,"_isClicked",e)};a.messageInstance.prototype._onClickOrSubmit=function(b){if(!this._isTrackingDisabled(b)){var c=
"FORM"===b.tagName?"onsubmit":"onclick",d=b[c];this.isRestorable()&&this._origClickOrSubmitEvents.push([b,c,d]);var e=this._createGuardOptions(!1,!0);b[c]=a.guard(function(e){this.setClicked();b[c]=d;return a.utils.isFunction(d)?d.call(this,e):void 0},e)}};a.messageInstance.prototype._onMiddleClick=function(a,c){this._isTrackingDisabled(c)||1!==a.button||("mousedown"===a.type?this._middleButton=c:"mouseup"===a.type&&this._middleButton===c&&(this._middleButton=void 0,this.setClicked()))};a.messageInstance.prototype.isDisplayed=
function(){return D(this._isDisplayed)};a.messageInstance.prototype.setDisplayed=function(){if(this.isDisplayed()||!this.isTrackable())return!1;J.defineProperty(this,"_isDisplayed",e);a.ready(function(){a.api.showMessage(null,this.id,this.revision);a.events.trigger(a.EVENT_MESSAGE_SHOW,this.positionData.message);a.console.info("[messageDisplay]","position_id."+this.positionData.position+", message_id."+this.id+", revision_id."+this.revision,this.positionData)},this);this._incrMaxDisplays();return!0};
a.messageInstance.prototype.isTrueDisplayed=function(){return D(this._isTrueDisplayed)};a.messageInstance.prototype.startTrueDisplayTracking=function(){if(this._hasTrueDisplayTracking||!this.isTrackable()||this.isHidden()&&!this._isHiddenTrackable("true display"))return!1;J.defineProperty(this,"_hasTrueDisplayTracking",e);var b=this._getTrackableElements();a.messageTrueDisplay.start(this.positionData.message,this.positionData,b);a.events.on(a.EVENT_MESSAGE_TRUE_DISPLAY,this._onTrueDisplayEvent,this);
return!0};a.messageInstance.prototype.setTrueDisplayed=function(){if(this.isTrueDisplayed()||!this.isTrackable())return!1;J.defineProperty(this,"_isTrueDisplayed",e);a.ready(function(){a.messageTrueDisplay.logInstantly(this.id,this.revision)},this);return!0};a.messageInstance.prototype._onTrueDisplayEvent=function(a){this.id!==a.id||this.revision!==a.revision||this.isTrueDisplayed()||J.defineProperty(this,"_isTrueDisplayed",e)};a.messageInstance.prototype.startTracking=function(){a.ready(function(){this.setDisplayed();
this.startClickTracking();this.startTrueDisplayTracking()},this)};a.messageInstance.prototype.setTrackableElements=function(b){this._trackableElements=a.utils.isArray(b)?b:[b]};a.messageInstance.prototype._getTrackableElements=function(){return this._elements.concat(this._trackableElements)};a.messageInstance.prototype.getTemplateDefaults=function(){return this.template?this.template.defaults:null};a.messageInstance.prototype.insertTemplate=function(a,c,d){this.insertHtml(this.getContent(a,c),d)};
a.messageInstance.prototype.renderTemplate=function(b,c){if(!this._hasTemplate())return this.content;if(!a.template)return this._logSend("Template module not found",a.ERROR_TYPE_MODULE_MISSING,a.LOG_LEVEL_CRITICAL),this.content;if(!this.template.variable)return this._logSend("Template variable is missing",a.ERROR_TYPE_TEMPLATE_MISSING,a.LOG_LEVEL_ERROR),null;this._setTemplateDefaults();var d=this._getTemplateContent()||this.content;if(!d)return this._logSend("Template content is missing",a.ERROR_TYPE_TEMPLATE_MISSING,
a.LOG_LEVEL_ERROR),null;var e=b||this.getTemplateDefaults();return e?a.template.render(d,e,c,this._createGuardOptions()):(this._logSend("Template defaults is missing",a.ERROR_TYPE_TEMPLATE_MISSING,a.LOG_LEVEL_ERROR),null)};a.messageInstance.prototype._hasTemplate=function(){return this.template&&this.template.active};a.messageInstance.prototype._getTemplateDefaults=function(){return a.utils.isObject(this.template.defaults)?this.template.defaults:x.JSON.safeParse(this.template.defaults,null)};a.messageInstance.prototype._setTemplateDefaults=
function(){var b=this._getTemplateDefaults();this._useTemplateContent()||this._useTemplateExport()||(b=a.utils.getByDotString(this.template.variable)||b,a.utils.isEmpty(b)&&(b=null));this.template.defaults=b;this.positionData.message.template=this.template};a.messageInstance.prototype._getTemplateContent=function(){if(this._useTemplateContent())return this.template.content;if(this._useTemplateExport())return a.config.templates[this.template.variable]};a.messageInstance.prototype._useTemplateContent=
function(){return D(this.template.content)};a.messageInstance.prototype._getTemplatePreRenderer=function(){if(this.template.preRenderer)return this.template.preRenderer;if(a.config.templatePreRenderers&&a.config.templatePreRenderers[this.template.variable])return a.config.templatePreRenderers[this.template.variable]};a.messageInstance.prototype._useTemplatePreRenderer=function(){return this._hasTemplate()&&D(this._getTemplatePreRenderer())};a.messageInstance.prototype._useTemplateExport=function(){return D(a.config.templates&&
a.config.templates[this.template.variable])};a.messageInstance.prototype._callRenderer=function(b,c){a.messageTrueDisplay.setData(this.positionData.message,this.positionData,c);var d=this._createGuardOptions(!0,!0);return a.runGuarded(b,[this.positionData,this.positionData.message,c,this.startTracking],d)};a.messageInstance.prototype.getContent=a.messageInstance.prototype.renderTemplate;a.messageInstance.prototype.getElements=function(){return a.utils.arrayFrom(this._elements)};a.messageInstance.prototype.getType=
function(){return this._type};a.messageInstance.prototype.isComparisonGroup=function(){return 999===this.revision};a.messageInstance.prototype.isHidden=function(){return"hidden"===this.revisionType};a.messageInstance.prototype.isRestorable=function(){return this._isRestorable};a.messageInstance.prototype.setRestorable=function(a){this._isRestorable=D(a)};a.messageInstance.prototype.isTrackable=function(){return this._isTrackable};a.messageInstance.prototype.setTrackable=function(a){this._isTrackable=
D(a)};a.messageInstance.prototype._createGuardOptions=function(b,c){return{type:a.ERROR_TYPE_MESSAGE_EXCEPTION,level:a.LOG_LEVEL_ERROR,module:a.MODULE_MESSAGE,messageId:this.id,revisionId:this.revision,positionId:this.positionData.position,rendererName:b&&this.positionData.hasRenderer()?this.positionData.renderer:void 0,templateId:this.template&&this.template.variable?B(this.template.variable):void 0,context:c?this:void 0}};a.messageInstance.prototype._createParams=function(b,c){c||(c=a.MESSAGE_SCRIPT_ID);
return{args:a.utils.extend({message:this.positionData.message,positionData:this.positionData,easy:x.easy,site:x.site},b),guardOptions:this._createGuardOptions(),scriptNamespace:c+this.id,styleNamespace:a.MESSAGE_STYLE_ID+this.id}};a.messageInstance.prototype._hasMaxDisplays=function(){return this.options.maxDisplayTimes&&a.context.messageDisplayTimes[this.id]>=this.options.maxDisplayTimes};a.messageInstance.prototype._incrMaxDisplays=function(){this.options.maxDisplayTimes&&(a.context.messageDisplayTimes=
a.context.messageDisplayTimes||{},a.context.messageDisplayTimes[this.id]=(a.context.messageDisplayTimes[this.id]||0)+1,a.context.save())};a.messageInstance.prototype._isHiddenTrackable=function(b){var c=a.utils.inArray([this.positionData.METHOD_HIDE,this.positionData.METHOD_RENEW,this.positionData.METHOD_REPLACE],this.positionData.method);c&&!a.config.hiddenMessageClickTracking&&a.console.warn(a.MODULE_MESSAGE,'Set "easy.config.hiddenMessageClickTracking" to true, so message_id.'+this.id+' will be tracked as "'+
b+'"',this.positionData);return c&&a.config.hiddenMessageClickTracking};a.messageInstance.prototype._logSend=function(b,c,d){var e=this._createGuardOptions();delete e.type;e.level=d;a.log.send(b,c,e)}})();a.messageTrueDisplay=function(){function f(){a.utils.each(l,d)}function g(b,c,d,e){l[c.position]={message:b,positionData:c,elements:a.utils.isArray(d)?d:[d],timerId:void 0,trackAutomatically:e,onScroll:void 0}}function d(c){if(c.trackAutomatically){var d=a.utils.some(c.elements,a.domElements.isVisible);
d&&!c.timerId?c.timerId=a.utils.setTimeout(function(){r(c);h(c)},a.MESSAGE_TRUE_DISPLAY_TIME):d||b(c)}}function e(){a.utils.isEmpty(l)&&(ua(k),k=void 0)}function b(a){a.timerId&&(X(a.timerId),a.timerId=void 0)}function c(b){b.onScroll||(b.onScroll=function(){d(b)},a.domEvents.on(window,"scroll."+a.DOM_EVENT_NAMESPACE,b.onScroll))}function h(b){b.onScroll&&a.domEvents.off(window,"scroll."+a.DOM_EVENT_NAMESPACE,b.onScroll)}function r(c){var d=c.message,f=c.positionData,g=d.id+"-"+d.revision;n[g]||(n[g]=
!0,a.ready(function(){a.api.trueDisplay(null,d.id,d.revision);a.events.trigger(a.EVENT_MESSAGE_TRUE_DISPLAY,d);a.console.info("[messageTrueDisplay]","position_id."+f.position+", message_id."+d.id+", revision_id."+d.revision,f)}));b(c);delete l[f.position];e()}var n={},l={},k;return{checkAll:f,clear:function(){a.utils.each(l,h);a.utils.each(l,b);a.events.clearEvent(a.EVENT_MESSAGE_TRUE_DISPLAY);n={};l={};e()},clearId:function(a,c){var d=l[c.position];d&&(h(d),b(d));delete n[a.id+"-"+a.revision];delete l[c.position];
e()},logInstantly:function(b,c){if(!n[b+"-"+c]){var d=a.utils.find(l,function(a){return b===a.message.id});d?(d.message.revision=c,r(d)):a.log.warn("True display not initialized for message",a.ERROR_TYPE_MESSAGE_INIT,{module:a.internal.getCurrentModule(),messageId:b,revisionId:c})}},setData:g,start:function(b,d,e){e&&0!==e.length&&b&&d&&(g(b,d,e,!0),c(l[d.position]),f(),k||(k=a.utils.setInterval(f,1E3)))}}}();a.positionData=function(f,g){if(!(this instanceof a.positionData))throw new y('"easy.positionData" cannot be called as a function. Use the "new" keyword to construct a new "Position" instance');
f instanceof a.positionData&&a.console.error(a.MODULE_POSITION,'Invalid type for "position" argument, must not be an instance of easy.positionData');if(!f)throw new y('Invalid type for "position" argument, got "'+a.utils.getType(f)+'"');if(!f.elementId)throw new y('Invalid position "elementId" property for '+f);a.utils.extend(this,f);this._messageInstance=void 0;this._showInstance=K.bind(this._showInstance,this);J.defineProperty(this,"_waitForElement",{configurable:!0,writable:!0});this.triggerId=
I(this.triggerId,10)||void 0;this._isTriggered=this._hasTriggerEvent=!1;this._onTriggerEvent=K.bind(this._onTriggerEvent,this);this.cssClasses=this.cssClasses||null;this.cssText=this.cssText||null;this.renderer=this.renderer||null;this.message=void 0;this.hidden=!1;this._setPriorityLevel();this.method===this.METHOD_HIDE&&this.isMatchingUrl(g)&&this.hide()};a.positionData.prototype.getElements=function(){return a.domElements.selector(this.getSelector(),A,this.hasjQuerySelector())};a.positionData.prototype.getSelector=
function(){return this.isPopup()?a.popup.getId():this.selectorType===this.SELECTOR_TYPE_V1?/^\$/.test(this.elementId)?this.elementId.substring(1):"#"+this.elementId:this.elementId};a.positionData.prototype.hasjQuerySelector=function(){return this.selectorType===this.SELECTOR_TYPE_JQUERY||!a.domElements.isSelector(this.getSelector())};a.positionData.prototype.isPopup=function(){return this.elementId===this.SELECTOR_TYPE_POPUP};a.positionData.prototype.hide=function(){var f=this.getSelector();if(a.domElements.isSelector(f)){var g=
a.domElements.selector(f);a.utils.some(g,function(d){return 0<a.domElements.visibility(d)})||(a.domElements.addStyles(f+" { visibility: hidden !important; }","hide_and_replace_"+this.position),this.hidden=!0)}else a.log.warn('Invalid position CSS selector of "'+f+'"',a.ERROR_TYPE_SELECTOR_INVALID,{module:a.MODULE_POSITION,positionId:this.position})};a.positionData.prototype.show=function(){if(this.method===this.METHOD_HIDE&&this.hidden){this.hidden=!1;var f=this.getSelector();a.domElements.isSelector(f)&&
a.domElements.removeStyles(f,"hide_and_replace_"+this.position)}};a.positionData.prototype.getRenderer=function(){if(this.hasRenderer()){var f=a.message.getCustomRenderer(this.renderer);void 0===f&&(f=this.message&&0<this.message.id?this.message.id:void 0,a.log.error('Invalid renderer function, for "'+this.renderer+'"',a.ERROR_TYPE_MESSAGE_INVALID,{module:a.MODULE_POSITION,messageId:f,revisionId:f?this.message.revision:void 0,positionId:this.position,rendererName:this.renderer||void 0}),f=function(a){a.clear()});
return f}};a.positionData.prototype.getHiddenRenderer=function(){return this.hasRenderer()?a.message.getCustomRenderer(this.renderer+".hidden"):void 0};a.positionData.prototype.hasRenderer=function(){return a.utils.isString(this.renderer)&&0<this.renderer.length};a.positionData.prototype.render=function(f){a.console.info("[positionActive]","position_id."+this.position+", message_id."+this.message.id+", revision_id."+this.message.revision,this);this._interval=I(f.interval,10)||100;this._maxcalls=I(f.maxcalls,
10)||100;this._onRender=a.utils.isFunction(f.onRender)?f.onRender:function(){};this._messageInstance=new a.messageInstance(this);this._messageInstance.setRestorable(f.restoreMessage);this._messageInstance.setTrackable(f.trackMessage);this._startTriggerEvent(!0===f.excludeTrigger);this._onRender()};a.positionData.prototype._completeInstance=function(f){var g=void 0===f;a.events.trigger(g?a.EVENT_MESSAGESHOW_COMPLETE:a.EVENT_MESSAGESHOW_FAILED,this);a.console.info("[positionComplete]",(g?"Success":
"Failed")+": position_id."+this.position+", message_id."+this.message.id+", revision_id."+this.message.revision,this);g||a.debug.addEntry("errors_position",{error:f,positionId:this.position})};a.positionData.prototype._showInstance=function(){this._isCleared=!1;a.events.off(a.EVENT_JQUERY_READY,this._showInstance);a.events.off(a.ERROR_SITE_JQUERY_MISSING,this._showInstance);a.console.info("[positionWait]","position_id."+this.position+", message_id."+this.message.id+", revision_id."+this.message.revision,
this);this._waitForElement=a.domElements.waitFor({selector:this.getSelector(),interval:this._interval,timeout:this._maxcalls*this._interval});var f=this;this._waitForElement.then(function(){a.console.info("[positionFound]","position_id."+f.position+", message_id."+f.message.id+", revision_id."+f.message.revision,this);if(f._isCleared||!f._messageInstance.show())throw new y("Position was cleared or the message was not shown for "+f.position);f._completeInstance(void 0)}).catch(function(a){f._completeInstance(a)})};
a.positionData.prototype.isTriggered=function(){return this._isTriggered};a.positionData.prototype._startTriggerEvent=function(f){f||void 0===this.triggerId?this._onTriggerEvent():this._hasTriggerEvent||(this._hasTriggerEvent=!0,a.events.on(a.EVENT_TRIGGER_FIRE,this._onTriggerEvent))};a.positionData.prototype._onTriggerEvent=function(f){f&&this.triggerId!==f.id||(this._isTriggered=!0,this.hasjQuerySelector()&&!a.sizzle?(a.events.once(a.EVENT_JQUERY_READY,this._showInstance),a.events.once(a.ERROR_SITE_JQUERY_MISSING,
this._showInstance)):this._showInstance(),this.show())};a.positionData.prototype.clear=function(){this._waitForElement&&this._waitForElement.cancel();this._messageInstance&&(this._messageInstance.clear()&&this.isPopup()&&a.popup.hide(),this._messageInstance.clearTimers());this._isCleared=!0;this._waitForElement=this._messageInstance=void 0;this._isTriggered=this._hasTriggerEvent=this.hidden=!1;a.events.off(a.EVENT_TRIGGER_FIRE,this._onTriggerEvent);a.events.off(a.EVENT_JQUERY_READY,this._showInstance);
a.events.off(a.ERROR_SITE_JQUERY_MISSING,this._showInstance)};a.positionData.prototype.getMessageInstance=function(){return this._messageInstance};a.positionData.prototype.setMessage=function(f){if(!a.internal.isMessage(f))throw new y('Invalid type for "message" argument, got "'+a.utils.getType(f)+'" for '+this.position);this.message=f};a.positionData.prototype.isMatchingUrl=function(f){if(a.utils.isArray(this.rules)&&this.rules.length){var g=new a.baseEvaluator;f&&g.setEvaluatorValue("location",
f);g.setErrorOptions({type:a.ERROR_TYPE_POSITION_EXCEPTION,level:a.LOG_LEVEL_ERROR,module:a.MODULE_POSITION,positionId:this.position});f=g.evaluate(this.rules);!f&&a.console.isEnabled()&&g.printTrace("easy.positionData - "+this.position);return f}if(a.utils.isArray(this.urlMatch)&&0<this.urlMatch.length){var d=a.utils.getLocationFromUrl(f);return a.utils.some(this.urlMatch,function(e){var b=a.evaluator.getMatcherFunction(e[0]);return a.evaluator.matchUrl(b,e[1],e[2]||{},e[3]||{},d)})}return!0};a.positionData.prototype._setPriorityLevel=
function(){var f={matchExact:0,matchBegins:1,matchRegex:2},g=9999;a.utils.each(this.urlMatch,function(a){a=a[0];f.hasOwnProperty(a)&&(a=f[a],a<g&&(g=a))});this.priorityLevel=g};J.defineProperties(a.positionData.prototype,{METHOD_HIDE:{value:"hide"},METHOD_REPLACE:{value:"replace"},METHOD_RENEW:{value:"renew"},METHOD_BEFORE:{value:"before"},METHOD_AFTER:{value:"after"},METHOD_PREPEND:{value:"prepend"},METHOD_APPEND:{value:"append"},HIDDEN_CLASS:{value:"frosmo-message-hidden"},SELECTOR_TYPE_CSS:{value:"css"},
SELECTOR_TYPE_JQUERY:{value:"jquery"},SELECTOR_TYPE_POPUP:{value:"popup"},SELECTOR_TYPE_V1:{value:"v1"}});a.popup=function(){function f(){if(!A.body)throw a.internal.createLogError("Body not found",a.ERROR_TYPE_SELECTOR_INVALID,{module:a.internal.getCurrentModule()});var d;(d=a.domElements.selector(g())[0])||(b&&c||(b=A.createElement("div"),c=A.createElement("div"),b.setAttribute("id","frosmoPopupBackground"),c.setAttribute("id","frosmoPopup"),A.body.appendChild(b),A.body.appendChild(c)),d=c);return d}
function g(){return"#frosmoPopup"}function d(){b.style.display="none";c.style.display="none";a.domEvents.off(b,"click."+a.DOM_EVENT_NAMESPACE,d);a.domEvents.off(a.domElements.selector(".frosmoPopupClose",c),"click."+a.DOM_EVENT_NAMESPACE,d)}function e(e,g){g=g||{};f();var n={args:{message:g.message,positionData:g,easy:x.easy,site:x.site}};g.message&&(n.scriptNamespace=a.MESSAGE_SCRIPT_ID+g.message.id,n.styleNamespace=a.MESSAGE_STYLE_ID+g.message.id);a.domElements.html(c,e,n);a.domEvents.on(b,"click."+
a.DOM_EVENT_NAMESPACE,d);a.domEvents.on(a.domElements.selector(".frosmoPopupClose",c),"click."+a.DOM_EVENT_NAMESPACE,d);c.style.display="block";b.style.display="block"}var b,c;return{create:f,getId:g,hide:d,render:function(b,c){b.renderer="easy.popup.renderer."+E.now();a.message.addCustomRenderer(b.renderer,function(a){var b=a.getMessageInstance();e(b.content,a);b.startTracking();b.setTrueDisplayed()});a.domEvents.ready(function(){f();b.render(c)})},show:e}}();a.visitsHistory=function(){function f(a){for(var b in c)if(a===
b)return!0;return!1}function g(b,c,d){if(!b||a.utils.isString(b))return[c];var e=[];e.push(c);for(c=0;c<b.length;c+=1){var f=b[c];8===f.length&&e.push(f);if(e.length>=d)break}return e}function d(b,d,e){var l=[];a.utils.each(d,function(d,r){if(!(null===d||f(d[4])&&c[d[4]](r,a.context.pageVisits,e))){var w=d[2]||{},v=a.evaluator.getMatcherFunction(d[0]);a.evaluator.matchUrl(v,d[1],w,a.config.anchorEnabled&&d[3]?d[3]:{},b)&&(a.context.pageVisits[r]=g(a.context.pageVisits[r],e,20),l.push(r),a.context.sessionPathVisits[r]=
1)}});return l}function e(b,d,e,l){var k=!1,u=[];a.utils.each(d,function(d,v){var t,r;if(null!==d){t=d[2]||{};r=a.evaluator.getMatcherFunction(d[0]);var G=d[1],C=a.config.anchorEnabled&&d[3]?d[3]:{},x=f(d[4])?d[4]:!1;a.evaluator.matchUrl(r,G,t,C,b)&&((r=a.config.sharedPages[v])?(k=!0,t=l):(t=a.context.pageVisits,r=v),x&&c[x](r,t,e)||(t[r]=g(t[r],e,20),u.push(r),a.context.sessionPathVisits[v]=1))}});k&&a.sharedPagesRpc.set("sharedPages",l);a.sharedContext.pageVisits=a.utils.clone(l);return u}function b(a,
b){return a+"\n"+b}var c={day:function(b,c,d){var e=!1;a.utils.each(c[b],function(a){a===d&&(e=!0)});return e},visit:function(b){return a.context.sessionPathVisits[b]}};return{addPageVisit:function(b,c,f,g){var k,u=a.utils.getDateInContextFormat(f),w=a.utils.getLocationFromUrl(b.href);a.config.sharedPages?a.sharedPagesRpc.get("sharedPages").then(function(a){k=e(w,c,u,a||{});g(k)}):(k=d(w,c,u),g(k))},addSiteVisit:function(b){b=a.utils.getDateInContextFormat(b);a.context.siteVisits=g(a.context.siteVisits,
b,20)},shiftDateArray:g,addCustomAction:function(b,c){var d=a.utils.getDateInContextFormat(c);a.context.customActions[b]=g(a.context.customActions[b],d,20)},addMetaCount:function(b,c){var d=a.utils.getDateInContextFormat(c);a.context.metaCount[b]=g(a.context.metaCount[b],d,20)},addConversion:function(c,d,e){var f=a.utils.getDateInContextFormat(e);a.context.conversions[c]=g(a.context.conversions[c],f,20);if(d){var k=b(c,d);c=b(c,d)+"\nlast";a.context.conversions[k]=g(a.context.conversions[k],f,20);
a.context.conversions[c]=a.utils.getTimestamp(e)}},getConversionIdKey:b,getConversionLastTime:function(c,d){var e=b(c,d)+"\nlast";return a.context.conversions[e]}}}();a.styles="#frosmoPopup{display:none;position:fixed;top:10%;background-color:#fff;-moz-opacity:1;opacity:1;filter:alpha(opacity=100);border:1px solid #000;z-index:1002;-moz-box-shadow:0 0 30px #000;-webkit-box-shadow:0 0 30px #000;border-radius:7px;box-shadow:0 0 30px #000;width:560px;margin-left:-280px;left:50%;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;padding:10px 15px;overflow:auto}.frosmoPopupHeader{background-repeat:no-repeat}.frosmoPopupHeader h1{margin:10px}.frosmoPopupHeader .frosmoPopupClose{display:inline-block;float:right;background:transparent;border:none;font-size:20px;font-weight:bold;line-height:20px;cursor:pointer;margin:0;opacity:.4}.frosmoPopupHeader .frosmoPopupClose:hover{opacity:.8}.frosmoPopupContent{clear:both;position:relative;max-height:400px;overflow:auto;margin-bottom:15px;padding:0 10px 10px}.frosmoPopupFooter{display:block;text-align:right}.frosmoPopupFooter button{background:#ccc;border:none;padding:5px 10px;cursor:pointer;border-radius:4px}.frosmoPopupFooter button:hover{background:#aaa}#frosmoPopupBackground{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000;z-index:1001;-moz-opacity:.7;opacity:.7;filter:alpha(opacity=70);margin:0;padding:0}#frosmoPopup.frosmoPopupMaxWidth640{width:auto;left:auto;margin-left:10px;margin-right:10px}@media(max-width:640px){#frosmoPopup{width:auto;left:auto;margin-left:10px;margin-right:10px}}@media(max-height:640px){.frosmoPopupContent{max-height:200px}}@media(max-height:840px){.frosmoPopupContent{max-height:400px}}@media(min-height:841px){.frosmoPopupContent{max-height:600px}}.frosmo-message-hidden{visibility:hidden!important}";
a.customAction=function(){var f;return{init:function(g){f=g;f.rules&&a.customActionRules.init(f.rules)},trigger:function(g,d,e){var b='Name: "'+g+'", Value: "'+d+'", Title: "'+e+'"';if(!f)return a.log.error("Custom actions not initialized, due to initalization failure",a.ERROR_TYPE_CUSTOM_ACTION_INVALID,{module:a.internal.getCurrentModule(),debug:b}),!1;if(!a.utils.isString(g))return a.log.error('Invalid type for custom action "name" argument, got "'+a.utils.getType(g)+'" for "'+g+'"',a.ERROR_TYPE_CUSTOM_ACTION_INVALID,
{module:a.internal.getCurrentModule(),debug:b}),!1;var c=a.utils.getType(d);if(!a.utils.inArray(["string","boolean","number"],c))return a.log.error('Invalid type for custom action "value" argument, got "'+c+'" for "'+d+'"',a.ERROR_TYPE_CUSTOM_ACTION_INVALID,{module:a.internal.getCurrentModule(),debug:b}),!1;if(!g||128<g.length)return a.log.error('Invalid custom action "name" argument length, for "'+g+'"',a.ERROR_TYPE_CUSTOM_ACTION_INVALID,{module:a.internal.getCurrentModule(),debug:b}),!1;d=B(d);
if(!d||128<d.length)return a.log.error('Invalid custom action "value" argument length, for "'+d+'"',a.ERROR_TYPE_CUSTOM_ACTION_INVALID,{module:a.internal.getCurrentModule(),debug:b}),!1;var h=f.date||new E,b=a.utils.reduce(f.segments,function(b,c,e){g===c.name&&a.utils.inArray(c.values,d)&&(a.visitsHistory.addCustomAction(e,h),b.push(e));return b},[]);0<b.length&&(a.segmentchange.evaluate({customActions:b},h),a.context.save());a.utils.inArray(f.states,g)&&a.states.set(g,d);a.events.trigger(a.EVENT_CUSTOMACTION,
g,d);c=a.EVENT_CUSTOMACTION+"."+g;a.events.trigger(c,g,d);a.events.trigger(c+"."+d,g,d);a.api.sendCustomAction(g,d,e);return 0<b.length}}}();a.customActionRules=function(){function f(e){if(x.geo)a.events.on(a.EVENT_LOCATION,function(a){d(e,a)});else a.log.send("Geolocation module not found",a.ERROR_TYPE_MODULE_MISSING,{level:a.LOG_LEVEL_CRITICAL})}function g(a){switch(a.type){case "geolocation":f(a)}}function d(d,b){var c={lat:b.latitude,lon:b.longitude};a.utils.each(d.rules,function(b,f){var g=L(b[2]);
x.geo.getCircleDistance(c,{lat:b[0],lon:b[1]})<=g&&a.customAction.trigger(d.name,f)})}return{init:function(d){a.utils.each(d,g)},initGeolocation:f,initRule:g}}();a.location=function(){function f(a,b){var d={text:a,type:b,status:0,url:"",method:"getNative"},e;try{e=x.JSON.stringify(d)}catch(f){e='{"text":"Unexpected error with navigator.geolocation (default)","type":"'+b+'","status":-1,"url":"","method":"getNative"}'}return[d,e]}function g(b,d,e,f){a.utils.isFunction(b)&&a.runGuarded(b,[e]);d(e);a.log.warn("Unexpected error occurred with requesting the location",
"location_"+e.type,{debug:f});a.events.trigger(a.EVENT_LOCATION_FAILURE,e)}function d(b,d,e){a.utils.isFunction(b)&&a.runGuarded(b,[e]);d(e);a.events.trigger(a.EVENT_LOCATION,e)}var e={enableHighAccuracy:!1,maximumAge:0,timeout:5E3},b={country2:"",ip:"",isp:"",latitude:0,longitude:0,city:"",regionCode:""};return{get:function(c,e){var f,n,l=new a.Promise(function(a,b){f=a;n=b});if(a.utils.isMobile())return d(c,f,a.utils.clone(b)),l;var k=a.api.getApiUrl("location");if(!k)return d(c,f,a.utils.clone(b)),
l;a.fetch.get(k,{dataType:"text",success:function(a,b,e){a={city:e.getResponseHeader("X-City"),country2:e.getResponseHeader("X-Country2"),ip:e.getResponseHeader("X-Real-IP"),isp:e.getResponseHeader("X-ISP"),latitude:L(e.getResponseHeader("X-latitude"))||0,longitude:L(e.getResponseHeader("X-longitude"))||0,regionCode:e.getResponseHeader("X-Region-Code")};d(c,f,a)},error:function(a,b,c,d){g(e,n,c,d)}});return l},getNative:function(c,h,r){var n,l,k=new a.Promise(function(a,b){n=a;l=b}),u=a.utils.parseUri(a.main.getCurrentBrowserData().href).protocol;
if("https"!==u)return r=f('Invalid protocol of "'+u+'", only "https" is supported',a.ERROR_TYPE_ARG_INVALID),g(h,l,r[0],r[1]),k;if(!P||!P.geolocation)return r=f("navigator.geolocation is not available",a.ERROR_TYPE_MODULE_MISSING),g(h,l,r[0],r[1]),k;u=r=a.utils.extend({},e,r);P.geolocation.getCurrentPosition(function(e){var f=a.utils.clone(b);f.latitude=e.coords.latitude;f.longitude=e.coords.longitude;d(c,n,f)},function(b){b=f(b.message,a.ERROR_TYPE_EXCEPTION);g(h,l,b[0],b[1])},u);return k}}}();a.dataLayer=
function(){function f(b){if(!a.utils.isArray(b.transactionProducts))throw new y('Invalid type for conversion "transactionProducts" property, got "'+a.utils.getType(b.transactionProducts)+'"');return a.utils.map(b.transactionProducts,function(a){return{conversion_id:a.id||a.sku||a.name,conversion_name:a.name,conversion_value:L(a.price),conversion_quantity:a.quantity,conversion_type:a.category,transaction_id:b.transactionId,payment_channel:b.transactionPaymentType||null}})}function g(a){return{conversion_id:a.conversionId,
conversion_name:a.frosmoConversionName,conversion_value:a.conversionValue,conversion_type:a.conversionType}}function d(a){return{product_id:a.frosmoProductId,product_name:a.frosmoProductName,product_price:a.frosmoProductPrice,product_type:a.frosmoProductCategory,product_image:a.frosmoProductImage,product_url:a.frosmoProductUrl,product_discount_price:a.frosmoProductDiscountPrice,product_promotion_label:a.frosmoProductPromotionLabel,product_area:a.frosmoProductArea,product_campaign:a.frosmoProductCampaign,
product_categories:a.frosmoProductCategories,product_category:a.frosmoProductMainCategory,product_city:a.frosmoProductCity,product_colors:a.frosmoProductColors,product_company:a.frosmoProductCompany,product_conversion:a.frosmoProductConversion,product_country:a.frosmoProductCountry,product_custom_images:a.frosmoProductCustomImages,product_data:a.frosmoProductData,product_description:a.frosmoProductDescription,product_ids:a.frosmoProductIds,product_manufacturer:a.frosmoProductManufacturer,product_model:a.frosmoProductModel,
product_multi_prices:a.frosmoProductMultiPrices,product_rating:a.frosmoProductRating,product_stock:a.frosmoProductStock,product_sub_category:a.frosmoProductSubCategory,product_urn:a.frosmoProductUrn,product_venue:a.frosmoProductVenue}}function e(){z=window.dataLayer.push;window.dataLayer.push=function(){var c=a.utils.arrayFrom(arguments),d=z.apply(window.dataLayer,c);b(c);return d}}function b(b){a.utils.each(b,function(b){b&&(G(b),a.events.trigger(a.EVENT_DATALAYER,b))})}function c(b){if(!a.utils.isArray(b.transactionProducts))throw new y('Invalid type for "transactionProducts" property, got "'+
a.utils.getType(b.transactionProducts)+'"');var c=a.utils.map(b.transactionProducts,function(a){return{id:a.id||a.sku||a.name,value:L(a.price),quantity:I(a.quantity,10)||1}}),d=a.utils.map(c,function(b){b=a.utils.clone(b);b.value*=b.quantity;return b}),e=b.transactionTotal||a.utils.reduce(d,function(a,b){return a+b.value},0);a.api.transaction(null,"transaction",b.transactionId,e,d);a.events.trigger(a.EVENT_CONVERSION,{id:"transaction",type:"transaction",transactionId:b.transactionId,value:e,products:c});
a.utils.each(c,function(b){for(var c={id:b.id,value:b.value},d=0;d<b.quantity;d++)a.events.trigger(a.EVENT_PRODUCT_PURCHASE,c)})}function h(b){b=f(b);a.utils.each(b,function(b){a.conversions.push(b)});a.conversion.handleConversionArray("dataLayer_module",b.length)}function r(b){return function(c,d){if(!a.utils.isNumeric(d))return'Invalid type for "'+c+'" product attribute, got "'+a.utils.getType(d)+'", expected "numerical" value';var e=x.JSON.stringify(d).length;if(e>b)return'Invalid length for "'+
c+'" product attribute, got '+e+", expected less than or equal to "+b}}function n(a){return'Invalid "'+a+'" product attribute, this is read-only and maintained by the Frosmo Platform'}function l(b){return function(c,d){if(!a.utils.isString(d))return'Invalid type for "'+c+'" product attribute, got "'+a.utils.getType(d)+'", expected "string" type';var e=a.utils.trim(d).length;if(e>b)return'Invalid length for "'+c+'" product attribute, got '+e+", expected less than or equal to "+b}}function k(b){var c=
[];a.utils.each(C,function(d,e){if(d.required){var f=b[e];(a.utils.isNil(f)||""===a.utils.trim(f))&&c.push('Missing "'+e+'" product attribute, expected to be defined as a "string" type')}});a.utils.each(b,function(a,b){var d=C[b];(d=d?d.validator(b,a):A(b,a))&&c.push(d)});return c}function u(b){var c={};a.utils.each(b,function(b,d){var e=C[d];e&&e.transformer?c[d]=e.transformer(b):a.utils.isString(b)?c[d]=a.utils.trim(b):c[d]=b});return c}function w(b){var c={},d={};a.utils.each(b,function(a,b){var e=
C[b];e?c[e.evtAlias]=c[b]=a:(c[b]=a,d[b]=a)});void 0===b.data&&(c.product_data=c.data=x.JSON.stringify(d));return c}function v(){t&&window.dataLayer===t||(window.dataLayer=window.dataLayer||[],t=window.dataLayer,b(window.dataLayer),e())}var t,z,G=function(b){b.transactionProducts?a.config.transactionApi?c(b):h(b):b.frosmoProductId?(a.products.push(d(b)),a.conversion.handleProductArray("dataLayer_module",1)):b.conversionId?(a.conversions.push(g(b)),a.conversion.handleConversionArray("dataLayer_module",
1)):b.frosmoEvent?a.customAction.trigger(B(b.frosmoEvent),B(b.frosmoValue)):(b=a.utils.getByDotString("frosmo.view.products",b),a.utils.isArray(b)&&a.utils.each(b,function(b){var c=k(b);a.utils.isEmpty(c)?(b=u(b),c=w(b),a.console.log("[dataLayer]",'Product sent with the product type "'+c.type+'" and product name "'+c.name+'"'),a.events.trigger(a.EVENT_PRODUCT_DATA,c),a.api.setProductDataPayload(b,null)):a.log.error("Invalid product data payload",a.ERROR_TYPE_ARG_INVALID,{debug:x.JSON.stringify({errors:c,
product:b})})}))},C={id:{evtAlias:"product_id",required:!0,validator:l(256)},availability:{evtAlias:"product_availability",required:!1,validator:function(b){return function(c,d){if(!a.utils.inArray(b,d))return'Invalid value for "'+c+'" product attribute, got "'+d+'", expected one of: "'+b.join('", "')+'"'}}(["in stock","out of stock","preorder"])},brand:{evtAlias:"product_brand",required:!1,validator:l(2048)},categories:{evtAlias:"product_categories",required:!1,validator:function(b){return function(c,
d){if(!a.utils.isArray(d)||a.utils.some(d,function(b){return!a.utils.isString(b)}))return'Invalid type for "'+c+'" product attribute, got "'+a.utils.getType(d)+'", expected "array" type containing "string" types';var e=x.JSON.stringify(d).length;if(e>b)return'Invalid length for "'+c+'" product attribute, got '+e+", expected less than or equal to "+b}}(2048)},image:{evtAlias:"product_image",required:!1,validator:l(2048)},name:{evtAlias:"product_name",required:!1,validator:l(256)},originalPrice:{evtAlias:"product_original_price",
required:!1,validator:r(2048),transformer:M},parentId:{evtAlias:"product_parent_id",required:!1,validator:function(b,c){return function(d,e){if(null!==e){if(!a.utils.isString(e))return'Invalid type for "'+d+'" product attribute, got "'+a.utils.getType(e)+'", expected "null" or "string" type';var f=a.utils.trim(e).length;if(f<b)return'Invalid length for "'+d+'" product attribute, got '+f+", expected greater than or equal to "+b;if(f>c)return'Invalid length for "'+d+'" product attribute, got '+f+", expected less than or equal to "+
c}}}(1,256)},price:{evtAlias:"product_price",required:!1,validator:r(2048),transformer:M},type:{evtAlias:"product_type",required:!1,validator:l(256)},url:{evtAlias:"product_url",required:!1,validator:l(2048)},created_at:{validator:n},updated_at:{validator:n},feed_updated_at:{validator:n}},A=function(b){return function(c,d){a.utils.isString(d)&&(d=a.utils.trim(d));var e=x.JSON.stringify(d).length;if(e>b)return'Invalid length for "'+c+'" product attribute, got '+e+", expected less than or equal to "+
b}}(2048);return{init:function(){v();a.utils.setInterval(v,1E3)},convertToConversions:f,convertToConversion:g,convertToProduct:d,handleItem:G,setHandleItem:function(b){G=a.guard(b,{module:a.internal.getCurrentModule()})}}}();a.user=function(){return{init:function(){a.states.set("loginStatus",a.user.getLoginId()?"authenticated":"unauthenticated")},getLoginId:function(){return a.context.loginId},login:function(f){a.context.loginId=f;a.context.save();a.api.login(f,a.context.referer.host);a.states.set("loginStatus",
"authenticated");a.events.trigger(a.EVENT_LOGIN);return!0},logout:function(){a.context.loginId=null;a.context.save();a.states.set("loginStatus","unauthenticated");a.events.trigger(a.EVENT_LOGOUT);return!0}}}();a.googleAnalytics=function(){var f;return{init:function(g){f=a.utils.clone(g);if(!f.trackingId)return!1;f.trackDisplays&&a.googleAnalytics.trackEvent(a.EVENT_MESSAGE_SHOW,f.eventActionDisplay,!0);f.trackTrueDisplays&&a.googleAnalytics.trackEvent(a.EVENT_MESSAGE_TRUE_DISPLAY,f.eventActionTrueDisplay,
!0);f.trackClicks&&a.googleAnalytics.trackEvent(a.EVENT_MESSAGE_CLICK,f.eventActionClick,!1);return!0},getEventLabel:function(a){var d="#"+a.id+"."+(999===a.revision?"CG":a.revision);a.title&&(d+=" "+a.title);return d},getClassicTracker:function(){if(window._gat&&a.utils.isFunction(window._gat._getTrackers)){var g=window._gat._getTrackers();return a.utils.find(g,function(a){return f.trackingId===a._getAccount()})}},getUniversalTracker:function(){if(window.ga&&a.utils.isFunction(window.ga.getAll)){var g=
window.ga.getAll();return a.utils.find(g,function(a){return f.trackingId===a.get("trackingId")})}},isEnabled:function(a){return void 0===a.gaTracking||a.gaTracking},sendClassicEvent:function(g,d,e){var b=a.googleAnalytics.getClassicTracker();if(b){var c=f.eventCategory;g=a.googleAnalytics.getEventLabel(g);b._trackEvent(c,d,g,0,e)}else a.console.error("[googleAnalytics]",'Unable to find the classic tracker for id "'+f.trackingId+'"')},sendEvent:function(g,d,e){var b={level:a.LOG_LEVEL_WARNING,module:a.MODULE_MESSAGE,
messageId:g.id,revisionId:g.revision,debug:'Action: "'+d+'"'},c=a.utils.extend({type:a.ERROR_TYPE_GA_EXCEPTION},b),c=a.guard(function(){var b=!1;window.ga&&a.googleAnalytics.getUniversalTracker()&&(b=!0,window.ga(function(){a.googleAnalytics.sendUniversalEvent(g,d,e)}));window._gaq&&a.googleAnalytics.getClassicTracker()&&(b=!0,window._gaq.push(function(){a.googleAnalytics.sendClassicEvent(g,d,e)}));b&&a.debug.addEntry("google_analytics",{messageId:g.id,revisionId:g.revision,action:d,category:f.eventCategory,
label:a.googleAnalytics.getEventLabel(g)});return b},c);a.utils.waitFor(100,a.GA_INIT_TIMEOUT,c,function(){a.log.warn("GA not found, but enabled for the site/message",a.ERROR_TYPE_GA_MISSING,b)})},sendUniversalEvent:function(g,d,e){var b=a.googleAnalytics.getUniversalTracker();if(b){var c=f.eventCategory;g=a.googleAnalytics.getEventLabel(g);b.send("event",c,d,g,0,{nonInteraction:e})}else a.console.error("[googleAnalytics]",'Unable to find the universal tracker for id "'+f.trackingId+'"')},trackEvent:function(f,
d,e){a.events.on(f,function(b){a.googleAnalytics.isEnabled(b)&&a.googleAnalytics.sendEvent(b,d,e)})}}}();(function(a){function g(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function d(a,b,c,d,e,f){a=g(g(b,a),g(d,f));return g(a<<e|a>>>32-e,c)}function e(a,b,c,e,f,g,h){return d(b&c|~b&e,a,b,f,g,h)}function b(a,b,c,e,f,g,h){return d(b&e|c&~e,a,b,f,g,h)}function c(a,b,c,e,f,g,h){return d(c^(b|~e),a,b,f,g,h)}function h(a,f){a[f>>5]|=128<<f%32;a[(f+64>>>9<<4)+14]=f;var h,l,
n,r,u,q=1732584193,k=-271733879,m=-1732584194,p=271733878;for(h=0;h<a.length;h+=16)l=q,n=k,r=m,u=p,q=e(q,k,m,p,a[h],7,-680876936),p=e(p,q,k,m,a[h+1],12,-389564586),m=e(m,p,q,k,a[h+2],17,606105819),k=e(k,m,p,q,a[h+3],22,-1044525330),q=e(q,k,m,p,a[h+4],7,-176418897),p=e(p,q,k,m,a[h+5],12,1200080426),m=e(m,p,q,k,a[h+6],17,-1473231341),k=e(k,m,p,q,a[h+7],22,-45705983),q=e(q,k,m,p,a[h+8],7,1770035416),p=e(p,q,k,m,a[h+9],12,-1958414417),m=e(m,p,q,k,a[h+10],17,-42063),k=e(k,m,p,q,a[h+11],22,-1990404162),
q=e(q,k,m,p,a[h+12],7,1804603682),p=e(p,q,k,m,a[h+13],12,-40341101),m=e(m,p,q,k,a[h+14],17,-1502002290),k=e(k,m,p,q,a[h+15],22,1236535329),q=b(q,k,m,p,a[h+1],5,-165796510),p=b(p,q,k,m,a[h+6],9,-1069501632),m=b(m,p,q,k,a[h+11],14,643717713),k=b(k,m,p,q,a[h],20,-373897302),q=b(q,k,m,p,a[h+5],5,-701558691),p=b(p,q,k,m,a[h+10],9,38016083),m=b(m,p,q,k,a[h+15],14,-660478335),k=b(k,m,p,q,a[h+4],20,-405537848),q=b(q,k,m,p,a[h+9],5,568446438),p=b(p,q,k,m,a[h+14],9,-1019803690),m=b(m,p,q,k,a[h+3],14,-187363961),
k=b(k,m,p,q,a[h+8],20,1163531501),q=b(q,k,m,p,a[h+13],5,-1444681467),p=b(p,q,k,m,a[h+2],9,-51403784),m=b(m,p,q,k,a[h+7],14,1735328473),k=b(k,m,p,q,a[h+12],20,-1926607734),q=d(k^m^p,q,k,a[h+5],4,-378558),p=d(q^k^m,p,q,a[h+8],11,-2022574463),m=d(p^q^k,m,p,a[h+11],16,1839030562),k=d(m^p^q,k,m,a[h+14],23,-35309556),q=d(k^m^p,q,k,a[h+1],4,-1530992060),p=d(q^k^m,p,q,a[h+4],11,1272893353),m=d(p^q^k,m,p,a[h+7],16,-155497632),k=d(m^p^q,k,m,a[h+10],23,-1094730640),q=d(k^m^p,q,k,a[h+13],4,681279174),p=d(q^k^
m,p,q,a[h],11,-358537222),m=d(p^q^k,m,p,a[h+3],16,-722521979),k=d(m^p^q,k,m,a[h+6],23,76029189),q=d(k^m^p,q,k,a[h+9],4,-640364487),p=d(q^k^m,p,q,a[h+12],11,-421815835),m=d(p^q^k,m,p,a[h+15],16,530742520),k=d(m^p^q,k,m,a[h+2],23,-995338651),q=c(q,k,m,p,a[h],6,-198630844),p=c(p,q,k,m,a[h+7],10,1126891415),m=c(m,p,q,k,a[h+14],15,-1416354905),k=c(k,m,p,q,a[h+5],21,-57434055),q=c(q,k,m,p,a[h+12],6,1700485571),p=c(p,q,k,m,a[h+3],10,-1894986606),m=c(m,p,q,k,a[h+10],15,-1051523),k=c(k,m,p,q,a[h+1],21,-2054922799),
q=c(q,k,m,p,a[h+8],6,1873313359),p=c(p,q,k,m,a[h+15],10,-30611744),m=c(m,p,q,k,a[h+6],15,-1560198380),k=c(k,m,p,q,a[h+13],21,1309151649),q=c(q,k,m,p,a[h+4],6,-145523070),p=c(p,q,k,m,a[h+11],10,-1120210379),m=c(m,p,q,k,a[h+2],15,718787259),k=c(k,m,p,q,a[h+9],21,-343485551),q=g(q,l),k=g(k,n),m=g(m,r),p=g(p,u);return[q,k,m,p]}function r(a){var b,c="",d=32*a.length;for(b=0;b<d;b+=8)c+=B.fromCharCode(a[b>>5]>>>b%32&255);return c}function n(a){var b,c=[];c[(a.length>>2)-1]=void 0;for(b=0;b<c.length;b+=
1)c[b]=0;var d=8*a.length;for(b=0;b<d;b+=8)c[b>>5]|=(a.charCodeAt(b/8)&255)<<b%32;return c}function l(a){return r(h(n(a),8*a.length))}function k(a,b){var c,d=n(a),e=[],f=[];e[15]=f[15]=void 0;16<d.length&&(d=h(d,8*a.length));for(c=0;16>c;c+=1)e[c]=d[c]^909522486,f[c]=d[c]^1549556828;c=h(e.concat(n(b)),512+8*b.length);return r(h(f.concat(c),640))}function u(a){var b="",c,d;for(d=0;d<a.length;d+=1)c=a.charCodeAt(d),b+="0123456789abcdef".charAt(c>>>4&15)+"0123456789abcdef".charAt(c&15);return b}a.md5=
function(a,b,c){b?c?a=k(Y(O(b)),Y(O(a))):(a=k(Y(O(b)),Y(O(a))),a=u(a)):a=c?l(Y(O(a))):u(l(Y(O(a))));return a}})(a);a.quickContext=function(){function f(){return a.utils.clone(n)}function g(b){b=a.utils.clone(b);n=a.utils.extend(n,b);b.segments=a.utils.map(b.segments,function(a,b){return I(b.replace(/sgmt_/,""),10)});0===b.segments.length&&delete b.segments;a.utils.isEmpty(b.lastDisplayTime)&&delete b.lastDisplayTime;a.utils.isEmpty(b.lastRevisionId)&&delete b.lastRevisionId;a.cookies.set(a.COOKIE_QUICK_CONTEXT,
x.JSON.stringify(b),365)}function d(b){return a.utils.reduce(b,function(a,b,c){c=I(c,10);k[c]&&(a[c]=b);return a},{})}function e(b){return a.utils.reduce(u,function(a,c,d){b[d]&&(a[d]=1);return a},{})}function b(c){return a.utils.reduce(c,function(c,d){if(a.utils.isArray(d))c=c.concat(b(d));else{var e=d.match(/sgmt_\d+/);e&&(c=c.concat(e))}return c},[])}function c(b){var c=x.JSON.safeParse(a.cookies.get(a.COOKIE_QUICK_CONTEXT));if(c){switch(c.VERSION){case "1.1.0":c.segments=a.utils.reduce(c.segments,
function(a,b){a["sgmt_"+b]=1;return a},{})}n.UID=c.UID;n.origin=c.origin;n.lastPageView=c.lastPageView||n.lastPageView;a.utils.each(d(c.lastDisplayTime),function(a,b){r("lastDisplayTime",b,a)});a.utils.each(d(c.lastRevisionId),function(a,b){r("lastRevisionId",b,a)});n.segments=e(c.segments);c.profile&&(n.profile=c.profile);c.states&&(n.states.session=a.utils.extend({},c.states.session))}c=E.now();c-n.lastPageView.time>=a.main.VISIT_TIMEOUT&&(n.states.session={});n.lastPageView.time=c;null===n.UID&&
(n.UID=a.uid.newUid(b),n.origin=a.config.api.origin);g(n)}function h(){a.events.once(a.EVENT_INIT_UID,function(a){n.UID=a;g(n)});a.ready(function(){n.lastPageView.time=a.context.lastPageView.time;n.segments=e(a.context.segments);g(n)});a.events.on(a.EVENT_SEGMENT_ENTER,function(a){u[a]&&(n.segments[a]=1,g(n))});a.events.on(a.EVENT_SEGMENT_LEAVE,function(a){n.segments[a]&&(delete n.segments[a],g(n))});a.events.on(a.EVENT_STATE_SET,function(b,c,d){d===a.STATE_TYPE_SESSION&&(n.states.session[b]=c,g(n))});
a.events.on(a.EVENT_STATE_REMOVE,function(a){void 0!==n.states.session[a]&&(delete n.states.session[a],g(n))});a.events.on(a.EVENT_MESSAGE_SHOW,function(b){k[b.id]&&r("lastDisplayTime",b.id,a.utils.getTimestamp())&&r("lastRevisionId",b.id,b.revision)&&g(n)})}function r(a,b,c){b=I(b,10);c=I(c,10);if(!b||!c)return!1;n[a][b]=c;return!0}var n,l={VERSION:"1.1.0",UID:null,origin:null,lastDisplayTime:{},lastRevisionId:{},lastPageView:{time:0},segments:{},states:{session:{}}},k={},u={};return{init:function(d,
e){n=n||a.utils.clone(l);k=a.utils.reduce(d,function(a,b){a[b.id]=1;return a},{});a.utils.each(d,function(c){a.utils.each(b(c.segmentRules),function(a){u[a]=1})});c(e);h();a.events.trigger(a.EVENT_INIT_QUICK_CONTEXT,f())},get:f,getLastDisplayTime:function(a){return n.lastDisplayTime[a]},getLastDisplayRevision:function(a){return n.lastRevisionId[a]},remove:function(){n=a.utils.clone(l);k={};u={};a.cookies.exists(a.COOKIE_QUICK_CONTEXT)&&a.cookies.remove(a.COOKIE_QUICK_CONTEXT)},save:g,_getSegmentsFromRules:b}}();
a.quickMessage=function(){function f(b){b=a.utils.clone(b);b.options=a.utils.extend({displayDelay:0,maxDisplayTimes:0},b.options);var c=b.revision;delete b.revisions;b.content=c.content||"";b.messageName="";b.revision=c.id;b.revisionType=c.type;b.title=c.title;c.template&&(b.template=c.template);return b}function g(b,c,d){return a.utils.map(c,function(c,e){var g=a.message.getPosition(e);g instanceof a.positionData||(g=new a.positionData(g,d),a.console.error("[quickMessage]","Invalid type for "+e+
", must be an instance of easy.positionData"));var h=f(b[c]);g.setMessage(h);return g})}function d(b,c){return a.utils.filter(b,function(b){return b.revision&&a.quickMessageEvaluator.evaluate(b,c)})}function e(d,e){return a.utils.map(d,function(d){d.lastShownRevision=b(d);e&&(d.revision=c(d.revisions,999,!1));d.revision||(d.revision=c(d.revisions,d.lastShownRevision,!0),d.revision||(d.revision=c(d.revisions,a.quickRevisions.getRandId(d.revisions),!0)));return d})}function b(b){return!1===b.revisionsLock?
a.quickRevisions.getRandId(b.revisions):a.quickContext.getLastDisplayRevision(b.id)}function c(b,c,d){return!c||d&&999===c?void 0:a.utils.find(b,function(a){return c===a.id})}function h(a){a.sort(function(a,b){return a.priorityLevel!==b.priorityLevel?b.priorityLevel-a.priorityLevel:a.selected!==b.selected?a.selected-b.selected:a.lastShown-b.lastShown})}function r(b){var c={};a.utils.each(b,function(b){a.utils.each(b.positions,function(a){c[a]=c[a]||[];b.lastShown=b.lastShown||0;b.selected=0;c[a].push(b)})});
b=a.utils.map(c,function(a,b){return I(b,10)}).sort(function(a,b){return a-b});var d=0;return a.utils.reduce(b,function(a,b){var e=c[b];h(e);a[b]=e[0].id;e[0].selected=++d;return a},{})}var n;return{init:function(b,c){a.utils.isEmpty(b)?a.quickContext.remove():(a.quickContext.init(b,c),n={},a.utils.each(b,function(a){n[a.id]=a}))},requestMessages:function(){if(n&&!a.preview.getParams()){var b=a.quickContext.get();a.profile&&a.profile.validate(b.profile);var c=a.uid.isInComparisonGroup(b.UID),f=a.utils.clone(n),
c=e(f,c),b=d(c,b),b=a.utils.map(b,function(b){return{id:b.id,lastShown:a.quickContext.getLastDisplayTime(b.id),positions:b.positions,priorityLevel:b.priority}}),h=a.main.getCurrentBrowserData().href,f=g(f,r(b),h),f=a.utils.filter(f,function(a){return h&&a.isMatchingUrl(h)});a.message.updatePositions(f);a.utils.each(f,a.guard(a.message.show,{module:a.MODULE_MESSAGE}))}},_testConvertToNormalMessage:f,_testGetActiveMessages:d,_testGetMessagesWithRevision:e,_testOverrideLastShownRevisionId:function(a){var c=
b;b=a;return c},_testPrioritizeMessages:r}}();a.quickMessageEvaluator=function(){function f(b,d){return a.utils.inArray(b,a.uid.getDecilForUid(d))}function g(a,b){return void 0===b||"all"===a||a===b}function d(b,d){var e=new a.baseEvaluator;e.setEvaluatorValue("segments",d);return e.evaluate(b)}function e(b,d){return a.utils.every(b,function(b,c){return d[c]&&a.utils.inArray(b,d[c])})}function b(a,b,d){b=b?d<=new E(b):!0;return new E(a)<=d&&b}return{evaluate:function(c,h){return b(c.startTime,c.endTime,
new E)&&f(c.decils,h.UID)&&g(c.profile,h.profile)&&d(c.segmentRules,h.segments)&&e(c.states,a.states.getAll())},_testEvaluateDecils:f,_testEvaluateProfile:g,_testEvaluateSegments:d,_testEvaluateTime:b,_testEvaluateStates:e}}();a.quickRevisions=function(){function f(b){var c=d(b);if(e(b,c)&&(b=a.utils.reduce(c,function(a,b){b=L(b)||0;return a+b},0),!(1>b))){b=H.floor(H.random()*(b+1));for(var f=a.utils.keys(c),g=0;g<f.length;g++){var n=f[g],l=c[n];if(b<l)return I(n,10);b-=l}}}function g(b){b=a.utils.filter(b,
function(a){return 999!==a.id});var c=H.floor(H.random()*b.length);return b[c]&&b[c].id?b[c].id:void 0}function d(b){var c=H.round(2147483647/b.length);return a.utils.reduce(b,function(b,d){var e=d.balancing;a.utils.isNumeric(e)&&(b[d.id]=H.round(e*c));return b},{})}function e(b,c){var d=a.utils.filter(b,function(b){return a.utils.isNumber(c[b.id])});return b.length===d.length}return{getRandId:function(b){return a.utils.isArray(b)&&0!==b.length?f(b)||g(b):void 0},_testGetRandomRevisionId:g,_testHasValidRevisionWeights:e}}();
a.contextApi=function(){function f(f,d,e,b,c){e=a.utils.isFunction(e)?a.guard(e):function(){};b=a.utils.isFunction(b)?a.guard(b):function(){};return a.fetch.ajax({url:d,method:f,data:x.JSON.stringify(c),dataType:"text",success:function(a){try{e(x.JSON.parse(a))}catch(b){e(void 0)}},error:b})}return{get:function(g,d,e){return f("GET",a.api.getCallUrl("contextApi",{method:"get",key:g}),d,e,null)},set:function(g,d,e,b){return f("POST",a.api.getCallUrl("contextApi",{method:"set",key:g}),e,b,d)}}}();a.segmentCounters=
function(){function f(b,c){var d=g(new E(a.context.lastPageView.time-864E5*(c-1)));return a.utils.filter(b,function(a){return a>=d})}function g(b){return a.utils.getDateInContextFormat(b)}function d(b){if(b=a.context.counts[b]){var c=[];a.utils.each(b.split(","),function(a){a=a.split(":");for(var b=M(a[1])||1;0<b--;)c.push(a[0])});return c}return[]}function e(b,c){c=c.slice(-20);var d={};a.utils.each(c,function(a){d[a]=++d[a]||1});var e=[];a.utils.each(a.utils.keys(d).sort(),function(a){var b=d[a];
e.push(a+(1===b?"":":"+b))});a.context.counts[b]=e.join(",");a.context.save()}return{getTriggerCount:function(a,c){return f(d(a.id),c).length},incrementCounter:function(b){var c=d(b.id);switch(b.frequency){case "everytime":c.push(g(new E(a.context.lastPageView.time)));break;case "once_a_visit":var f;f=new E(a.context.lastVisit.time);f=g(f)+a.utils.pad(f.getHours(),"0",2)+a.utils.pad(f.getMinutes(),"0",2);a.utils.inArray(c,f)||c.push(f);break;case "once_a_day":f=g(new E(a.context.lastPageView.time));
a.utils.inArray(c,f)||c.push(f);break;default:throw new y('Invalid segment "frequency" property of '+b.frequency);}e(b.id,c)},removeExpiredTimes:function(a){e(a.id,f(d(a.id),a.timelimit))},removeUnusedCounters:function(b){a.utils.each(a.context.counts,function(c,d){b[d]||delete a.context.counts[d]});a.context.save()}}}();a.segmentGroups=function(){function f(d,e){return d?a.utils.map(d.segments,function(b){return a.utils.extend({segment:b},e[b])}):a.utils.map(e,function(b,c){return a.utils.extend({segment:c},
b)})}function g(d){var e=null,b=null,c=null;a.utils.each(d,function(a){a.state&&(e=a.segment,a.inSegment&&(b=a.segment),a.event&&(c=a.segment));e=c||b||e});a.utils.each(d,function(b){var c=b.segment;e===b.segment?a.segmentchange.setSegment(c):a.segmentchange.removeSegment(c)})}return{changeState:function(d,e){var b=f(d,e);switch(d&&d.mode||"normal"){case "normal":a.utils.each(b,function(b){var d=b.segment;b.state?a.segmentchange.setSegment(d):a.segmentchange.removeSegment(d)});break;case "radio":g(b)}}}}();
a.segments=function(){function f(){a.utils.each(k,function(b,c){a.segmentGroups.changeState(l["sggp_"+c],b)});k={}}function g(){a.utils.setTimeout(function(){a.events.isTriggered(a.EVENT_SEGMENTS_READY)||a.events.trigger(a.EVENT_SEGMENTS_READY)})}function d(b){var c={};a.utils.each(b,function(b){a.utils.each(b.triggers,function(a){var d=a.on_event;(c[d]=c[d]||[]).push({segment:b,trigger:a})})});a.utils.each(c,function(b,c){a.events.on(c,function(){u||(u=!0,a.utils.setTimeout(function(){u=!1;f();g()}));
v=a.events.getEventDataObject(c,arguments);e(b);v={}})})}function e(b){var d={};a.utils.each(b,function(b){var e=b.segment;b=b.trigger;n.setErrorOptions({type:a.ERROR_TYPE_SEGMENT_EXCEPTION,level:a.LOG_LEVEL_ERROR,module:a.MODULE_SEGMENT,segmentId:e.name});var f=n.evaluate(b.rules);f&&(c(b.counterIds,d),h(e,!0));!f&&a.console.isEnabled()&&n.printTrace("easy.segments - "+e.name)})}function b(b){var c={};a.utils.each((l["sggp_"+b]||{}).segments,function(b){c[b]={event:!1,inSegment:a.segmentchange.inSegment(b),
state:!1}});return c}function c(b,c){a.utils.each(b,function(b){c[b]||(c[b]=!0,a.segmentCounters.incrementCounter(r[b]))})}function h(c,d){var e=c.segmentGroupId||0,f=k[e]=k[e]||b(e),g=f[c.name]=f[c.name]||{};g.event=d;g.inSegment=a.segmentchange.inSegment(c.name);g.state=w[c.name]=n.evaluate(c.rules);(e=l["sggp_"+e]||{},"radio"===e.mode)&&a.utils.each(e.segments,function(a){f[a].state=D(w[a])});!g.state&&a.console.isEnabled()&&n.printTrace("easy.segments - "+c.name)}var r,n,l,k={},u=!1,w={},v={},
t={"get-event-data":function(a){return v[a]},"get-trigger-count":function(b,c){return a.segmentCounters.getTriggerCount(r[b],c)},"has-conversion-product-ids":function(b){var c=a.utils.map(v.products,function(a){return a.id});return a.utils.some(c,function(c){return a.utils.some(b,function(a){return B(c)===B(a)})})}};return{init:function(b,c,e){n||(r=e,l=c,n=new a.baseEvaluator,a.utils.each(t,function(a,b){n.addEvaluatorFunction(b,a)}),a.utils.each(e,function(a,b){a.id=b}),a.segmentCounters.removeUnusedCounters(e),
a.utils.each(e,a.segmentCounters.removeExpiredTimes),a.utils.each(b,function(a){h(a,!1)}),f(),d(b));g()},clear:function(){a.events.clearEvent(a.EVENT_SEGMENTS_READY)},handleQueuedEvents:f,isFinished:function(){return a.utils.isEmpty(k)},_testClear:function(){n=void 0}}}();a.ERROR_STORAGE=1002;a.ERROR_MESSAGE_SCRIPT=1031;a.ERROR_SITE_PRODUCT=20012;a.ERROR_SITE_RENDERER=20023;ba("easy.ERROR_STORAGE","easy.ERROR_TYPE_STORAGE_MISSING",1002);ba("easy.ERROR_MESSAGE_SCRIPT","easy.ERROR_TYPE_MESSAGE_EXCEPTION",
1031);ba("easy.ERROR_SITE_PRODUCT",20012,20012);ba("easy.ERROR_SITE_RENDERER",20023,20023);a.domElements.insertHtml=a.deprecate("easy.domElements.insertHtml","easy.domElements.html (see documentation for a drop-in example)",function(f,g,d,e){if(!a.utils.isString(g))throw new y('Invalid type for "htmlString" argument, got "'+a.utils.getType(g)+'"');var b={args:{message:d,positionData:e,easy:x.easy,site:x.site},guardOptions:{}};a.internal.isMessage(d)&&(b.guardOptions.messageId=d.id,b.guardOptions.revisionId=
d.revision,b.guardOptions.templateId=d.template&&d.template.variable?B(d.template.variable):void 0,b.scriptNamespace=a.MESSAGE_SCRIPT_ID+d.id,b.styleNamespace=a.MESSAGE_STYLE_ID+d.id);e&&a.utils.isNumber(e.position)&&(b.guardOptions.positionId=e.position);a.domElements.html(f,g,b)},void 0,!0);a.addExceptionHandling=a.deprecate("easy.addExceptionHandling","easy.guard",function(f,g){var d={};a.utils.isObject(g)&&(d.type=void 0!==g.code?g.code:g.type,d.level=a.utils.isString(g.level)?g.level:void 0,
d.module=a.utils.isString(g.module)?g.module:void 0,d.html=a.utils.isString(g.html)?g.html:void 0,d.trace=a.utils.isString(g.trace)?g.trace:void 0,d.context=g.context);return a.guard(f,d)});a.api.error=a.deprecate("easy.api.error","easy.log.error",function(f){a.log.error('Deprecated "easy.api.error". Check "debug" for the original error',a.ERROR_TYPE_DEPRECATED+".removed",{debug:B(f),module:a.internal.getCurrentModule()})});a.sendError=a.deprecate("easy.sendError","easy.log.error",function(f,g,d){var e=
{};f instanceof y||a.utils.isString(f)||(f=x.JSON.stringify(f));a.utils.isNumber(g)||(g=B(g||a.ERROR_TYPE_EXCEPTION));a.utils.isObject(d)&&(a.utils.isString(d.html)&&(e.html=d.html),a.utils.isString(d.trace)&&(e.trace=a.internal.truncate(d.trace,a.MAXIMUM_TRACE_LENGTH)));a.log.error(f,g,e);a.events.trigger(a.EVENT_ERROR_SENT,a.utils.extend({text:B(f)},e),g)});(function(){a.utils.isFunction(W.initFunction)&&!W.initialized&&(a.workspaces=W.workspaces,a.runGuarded(W.initFunction,void 0,{type:a.ERROR_TYPE_SITE_INIT}),
W.initialized=!0);if(W.base&&W.origin){var f=a.domElements.addScriptTag("//"+W.base+"sites/"+W.origin+".js");a.ready(function(){f&&(f.removeAttribute("src"),f.parentNode?f.parentNode.removeChild(f):a.console.error("[init]","Customer's script element node does not have a parent node"),f=null)})}})();a.namespaceLoaded=!0}})();
